NRU% = 0
NI% = 37
MSL = 1
SST = 2
OIL = 5
RED = $F0
WHITE = $FF

CPU 1

L0000   = $0000
RAND    = $0002
L0003   = $0003
L0004   = $0004
L0005   = $0005
T1      = $0006
SC      = $000A
L000B   = $000B
P       = $000C
L000D   = $000D
S_COPY  = $000E
T_COPY  = $000F
XC      = $0010
COL     = $0011
YC      = $0012
QQ17    = $0013
K3      = $0014
L0015   = $0015
L0016   = $0016
L0017   = $0017
L0018   = $0018
L0019   = $0019
L001A   = $001A
L001B   = $001B
L001C   = $001C
L001D   = $001D
L001E   = $001E
K4      = $0022
L0023   = $0023
XX16    = $0024
L0025   = $0025
L0026   = $0026
L0027   = $0027
L0028   = $0028
L0029   = $0029
L002A   = $002A
L002B   = $002B
L002E   = $002E
L002F   = $002F
L0030   = $0030
L0031   = $0031
L0032   = $0032
L0033   = $0033
XX0     = $0036
L0037   = $0037
INF     = $0038
L0039   = $0039
V       = $003A
L003B   = $003B
XX      = $003C
L003D   = $003D
YY      = $003E
L003F   = $003F
L0040   = $0040
L0041   = $0041
BETA    = $0042
BET1    = $0043
QQ22    = $0044
L0045   = $0045
ECMA    = $0046
ALP1    = $0047
ALP2    = $0048
L0049   = $0049
XX15    = $004A
Y1      = $004B
X2      = $004C
Y2      = $004D
L004E   = $004E
L004F   = $004F
XX12    = $0050
L0051   = $0051
L0052   = $0052
L0053   = $0053
L0054   = $0054
L0055   = $0055
K       = $0056
L0057   = $0057
L0058   = $0058
L0059   = $0059
LAS     = $005A
MSTG    = $005B
DL      = $005C
LSP     = $005D
QQ15    = $005E
L005F   = $005F
L0060   = $0060
L0061   = $0061
L0062   = $0062
L0063   = $0063
XX18    = $0064
L0065   = $0065
L0066   = $0066
L0067   = $0067
K6      = $0068
L0069   = $0069
L006A   = $006A
L006B   = $006B
L006C   = $006C
QQ19    = $006D
L006E   = $006E
L006F   = $006F
L0070   = $0070
L0071   = $0071
L0072   = $0072
BET2    = $0073
L0074   = $0074
DELTA   = $0075
DELT4   = $0076
L0077   = $0077
U       = $0078
Q       = $0079
R       = $007A
S       = $007B
T       = $007C
XSAV    = $007D
YSAV    = $007E
XX17    = $007F
U_COPY  = $0080
QQ11    = $0081
ZZ      = $0082
L0083   = $0083
MCNT    = $0084
TYPE    = $0085
ALPHA   = $0086
QQ12    = $0087
L0088   = $0088
FLAG    = $0089
CNT     = $008A
CNT2    = $008B
STP     = $008C
XX4     = $008D
XX20    = $008E
L008F   = $008F
L0090   = $0090
RAT     = $0091
RAT2    = $0092
L0093   = $0093
L0094   = $0094
L0095   = $0095
L0096   = $0096
widget  = $0097
L0098   = $0098
L0099   = $0099
L009A   = $009A
L009B   = $009B
INWK    = $009C
L009D   = $009D
L009E   = $009E
L009F   = $009F
L00A0   = $00A0
L00A1   = $00A1
L00A2   = $00A2
L00A3   = $00A3
L00A4   = $00A4
L00A5   = $00A5
L00A6   = $00A6
L00A8   = $00A8
L00AA   = $00AA
L00AB   = $00AB
L00AC   = $00AC
L00AE   = $00AE
L00B0   = $00B0
L00B1   = $00B1
L00B2   = $00B2
L00B4   = $00B4
L00B6   = $00B6
L00B7   = $00B7
L00B8   = $00B8
L00B9   = $00B9
L00BA   = $00BA
L00BB   = $00BB
L00BC   = $00BC
XX19    = $00BD
L00BE   = $00BE
L00BF   = $00BF
NEWB    = $00C0
JSTX    = $00C1
JSTY    = $00C2
L00C3   = $00C3
KY17    = $00C4
KY14    = $00C5
KY15    = $00C6
KY20    = $00C7
KY7     = $00C8
L00C9   = $00C9
KY18    = $00CA
L00CB   = $00CB
KY19    = $00CC
KY12    = $00CD
KY2     = $00CE
KY16    = $00CF
L00D0   = $00D0
L00D1   = $00D1
KY1     = $00D2
KY13    = $00D3
L00D4   = $00D4
FSH     = $00D5
ASH     = $00D6
ENERGY  = $00D7
QQ3     = $00D8
QQ4     = $00D9
QQ5     = $00DA
QQ6     = $00DB
QQ7     = $00DD
L00DE   = $00DE
QQ8     = $00DF
L00E0   = $00E0
QQ9     = $00E1
QQ10    = $00E2
NOSTM   = $00E3
L00F9   = $00F9
L00FC   = $00FC
L00FD   = $00FD
XX3     = $0100
L0101   = $0101
L0102   = $0102
L0103   = $0103
L01A2   = $01A2
USERV   = $0200
BRKV    = $0202
L0203   = $0203
IRQ1V   = $0204
L0205   = $0205
IRQ2V   = $0206
CLIV    = $0208
BYTEV   = $020A
WORDV   = $020C
WRCHV   = $020E
L020F   = $020F
RDCHV   = $0210
FILEV   = $0212
ARGSV   = $0214
BGETV   = $0216
BPUTV   = $0218
GBPBV   = $021A
FINDV   = $021C
FSCV    = $021E
EVENTV  = $0220
UPTV    = $0222
NETV    = $0224
VDUV    = $0226
KEYV    = $0228
INSV    = $022A
REMV    = $022C
CNPV    = $022E
INDV1   = $0230
INDV2   = $0232
INDV3   = $0234
L02A2   = $02A2
K%      = $0400
L0401   = $0401
L0402   = $0402
L0404   = $0404
L0405   = $0405
L0406   = $0406
L0407   = $0407
L0408   = $0408
L0425   = $0425
L0427   = $0427
L0429   = $0429
L042D   = $042D
L042F   = $042F
L0431   = $0431
L0433   = $0433
L0449   = $0449
L06A9   = $06A9
L0791   = $0791
L07A9   = $07A9
L0C85   = $0C85
L0E40   = $0E40
FRIN    = $0E41
L0E42   = $0E42
L0E43   = $0E43
L0E45   = $0E45
MANY    = $0E4E
SSPR    = $0E50
L0E58   = $0E58
L0E5E   = $0E5E
L0E6B   = $0E6B
L0E6D   = $0E6D
JUNK    = $0E70
auto    = $0E71
ECMP    = $0E72
MJ      = $0E73
CABTMP  = $0E74
LAS2    = $0E75
MSAR    = $0E76
VIEW    = $0E77
LASCT   = $0E78
GNTMP   = $0E79
HFX     = $0E7A
L0E7B   = $0E7B
DLY     = $0E7C
L0E7D   = $0E7D
LSX2    = $0E7E
L0F7D   = $0F7D
LSY2    = $0F7E
LSO     = $107E
L1145   = $1145
BUF     = $1146
L1147   = $1147
L1164   = $1164
L1165   = $1165
SX      = $11A0
SXL     = $11B5
SY      = $11CA
SYL     = $11DF
L11ED   = $11ED
SZ      = $11F4
SZL     = $1209
LASX    = $121E
LASY    = $121F
ALTIT   = $1221
SWAP    = $1222
L1229   = $1229
L122B   = $122B
L122C   = $122C
TP      = $1234
QQ0     = $1235
QQ1     = $1236
QQ21    = $1237
L123D   = $123D
L123E   = $123E
L123F   = $123F
L1240   = $1240
QQ14    = $1241
L1242   = $1242
GCNT    = $1243
LASER   = $1244
CRGO    = $124A
QQ20    = $124B
L124E   = $124E
L1251   = $1251
L1255   = $1255
ECM     = $125C
BST     = $125D
BOMB    = $125E
ENGY    = $125F
DKCMP   = $1260
GHYP    = $1261
ESCP    = $1262
L1264   = $1264
L1265   = $1265
L1266   = $1266
NOMSL   = $1267
FIST    = $1268
AVL     = $1269
L1279   = $1279
L127A   = $127A
TALLY   = $127B
L127C   = $127C
L127D   = $127D
L1281   = $1281
COMX    = $1282
COMY    = $1283
QQ24    = $1292
QQ25    = $1293
L1294   = $1294
QQ29    = $1295
L1296   = $1296
L1297   = $1297
L1298   = $1298
L1299   = $1299
L129A   = $129A
KTRAN   = $129F
L12A0   = $12A0
L12A6   = $12A6
L12A7   = $12A7
L12A8   = $12A8
L12A9   = $12A9
L7FFE   = $7FFE
L7FFF   = $7FFF
XX21    = $8000
L8002   = $8002
L8003   = $8003
L8007   = $8007
L8040   = $8040
L8041   = $8041
E%      = $8042
L8062   = $8062
TALLYFRAC = $8063
L8083   = $8083
TALLYINT = $8084
QQ18    = $A000
SNE     = $A3C0
ACT     = $A3E0
TKN1    = $A400
LAF47   = $AF47
RUPLA   = $AF48
LAF61   = $AF61
RUGAL   = $AF62
RUTOK   = $AF7C
LBDB1   = $BDB1
LDDEB   = $DDEB
VIA     = $FE00
LFE01   = $FE01
LFE18   = $FE18
LFE19   = $FE19
LFE20   = $FE20
LFE21   = $FE21
LFE30   = $FE30
LFE34   = $FE34
LFE40   = $FE40
LFE41   = $FE41
LFE43   = $FE43
LFE44   = $FE44
LFE45   = $FE45
LFE4D   = $FE4D
LFE4E   = $FE4E
LFE4F   = $FE4F
LFE6E   = $FE6E
OSWRSC  = $FFB3
OSRDSC  = $FFB9
OSEVEN  = $FFBF
GSINIT  = $FFC2
GSREAD  = $FFC5
NVRDCH  = $FFC8
NNWRCH  = $FFCB
OSFIND  = $FFCE
OSGBPB  = $FFD1
OSBPUT  = $FFD4
OSBGET  = $FFD7
OSARGS  = $FFDA
OSFILE  = $FFDD
OSRDCH  = $FFE0
OSASCI  = $FFE3
OSNEWL  = $FFE7
OSWRCH  = $FFEE
OSWORD  = $FFF1
OSBYTE  = $FFF4
OSCLI   = $FFF7
LFFFF   = $FFFF

        org     $1300
.TVT3
        EQUB    $00,$34,$24,$17,$74,$64,$57,$47
        EQUB    $B1,$A1,$96,$86,$F1,$E1,$D6,$C6
        EQUB    $00,$34,$24,$17,$74,$64,$57,$47
        EQUB    $B0,$A0,$96,$86,$F0,$E0,$D6,$C6
        EQUB    $00,$34,$24,$17,$74,$64,$57,$47
        EQUB    $B1,$A1,$90,$80,$F1,$E1,$D0,$C0
        EQUB    $00,$34,$24,$17,$74,$64,$57,$47
        EQUB    $B0,$A0,$92,$82,$F0,$E0,$D2,$C2

.VEC
        EQUB    $88

.L1341
        EQUB    $88

.WSCAN
        STZ     DL
.WSCAN1
        LDA     DL
        BEQ     WSCAN1

        RTS

.DELAY
        JSR     WSCAN

        DEY
        BNE     DELAY

        RTS

.BEEP_LONG_LOW
        LDY     #$00
        BRA     NOISE

.BEEP
        LDY     #$01
        BRA     NOISE

.L1358
        EQUB    $C0

        EQUB    $A0,$80

.L135B
        EQUB    $FF,$BF,$9F,$DF,$EF

.MASTER_DKSn
        LDX     #$FF
        STX     LFE43
        STA     LFE4F
        LDA     #$00
        STA     LFE40
        PHA
        PLA
        PHA
        PLA
        LDA     #$08
        STA     LFE40
.L1376
        RTS

.L1377
        LDY     #$03
        LDA     #$00
.L137B
        STA     L144C,Y
        DEY
        BNE     L137B

        SEI
.L1382
        LDA     L135B,Y
        JSR     MASTER_DKSn

        INY
        CPY     #$05
        BNE     L1382

        CLI
        RTS

.BEING_HIT_NOISE
        LDY     #$09
        JSR     NOISE

        LDY     #$05
        BRA     NOISE

.LASER_NOISE
        LDY     #$03
        JSR     NOISE

        LDY     #$05
.NOISE
        LDA     L2C55
        BNE     L1376

        LDA     L146E,Y
        LSR     A
        CLV
        LDX     #$00
        BCS     L13B7

        INX
        LDA     L145A
        CMP     L145B
        BCC     L13B7

        INX
.L13B7
        LDA     L1462,Y
        CMP     L1459,X
        BCC     L1376

        SEI
        STA     L1459,X
        LSR     A
        AND     #$07
        STA     L1453,X
        LDA     L1486,Y
        STA     L1456,X
        LDA     L146E,Y
        STA     L1450,X
        AND     #$0F
        LSR     A
        STA     L145C,X
        LDA     L147A,Y
        BVC     L13E1

        ASL     A
.L13E1
        STA     L145F,X
        LDA     #$80
        STA     L144D,X
        CLI
        SEC
        RTS

.L13EC
        LDY     #$02
.L13EE
        LDA     L144D,Y
        BEQ     L1449

        BMI     L13FB

        LDA     L145C,Y
        BEQ     L1416

        EQUB    $2C

.L13FB
        LDA     #$00
        CLC
        CLD
        ADC     L145F,Y
        STA     L145F,Y
        PHA
        ASL     A
        ASL     A
        AND     #$0F
        ORA     L1358,Y
        JSR     MASTER_DKSn

        PLA
        LSR     A
        LSR     A
        JSR     MASTER_DKSn

.L1416
        TYA
        TAX
        LDA     L144D,Y
        BMI     L1439

        DEC     L1450,X
        BEQ     L142F

        LDA     L1450,X
        AND     L1456,X
        BNE     L1449

        DEC     L1453,X
        BNE     L143C

.L142F
        LDA     #$00
        STA     L144D,Y
        STA     L1459,Y
        BEQ     L1443

.L1439
        LSR     L144D,X
.L143C
        LDA     L1453,Y
        CLC
        ADC     L2C61
.L1443
        EOR     L135B,Y
        JSR     MASTER_DKSn

.L1449
        DEY
        BPL     L13EE

.L144C
        RTS

.L144D
        EQUB    $00

        EQUB    $00,$00

.L1450
        EQUB    $00,$00,$00

.L1453
        EQUB    $00,$00,$00

.L1456
        EQUB    $00,$00,$00

.L1459
        EQUB    $00

.L145A
        EQUB    $00

.L145B
        EQUB    $00

.L145C
        EQUB    $00,$00,$00

.L145F
        EQUB    $00,$00,$00

.L1462
        EQUB    $4B,$5B,$3F,$EB,$FF,$09,$FF,$8B
        EQUB    $CF,$E7,$FF,$EF

.L146E
        EQUB    $40,$10,$01,$FC,$F3,$19,$F9,$7C
        EQUB    $F1,$FA,$FE,$FE

.L147A
        EQUB    $F0,$20,$10,$30,$03,$01,$08,$80
        EQUB    $16,$38,$00,$80

.L1486
        EQUB    $FF,$FF,$00,$03,$1F,$01,$07,$07
        EQUB    $0F,$03,$0F,$0F

.STARTUP
        SEI
        LDA     #$39
        STA     LFE4E
        LDA     #$7F
        STA     LFE6E
        LDA     IRQ1V
        STA     VEC
        LDA     L0205
        STA     L1341
        LDA     #$CB
        STA     IRQ1V
        LDA     #$14
        STA     L0205
        LDA     L153A
        STA     LFE45
        CLI
        RTS

.L14BB
        EQUB    $34

        EQUB    $43,$25,$16,$86,$70,$61,$52,$C3
        EQUB    $B4,$A5,$96,$07,$F0,$E1,$D2

.IRQ1
        PHY
        LDY     #$0F
        LDA     #$02
        BIT     LFE4D
        BNE     LINSCN

        LDA     #$14
        STA     LFE20
        LDA     ESCP
        AND     #$04
        EOR     #$34
        STA     LFE21
.L14E4
        LDA     L14BB,Y
        STA     LFE21
        DEY
        BNE     L14E4

        LDA     LFE18
        AND     #$03
        TAY
        LDA     LFE19
        STA     L12A7,Y
        INY
        TYA
        CMP     #$03
        BCC     L1501

        LDA     #$00
.L1501
        STA     LFE18
        PLY
        LDA     LFE44
        LDA     L00FC
        RTI

.LINSCN
        LDA     LFE41
        LDA     L00FC
        PHA
        LDA     L153B
        STA     DL
        STA     LFE44
        LDA     L153A
        STA     LFE45
        LDA     HFX
        BNE     L1532

        LDA     #$18
        STA     LFE20
.VNT3
        LDA     TVT3,Y
L152A = VNT3+1
        STA     LFE21
        DEY
        BNE     VNT3

.L1532
        PHX
        JSR     L13EC

        PLX
        PLA
        PLY
        RTI

.L153A
        EQUB    $39

.L153B
        EQUB    $1E

.DOVDU19
        STA     L152A
        RTS

.MASTER_MOVE_ZP_3000
        LDA     #$0F
        STA     LFE34
        LDX     #$90
.L1547
        LDA     L0000,X
        STA     L3000,X
        INX
        BNE     L1547

        LDA     #$09
        STA     LFE34
        RTS

.MASTER_SWAP_ZP_3000
        LDA     #$0F
        STA     LFE34
        LDX     #$90
.L155C
        LDA     L0000,X
        LDY     L3000,X
        STY     L0000,X
        STA     L3000,X
        INX
        CPX     #$F0
        BNE     L155C

        LDA     #$09
        STA     LFE34
        LDA     #$06
        STA     LFE30
        RTS

.L1576
        EQUB    $40

        EQUB    $40,$40,$40,$40,$40,$40,$40,$42
        EQUB    $42,$42,$42,$42,$42,$42,$42,$44
        EQUB    $44,$44,$44,$44,$44,$44,$44,$46
        EQUB    $46,$46,$46,$46,$46,$46,$46,$48
        EQUB    $48,$48,$48,$48,$48,$48,$48,$4A
        EQUB    $4A,$4A,$4A,$4A,$4A,$4A,$4A,$4C
        EQUB    $4C,$4C,$4C,$4C,$4C,$4C,$4C,$4E
        EQUB    $4E,$4E,$4E,$4E,$4E,$4E,$4E,$50
        EQUB    $50,$50,$50,$50,$50,$50,$50,$52
        EQUB    $52,$52,$52,$52,$52,$52,$52,$54
        EQUB    $54,$54,$54,$54,$54,$54,$54,$56
        EQUB    $56,$56,$56,$56,$56,$56,$56,$58
        EQUB    $58,$58,$58,$58,$58,$58,$58,$5A
        EQUB    $5A,$5A,$5A,$5A,$5A,$5A,$5A,$5C
        EQUB    $5C,$5C,$5C,$5C,$5C,$5C,$5C,$5E
        EQUB    $5E,$5E,$5E,$5E,$5E,$5E,$5E,$60
        EQUB    $60,$60,$60,$60,$60,$60,$60,$62
        EQUB    $62,$62,$62,$62,$62,$62,$62,$64
        EQUB    $64,$64,$64,$64,$64,$64,$64,$66
        EQUB    $66,$66,$66,$66,$66,$66,$66,$68
        EQUB    $68,$68,$68,$68,$68,$68,$68,$6A
        EQUB    $6A,$6A,$6A,$6A,$6A,$6A,$6A,$6C
        EQUB    $6C,$6C,$6C,$6C,$6C,$6C,$6C,$6E
        EQUB    $6E,$6E,$6E,$6E,$6E,$6E,$6E,$70
        EQUB    $70,$70,$70,$70,$70,$70,$70,$72
        EQUB    $72,$72,$72,$72,$72,$72,$72,$74
        EQUB    $74,$74,$74,$74,$74,$74,$74,$76
        EQUB    $76,$76,$76,$76,$76,$76,$76,$78
        EQUB    $78,$78,$78,$78,$78,$78,$78,$7A
        EQUB    $7A,$7A,$7A,$7A,$7A,$7A,$7A,$7C
        EQUB    $7C,$7C,$7C,$7C,$7C,$7C,$7C,$7E
        EQUB    $7E,$7E,$7E,$7E,$7E,$7E,$7E

.SC5
        RTS

.SCAN
        LDA     L00BB
        AND     #$10
        BEQ     SC5

        LDX     TYPE
        BMI     SC5

        LDA     scacol,X
        STA     COL
        LDA     L009D
        ORA     L00A0
        ORA     L00A3
        AND     #$C0
        BNE     SC5

        LDA     L009D
        CLC
        LDX     L009E
        BPL     SC2

        EOR     #$FF
        ADC     #$01
        CLC
.SC2
        ADC     #$7D
        AND     #$FE
        STA     XX15
        TAX
        DEX
        DEX
        LDA     L00A3
        LSR     A
        LSR     A
        CLC
        LDY     L00A4
        BPL     SC3

        EOR     #$FF
        SEC
.SC3
        ADC     #$23
        EOR     #$FF
        STA     Y2
        LDA     L00A0
        LSR     A
        CLC
        LDY     L00A1
        BMI     SCD6

        EOR     #$FF
        SEC
.SCD6
        ADC     Y2
        BPL     FIXIT

        CMP     #$C2
        BCS     L16CC

        LDA     #$C2
.L16CC
        CMP     #$F7
        BCC     L16D2

.FIXIT
        LDA     #$F6
.L16D2
        LDY     #$0F
        STY     LFE34
        JSR     CPIX2

        LDA     Y1
        SEC
        SBC     Y2
        BEQ     RTS

        BCC     RTS_PLUS_1

        TAX
        INX
        JMP     VL1

.VLL1
        LDA     R
        EOR     (SC),Y
        STA     (SC),Y
.VL1
        DEY
        BPL     L16F9

        LDA     L000B
        SBC     #$02
        STA     L000B
        LDY     #$07
.L16F9
        DEX
        BNE     VLL1

.RTS
        LDA     #$09
        STA     LFE34
        RTS

.RTS_PLUS_1
        LDA     Y2
        SEC
        SBC     Y1
        TAX
        INX
        JMP     VL2

.VLL2
        LDA     R
        EOR     (SC),Y
        STA     (SC),Y
.VL2
        INY
        CPY     #$08
        BNE     L171F

        LDA     L000B
        ADC     #$01
        STA     L000B
        LDY     #$00
.L171F
        DEX
        BNE     VLL2

        LDA     #$09
        STA     LFE34
        RTS

.LL30
        STY     YSAV
        LDA     #$0F
        STA     LFE34
        JSR     LOIN

        LDA     #$09
        STA     LFE34
        LDY     YSAV
        RTS

.L173A
        EQUB    $88

        EQUB    $44,$22,$11

.TWOS2
        EQUB    $CC,$66,$33,$33

.CTWOS
        EQUB    $AA,$AA

.L1744
        EQUB    $55,$55,$AA,$AA,$4C,$49,$1D

.LOIN
        LDA     #$80
        STA     S
        ASL     A
        STA     SWAP
        LDA     X2
        SBC     XX15
        BCS     LI1

        EOR     #$FF
        ADC     #$01
        SEC
.LI1
        STA     P
        LDA     Y2
        SBC     Y1
        BCS     LI2

        EOR     #$FF
        ADC     #$01
.LI2
        STA     Q
        CMP     P
        BCC     STPX

        JMP     STPY

.STPX
        LDX     XX15
        CPX     X2
        BCC     LI3

        DEC     SWAP
        LDA     X2
        STA     XX15
        STX     X2
        TAX
        LDA     Y2
        LDY     Y1
        STA     Y1
        STY     Y2
.LI3
        LDY     Y1
        LDA     L1576,Y
        STA     L000B
        LDA     Y1
        AND     #$07
        TAY
        TXA
        AND     #$FC
        ASL     A
        STA     SC
        BCC     L17A1

        INC     L000B
.L17A1
        TXA
        AND     #$03
        STA     R
        LDX     Q
        BEQ     LIlog7

        LDA     logL,X
        LDX     P
        SEC
        SBC     logL,X
        LDX     Q
        LDA     log,X
        LDX     P
        SBC     log,X
        BCS     LIlog5

        TAX
        LDA     antilog,X
        JMP     LIlog6

.LIlog5
        LDA     #$FF
        BNE     LIlog6

.LIlog7
        LDA     #$00
.LIlog6
        STA     Q
        LDX     P
        BEQ     LIEXS

        INX
        LDA     Y2
        CMP     Y1
        BCC     L17DC

        JMP     DOWN

.L17DC
        LDA     #$88
        AND     COL
        STA     L181A
        LDA     #$44
        AND     COL
        STA     L182F
        LDA     #$22
        AND     COL
        STA     L1844
        LDA     #$11
        AND     COL
        STA     L1859
        LDA     SWAP
        BEQ     LI190

        LDA     R
        BEQ     L181F

        CMP     #$02
        BCC     L1834

        CLC
        BEQ     L1849

        BNE     L185E

.LI190
        DEX
        LDA     R
        BEQ     LI100

        CMP     #$02
        BCC     LI110

        CLC
        BEQ     LI120

        JMP     LI130

.LI100
        LDA     #$88
L181A = LI100+1
        EOR     (SC),Y
        STA     (SC),Y
.L181F
        DEX
.LIEXS
        BEQ     LIEX

        LDA     S
        ADC     Q
        STA     S
        BCC     LI110

        CLC
        DEY
        BMI     LI101

.LI110
        LDA     #$44
L182F = LI110+1
        EOR     (SC),Y
        STA     (SC),Y
.L1834
        DEX
        BEQ     LIEX

        LDA     S
        ADC     Q
        STA     S
        BCC     LI120

        CLC
        DEY
        BMI     LI111

.LI120
        LDA     #$22
L1844 = LI120+1
        EOR     (SC),Y
        STA     (SC),Y
.L1849
        DEX
        BEQ     LIEX

        LDA     S
        ADC     Q
        STA     S
        BCC     LI130

        CLC
        DEY
        BMI     LI121

.LI130
        LDA     #$11
L1859 = LI130+1
        EOR     (SC),Y
        STA     (SC),Y
.L185E
        LDA     S
        ADC     Q
        STA     S
        BCC     LI140

        CLC
        DEY
        BMI     LI131

.LI140
        DEX
        BEQ     LIEX

        LDA     SC
        ADC     #$08
        STA     SC
        BCC     LI100

        INC     L000B
        CLC
        BCC     LI100

.LI101
        DEC     L000B
        DEC     L000B
        LDY     #$07
        BPL     LI110

.LI111
        DEC     L000B
        DEC     L000B
        LDY     #$07
        BPL     LI120

.LI121
        DEC     L000B
        DEC     L000B
        LDY     #$07
        BPL     LI130

.LI131
        DEC     L000B
        DEC     L000B
        LDY     #$07
        BPL     LI140

.LIEX
        RTS

.DOWN
        LDA     #$88
        AND     COL
        STA     L18E8
        LDA     #$44
        AND     COL
        STA     L18FD
        LDA     #$22
        AND     COL
        STA     L1912
        LDA     #$11
        AND     COL
        STA     L1927
        LDA     SC
        SBC     #$F8
        STA     SC
        LDA     L000B
        SBC     #$00
        STA     L000B
        TYA
        EOR     #$F8
        TAY
        LDA     SWAP
        BEQ     LI191

        LDA     R
        BEQ     L18ED

        CMP     #$02
        BCC     L1902

        CLC
        BEQ     L1917

        BNE     L192C

.LI191
        DEX
        LDA     R
        BEQ     LI200

        CMP     #$02
        BCC     LI210

        CLC
        BEQ     LI220

        BNE     LI230

.LI200
        LDA     #$88
L18E8 = LI200+1
        EOR     (SC),Y
        STA     (SC),Y
.L18ED
        DEX
        BEQ     LIEX

        LDA     S
        ADC     Q
        STA     S
        BCC     LI210

        CLC
        INY
        BEQ     LI201

.LI210
        LDA     #$44
L18FD = LI210+1
        EOR     (SC),Y
        STA     (SC),Y
.L1902
        DEX
        BEQ     LIEX

        LDA     S
        ADC     Q
        STA     S
        BCC     LI220

        CLC
        INY
        BEQ     LI211

.LI220
        LDA     #$22
L1912 = LI220+1
        EOR     (SC),Y
        STA     (SC),Y
.L1917
        DEX
        BEQ     LIEX2

        LDA     S
        ADC     Q
        STA     S
        BCC     LI230

        CLC
        INY
        BEQ     LI221

.LI230
        LDA     #$11
L1927 = LI230+1
        EOR     (SC),Y
        STA     (SC),Y
.L192C
        LDA     S
        ADC     Q
        STA     S
        BCC     LI240

        CLC
        INY
        BEQ     LI231

.LI240
        DEX
        BEQ     LIEX2

        LDA     SC
        ADC     #$08
        STA     SC
        BCC     LI200

        INC     L000B
        CLC
        BCC     LI200

.LI201
        INC     L000B
        INC     L000B
        LDY     #$F8
        BNE     LI210

.LI211
        INC     L000B
        INC     L000B
        LDY     #$F8
        BNE     LI220

.LI221
        INC     L000B
        INC     L000B
        LDY     #$F8
        BNE     LI230

.LI231
        INC     L000B
        INC     L000B
        LDY     #$F8
        BNE     LI240

.LIEX2
        RTS

.STPY
        LDY     Y1
        TYA
        LDX     XX15
        CPY     Y2
        BCS     LI15

        DEC     SWAP
        LDA     X2
        STA     XX15
        STX     X2
        TAX
        LDA     Y2
        STA     Y1
        STY     Y2
        TAY
.LI15
        LDA     L1576,Y
        STA     L000B
        TXA
        AND     #$FC
        ASL     A
        STA     SC
        BCC     L1992

        INC     L000B
.L1992
        TXA
        AND     #$03
        TAX
        LDA     L173A,X
        STA     R
        LDX     P
        BEQ     LIfudge

        LDA     logL,X
        LDX     Q
        SEC
        SBC     logL,X
        LDX     P
        LDA     log,X
        LDX     Q
        SBC     log,X
        BCS     LIlog3

        TAX
        LDA     antilog,X
        JMP     LIlog2

.LIlog3
        LDA     #$FF
.LIlog2
        STA     P
.LIfudge
        LDX     Q
        BEQ     LIEX7

        INX
        LDA     X2
        SEC
        SBC     XX15
        BCS     L19CF

        JMP     LFT

.LIEX7
        RTS

.L19CF
        LDA     SWAP
        BEQ     LI290

        TYA
        AND     #$07
        TAY
        BNE     L19DD

        JMP     L1B18

.L19DD
        CPY     #$02
        BCS     L19E4

        JMP     L1B04

.L19E4
        CLC
        BNE     L19EA

        JMP     L1AF0

.L19EA
        CPY     #$04
        BCS     L19F1

        JMP     L1ADC

.L19F1
        CLC
        BNE     L19F7

        JMP     L1AC8

.L19F7
        CPY     #$06
        BCS     L19FE

        JMP     L1AB4

.L19FE
        CLC
        BEQ     L1A04

        JMP     L1A8C

.L1A04
        JMP     L1AA0

.LI290
        DEX
        TYA
        AND     #$07
        TAY
        BNE     L1A11

        JMP     LI307

.L1A11
        CPY     #$02
        BCS     L1A18

        JMP     LI306

.L1A18
        CLC
        BNE     L1A1E

        JMP     LI305

.L1A1E
        CPY     #$04
        BCC     LI304S

        CLC
        BEQ     LI303S

        CPY     #$06
        BCC     LI302S

        CLC
        BEQ     LI301S

        JMP     LI300

.LI310
        LSR     R
        BCC     LI301

        LDA     #$88
        STA     R
        LDA     SC
        ADC     #$07
        STA     SC
        BCC     LI301

        INC     L000B
        CLC
.LI301S
        BCC     LI301

.LI311
        LSR     R
        BCC     LI302

        LDA     #$88
        STA     R
        LDA     SC
        ADC     #$07
        STA     SC
        BCC     LI302

        INC     L000B
        CLC
.LI302S
        BCC     LI302

.LI312
        LSR     R
        BCC     LI303

        LDA     #$88
        STA     R
        LDA     SC
        ADC     #$07
        STA     SC
        BCC     LI303

        INC     L000B
        CLC
.LI303S
        BCC     LI303

.LI313
        LSR     R
        BCC     LI304

        LDA     #$88
        STA     R
        LDA     SC
        ADC     #$07
        STA     SC
        BCC     LI304

        INC     L000B
        CLC
.LI304S
        BCC     LI304

.LIEX3
        RTS

.LI300
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1A8C
        DEX
        BEQ     LIEX3

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI310

.LI301
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1AA0
        DEX
        BEQ     LIEX3

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI311

.LI302
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1AB4
        DEX
        BEQ     LIEX3

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI312

.LI303
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1AC8
        DEX
        BEQ     LIEX3

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI313

.LI304
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1ADC
        DEX
        BEQ     LIEX4

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI314

.LI305
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1AF0
        DEX
        BEQ     LIEX4

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI315

.LI306
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1B04
        DEX
        BEQ     LIEX4

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI316

.LI307
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1B18
        DEX
        BEQ     LIEX4

        DEC     L000B
        DEC     L000B
        LDY     #$07
        LDA     S
        ADC     P
        STA     S
        BCS     L1B2C

        JMP     LI300

.L1B2C
        LSR     R
        BCS     L1B33

        JMP     LI300

.L1B33
        LDA     #$88
        STA     R
        LDA     SC
        ADC     #$07
        STA     SC
        BCS     L1B42

        JMP     LI300

.L1B42
        INC     L000B
        CLC
        JMP     LI300

.LIEX4
        RTS

.LI314
        LSR     R
        BCC     LI305

        LDA     #$88
        STA     R
        LDA     SC
        ADC     #$07
        STA     SC
        BCC     LI305

        INC     L000B
        CLC
        BCC     LI305

.LI315
        LSR     R
        BCC     LI306

        LDA     #$88
        STA     R
        LDA     SC
        ADC     #$07
        STA     SC
        BCC     LI306

        INC     L000B
        CLC
        BCC     LI306

.LI316
        LSR     R
        BCC     LI307

        LDA     #$88
        STA     R
        LDA     SC
        ADC     #$07
        STA     SC
        BCC     LI307

        INC     L000B
        CLC
        BCC     LI307

.LFT
        LDA     SWAP
        BEQ     LI291

        TYA
        AND     #$07
        TAY
        BNE     L1B96

        JMP     L1CD1

.L1B96
        CPY     #$02
        BCS     L1B9D

        JMP     L1CBD

.L1B9D
        CLC
        BNE     L1BA3

        JMP     L1CA9

.L1BA3
        CPY     #$04
        BCS     L1BAA

        JMP     L1C95

.L1BAA
        CLC
        BNE     L1BB0

        JMP     L1C81

.L1BB0
        CPY     #$06
        BCS     L1BB7

        JMP     L1C6D

.L1BB7
        CLC
        BEQ     L1BBD

        JMP     L1C45

.L1BBD
        JMP     L1C59

.LI291
        DEX
        TYA
        AND     #$07
        TAY
        BNE     L1BCA

        JMP     LI407

.L1BCA
        CPY     #$02
        BCS     L1BD1

        JMP     LI406

.L1BD1
        CLC
        BNE     L1BD7

        JMP     LI405

.L1BD7
        CPY     #$04
        BCC     LI404S

        CLC
        BEQ     LI403S

        CPY     #$06
        BCC     LI402S

        CLC
        BEQ     LI401S

        JMP     LI400

.LI410
        ASL     R
        BCC     LI401

        LDA     #$11
        STA     R
        LDA     SC
        SBC     #$08
        STA     SC
        BCS     L1BFA

        DEC     L000B
.L1BFA
        CLC
.LI401S
        BCC     LI401

.LI411
        ASL     R
        BCC     LI402

        LDA     #$11
        STA     R
        LDA     SC
        SBC     #$08
        STA     SC
        BCS     L1C0F

        DEC     L000B
.L1C0F
        CLC
.LI402S
        BCC     LI402

.LI412
        ASL     R
        BCC     LI403

        LDA     #$11
        STA     R
        LDA     SC
        SBC     #$08
        STA     SC
        BCS     L1C24

        DEC     L000B
.L1C24
        CLC
.LI403S
        BCC     LI403

.LI413
        ASL     R
        BCC     LI404

        LDA     #$11
        STA     R
        LDA     SC
        SBC     #$08
        STA     SC
        BCS     L1C39

        DEC     L000B
.L1C39
        CLC
.LI404S
        BCC     LI404

.LIEX5
        RTS

.LI400
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1C45
        DEX
        BEQ     LIEX5

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI410

.LI401
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1C59
        DEX
        BEQ     LIEX5

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI411

.LI402
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1C6D
        DEX
        BEQ     LIEX5

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI412

.LI403
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1C81
        DEX
        BEQ     LIEX5

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI413

.LI404
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1C95
        DEX
        BEQ     LIEX6

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI414

.LI405
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1CA9
        DEX
        BEQ     LIEX6

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI415

.LI406
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1CBD
        DEX
        BEQ     LIEX6

        DEY
        LDA     S
        ADC     P
        STA     S
        BCS     LI416

.LI407
        LDA     R
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.L1CD1
        DEX
        BEQ     LIEX6

        DEC     L000B
        DEC     L000B
        LDY     #$07
        LDA     S
        ADC     P
        STA     S
        BCS     L1CE5

        JMP     LI400

.L1CE5
        ASL     R
        BCS     L1CEC

        JMP     LI400

.L1CEC
        LDA     #$11
        STA     R
        LDA     SC
        SBC     #$08
        STA     SC
        BCS     L1CFA

        DEC     L000B
.L1CFA
        CLC
        JMP     LI400

.LIEX6
        RTS

.LI414
        ASL     R
        BCC     LI405

        LDA     #$11
        STA     R
        LDA     SC
        SBC     #$08
        STA     SC
        BCS     L1D11

        DEC     L000B
.L1D11
        CLC
        BCC     LI405

.LI415
        ASL     R
        BCC     LI406

        LDA     #$11
        STA     R
        LDA     SC
        SBC     #$08
        STA     SC
        BCS     L1D26

        DEC     L000B
.L1D26
        CLC
        BCC     LI406

.LI416
        ASL     R
        BCC     LI407

        LDA     #$11
        STA     R
        LDA     SC
        SBC     #$08
        STA     SC
        BCS     L1D3B

        DEC     L000B
.L1D3B
        CLC
        JMP     LI407

.HLOIN
        LDA     Y1
        AND     #$03
        TAX
        LDA     orange,X
        STA     COL
.HLOIN3
        STY     YSAV
        LDY     #$0F
        STY     LFE34
        LDX     XX15
        CPX     X2
        BEQ     HL6

        BCC     HL5

        LDA     X2
        STA     XX15
        STX     X2
        TAX
.HL5
        DEC     X2
        LDY     Y1
        LDA     L1576,Y
        STA     L000B
        TYA
        AND     #$07
        STA     SC
        TXA
        AND     #$FC
        ASL     A
        TAY
        BCC     HL1

        INC     L000B
.HL1
        TXA
        AND     #$FC
        STA     T
        LDA     X2
        AND     #$FC
        SEC
        SBC     T
        BEQ     HL2

        LSR     A
        LSR     A
        STA     R
        LDA     XX15
        AND     #$03
        TAX
        LDA     TWFR,X
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
        TYA
        ADC     #$08
        TAY
        BCS     HL7

.HL8
        LDX     R
        DEX
        BEQ     HL3

        CLC
.HLL1
        LDA     COL
        EOR     (SC),Y
        STA     (SC),Y
        TYA
        ADC     #$08
        TAY
        BCS     HL9

.HL10
        DEX
        BNE     HLL1

.HL3
        LDA     X2
        AND     #$03
        TAX
        LDA     L1DF5,X
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
.HL6
        LDY     #$09
        STY     LFE34
        LDY     YSAV
        RTS

.HL2
        LDA     XX15
        AND     #$03
        TAX
        LDA     TWFR,X
        STA     T
        LDA     X2
        AND     #$03
        TAX
        LDA     L1DF5,X
        AND     T
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
        LDY     #$09
        STY     LFE34
        LDY     YSAV
        RTS

.HL7
        INC     L000B
        CLC
        JMP     HL8

.HL9
        INC     L000B
        CLC
        JMP     HL10

.L1DF5
        EQUB    $88

        EQUB    $CC,$EE,$FF

.TWFR
        EQUB    $FF,$77,$33,$11

.orange
        EQUB    $A5,$A5,$5A,$5A

.PIX1
        JSR     ADD_COPY

        STA     L003F
        TXA
        STA     SYL,Y
.PIXEL2
        LDA     XX15
        BPL     PX1

        EOR     #$7F
        CLC
        ADC     #$01
.PX1
        EOR     #$80
        TAX
        LDA     Y1
        AND     #$7F
        CMP     #$60
        BCS     L1E61

        LDA     Y1
        BPL     PX2

        EOR     #$7F
        ADC     #$01
.PX2
        STA     T
        LDA     #$61
        SBC     T
.PIXEL
        STY     T1
        LDY     #$0F
        STY     LFE34
        TAY
        LDA     L1576,Y
        STA     L000B
        TXA
        AND     #$FC
        ASL     A
        STA     SC
        BCC     L1E43

        INC     L000B
.L1E43
        TYA
        AND     #$07
        TAY
        TXA
        AND     #$03
        TAX
        LDA     ZZ
        CMP     #$50
        BCC     PX2_REPEAT

        LDA     TWOS2,X
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
        LDY     #$09
        STY     LFE34
        LDY     T1
.L1E61
        RTS

.PX2_REPEAT
        LDA     TWOS2,X
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
        DEY
        BPL     L1E70

        LDY     #$01
.L1E70
        LDA     TWOS2,X
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
        LDY     #$09
        STY     LFE34
        LDY     T1
        RTS

        EQUB    $FA

        EQUB    $0F,$0F,$F0,$F0,$A5,$A5,$0F

.DOT
        LDA     #$0F
        STA     LFE34
        LDA     COMX
        STA     XX15
        LDX     COMC
        STX     COL
        LDA     COMY
        CPX     #$0F
        BNE     L1EA5

        JSR     CPIX2

        LDA     Y1
        DEC     A
.L1EA5
        JSR     CPIX2

        LDA     #$09
        STA     LFE34
        RTS

.CPIX2
        STA     Y1
        TAY
        LDA     L1576,Y
        STA     L000B
        LDA     XX15
        AND     #$FC
        ASL     A
        STA     SC
        BCC     L1EC2

        INC     L000B
        CLC
.L1EC2
        TYA
        AND     #$07
        TAY
        LDA     XX15
        AND     #$02
        TAX
        LDA     CTWOS,X
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
        LDA     L1744,X
        BPL     CP1

        LDA     SC
        ADC     #$08
        STA     SC
        BCC     L1EE3

        INC     L000B
.L1EE3
        LDA     L1744,X
.CP1
        AND     COL
        STA     R
        EOR     (SC),Y
        STA     (SC),Y
        RTS

.ECBLB2
        LDA     #$20
        STA     ECMA
.ECBLB
        LDA     #$0F
        STA     LFE34
        LDA     #$70
        STA     SC
        LDA     #$7A
        STA     L000B
        LDY     #$0F
.BULL2
        LDA     ECBT,Y
        EOR     (SC),Y
        STA     (SC),Y
        DEY
        BPL     BULL2

        BMI     L1F27

.SPBLB
        LDA     #$0F
        STA     LFE34
        LDA     #$80
        STA     SC
        LDA     #$7B
        STA     L000B
        LDY     #$0F
.BULL
        LDA     L1F2D,Y
        EOR     (SC),Y
        STA     (SC),Y
        DEY
        BPL     BULL

.L1F27
        LDA     #$09
        STA     LFE34
        RTS

.L1F2D
        EQUB    $FF

        EQUB    $FF,$AA,$FF,$FF,$00,$FF,$FF,$FF
        EQUB    $FF,$00,$FF,$FF,$55,$FF,$FF

.ECBT
        EQUB    $FF,$FF,$AA,$FF,$FF,$AA,$FF,$FF
        EQUB    $FF,$FF,$00,$FF,$FF,$00,$FF,$FF

.MSBAR
        LDA     #$0F
        STA     LFE34
        TXA
        PHA
        ASL     A
        ASL     A
        ASL     A
        ASL     A
        STA     T
        LDA     #$61
        SBC     T
        STA     SC
        LDA     #$7C
        STA     L000B
        TYA
        LDY     #$05
.MBL1
        STA     (SC),Y
        DEY
        BNE     MBL1

        PHA
        LDA     SC
        CLC
        ADC     #$08
        STA     SC
        PLA
        AND     #$AA
        LDY     #$05
.MBL2
        STA     (SC),Y
        DEY
        BNE     MBL2

        PLX
        LDA     #$09
        STA     LFE34
        RTS

.L1F85
        EQUB    $00

.HANGER
        LDX     #$02
        LDA     #$0F
        STA     LFE34
.HAL1
        STX     T
        LDA     #$82
        STX     Q
        JSR     DVID4_COPY

        LDA     P
        CLC
        ADC     #$60
        TAY
        LDA     L1576,Y
        STA     L000B
        STA     R
        LDA     P
        AND     #$07
        STA     SC
.L1FA9
        LDY     #$00
        JSR     HAS2

        LDY     R
        INY
        STY     L000B
        LDA     #$40
        LDY     #$F8
        JSR     HAS3

        LDY     L1F85
        BEQ     HA2

        LDY     #$00
        LDA     #$88
        JSR     HAL3

        DEC     L000B
        LDY     #$F8
        LDA     #$10
        JSR     HAS3

.HA2
        LDX     T
        INX
        CPX     #$0D
        BCC     HAL1

        LDA     #$3C
        STA     S
        LDA     #$10
        LDX     #$40
        STX     R
.HAL6
        LDX     R
        STX     L000B
        STA     T
        AND     #$FC
        STA     SC
        LDX     #$88
        LDY     #$01
.HAL7
        TXA
        AND     (SC),Y
        BNE     HA6

        TXA
        AND     #$F0
        ORA     (SC),Y
        STA     (SC),Y
        INY
        CPY     #$08
        BNE     HAL7

        INC     L000B
        INC     L000B
        LDY     #$00
        BEQ     HAL7

.HA6
        LDA     T
        CLC
        ADC     #$10
        BCC     L2010

        INC     R
.L2010
        DEC     S
        BNE     HAL6

        LDA     #$09
        STA     LFE34
        RTS

.HA3
        RTS

.HAS2
        LDA     #$22
.HAL2
        TAX
        AND     (SC),Y
        BNE     HA3

        TXA
        AND     #$F0
        ORA     (SC),Y
        STA     (SC),Y
        TXA
        LSR     A
        BCC     HAL2

        TYA
        ADC     #$07
        TAY
        LDA     #$88
        BCC     HAL2

        INC     L000B
.HAL3
        TAX
        AND     (SC),Y
        BNE     HA3

        TXA
        AND     #$F0
        ORA     (SC),Y
        STA     (SC),Y
        TXA
        LSR     A
        BCC     HAL3

        TYA
        ADC     #$07
        TAY
        LDA     #$88
        BCC     HAL3

        RTS

.HAS3
        TAX
        AND     (SC),Y
        BNE     HA3

        TXA
        ORA     (SC),Y
        STA     (SC),Y
        TXA
        ASL     A
        BCC     HAS3

        TYA
        SBC     #$08
        TAY
        LDA     #$10
        BCS     HAS3

        RTS

.DVID4_COPY
        LDX     #$08
        ASL     A
        STA     P
        LDA     #$00
.DVL4
        ROL     A
        BCS     DV8

        CMP     Q
        BCC     DV5

.DV8
        SBC     Q
.DV5
        ROL     P
        DEX
        BNE     DVL4

        RTS

.cls
        JSR     TTX66

        JMP     RR4

.TT67
        LDA     #$0C
.TT26
        STA     K3
        PHY
        PHX
        LDY     QQ17
        CPY     #$FF
        BEQ     RR4S

        LDY     #$0F
        STY     LFE34
        TAY
        BEQ     RR4S

        BMI     RR4S

        CMP     #$0B
        BEQ     cls

        CMP     #$07
        BNE     L20A4

        JMP     R5

.L20A4
        CMP     #$20
        BCS     RR1

        CMP     #$0A
        BEQ     RRX1

        LDX     #$01
        STX     XC
.RRX1
        CMP     #$0D
        BEQ     RR4S

        INC     YC
.RR4S
        JMP     RR4

.RR1
        LDX     #$23
        ASL     A
        ASL     A
        BCC     L20C1

        LDX     #$25
.L20C1
        ASL     A
        BCC     L20C5

        INX
.L20C5
        STA     P
        STX     L000D
        LDA     XC
        LDX     CATF
        BEQ     RR5

        CPY     #$20
        BNE     RR5

        CMP     #$11
        BEQ     RR4

.RR5
        ASL     A
        ASL     A
        ASL     A
        STA     SC
        LDA     YC
        CPY     #$7F
        BNE     RR2

        DEC     XC
        ASL     A
        ASL     SC
        ADC     #$3F
        TAX
        LDY     #$F0
        JSR     ZES2

        BEQ     RR4

.RR2
        INC     XC
        CMP     #$18
        BCC     RR3

        JSR     TTX66

        LDA     #$0F
        STA     LFE34
        LDA     #$01
        STA     XC
        STA     YC
        LDA     K3
        JMP     RR4

.RR3
        ASL     A
        ASL     SC
        ADC     #$40
        STA     L000B
        LDA     SC
        CLC
        ADC     #$08
        STA     S_COPY
        LDA     L000B
        STA     T_COPY
        LDY     #$07
.RRL1
        LDA     (P),Y
        AND     #$F0
        STA     U_COPY
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        ORA     U_COPY
        AND     COL
        EOR     (SC),Y
        STA     (SC),Y
        LDA     (P),Y
        AND     #$0F
        STA     U_COPY
        ASL     A
        ASL     A
        ASL     A
        ASL     A
        ORA     U_COPY
        AND     COL
        EOR     (S_COPY),Y
        STA     (S_COPY),Y
        DEY
        BPL     RRL1

.RR4
        LDA     #$09
        STA     LFE34
        PLX
        PLY
        LDA     K3
        CLC
        RTS

.R5
        JSR     BEEP

        JMP     RR4

.TTX66
        LDX     #$0F
        STX     LFE34
        LDX     #$40
.BOL1
        JSR     ZES1

        INX
        CPX     #$70
        BNE     BOL1

.BOX
        LDX     #$0F
        STX     LFE34
        LDA     COL
        PHA
        LDA     #$0F
        STA     COL
        LDY     #$01
        STY     YC
        STY     XC
        LDX     #$00
        STX     Y1
        STX     Y2
        STX     XX15
        DEX
        STX     X2
        JSR     LOIN

        LDA     #$02
        STA     XX15
        STA     X2
        JSR     BOS2

        JSR     BOS2

        LDA     COL
        STA     L4000
        STA     L41F8
        PLA
        STA     COL
        LDA     #$09
        STA     LFE34
        RTS

.BOS2
        JSR     BOS1

.BOS1
        STZ     Y1
        LDA     #$BF
        STA     Y2
        DEC     XX15
        DEC     X2
        JMP     LOIN

.ZES1
        LDY     #$00
        STY     SC
.ZES2
        LDA     #$00
        STX     L000B
.ZEL1
        STA     (SC),Y
        INY
        BNE     ZEL1

        RTS

.CLYNS
        STZ     DLY
        STZ     L0E7D
        LDA     #$FF
        STA     DTW2
        LDA     #$80
        STA     QQ17
        LDA     #$14
        STA     YC
        JSR     TT67

        LDA     #$0F
        STA     LFE34
        LDA     #$6A
        STA     L000B
        LDA     #$00
        STA     SC
        LDX     #$03
.CLYL
        LDY     #$08
.EE2
        STA     (SC),Y
        INY
        BNE     EE2

        INC     L000B
        STA     (SC),Y
        LDY     #$F7
.EE3
        STA     (SC),Y
        DEY
        BNE     EE3

        INC     L000B
        DEX
        BNE     CLYL

        LDA     #$09
        STA     LFE34
        LDA     #$00
        RTS

.DIALS
        LDA     #$0F
        STA     LFE34
        LDA     #$01
        STA     LDDEB
        LDA     #$A0
        STA     SC
        LDA     #$71
        STA     L000B
        JSR     PZW2

        STX     L0057
        STA     K
        LDA     #$0E
        STA     T1
        LDA     DELTA
        JSR     L22EE

        STZ     R
        STZ     P
        LDA     #$08
        STA     S
        LDA     ALP1
        LSR     A
        LSR     A
        ORA     ALP2
        EOR     #$80
        JSR     ADD_COPY

        JSR     DIL2

        LDA     BETA
        LDX     BET1
        BEQ     L2245

        SBC     #$01
.L2245
        JSR     ADD_COPY

        JSR     DIL2

        LDY     #$00
        JSR     PZW

        STX     K
        STA     L0057
        LDX     #$03
        STX     T1
.DLL23
        STY     XX15,X
        DEX
        BPL     DLL23

        LDX     #$03
        LDA     ENERGY
        LSR     A
        LSR     A
        STA     Q
.DLL24
        SEC
        SBC     #$10
        BCC     DLL26

        STA     Q
        LDA     #$10
        STA     XX15,X
        LDA     Q
        DEX
        BPL     DLL24

        BMI     DLL9

.DLL26
        LDA     Q
        STA     XX15,X
.DLL9
        LDA     XX15,Y
        STY     P
        JSR     DIL

        LDY     P
        INY
        CPY     #$04
        BNE     DLL9

        LDA     #$70
        STA     L000B
        LDA     #$20
        STA     SC
        LDA     FSH
        JSR     DILX

        LDA     ASH
        JSR     DILX

        LDA     #$0F
        STA     K
        STA     L0057
        LDA     QQ14
        JSR     L22ED

        JSR     PZW2

        STX     L0057
        STA     K
        LDX     #$0B
        STX     T1
        LDA     CABTMP
        JSR     DILX

        LDA     GNTMP
        JSR     DILX

        LDA     #$F0
        STA     T1
        LDA     #$0F
        STA     K
        STA     L0057
        LDA     ALTIT
        JSR     DILX

        LDA     #$09
        STA     LFE34
        JMP     L5AFE

.PZW2
        LDX     #$3F
        EQUB    $2C

.PZW
        LDX     #$23
        LDA     MCNT
        AND     #$08
        AND     FLH
        BEQ     L22E8

        LDA     #$0C
        RTS

.L22E8
        LDA     #$03
        RTS

.DILX
        LSR     A
        LSR     A
.L22ED
        LSR     A
.L22EE
        LSR     A
.DIL
        STA     Q
        LDX     #$FF
        STX     R
        CMP     T1
        BCS     DL30

        LDA     L0057
        BNE     DL31

.DL30
        LDA     K
.DL31
        STA     COL
        LDY     #$02
        LDX     #$07
.DL1
        LDA     Q
        CMP     #$02
        BCC     DL2

        SBC     #$02
        STA     Q
        LDA     R
.DL5
        AND     COL
        STA     (SC),Y
        INY
        STA     (SC),Y
        INY
        STA     (SC),Y
        TYA
        CLC
        ADC     #$06
        TAY
        DEX
        BMI     DL6

        BPL     DL1

.DL2
        EOR     #$01
        STA     Q
        LDA     R
.DL3
        ASL     A
        AND     #$AA
        DEC     Q
        BPL     DL3

        PHA
        STZ     R
        LDA     #$63
        STA     Q
        PLA
        JMP     DL5

.DL6
        INC     L000B
        INC     L000B
        RTS

.DIL2
        LDY     #$01
        STA     Q
.DLL10
        SEC
        LDA     Q
        SBC     #$02
        BCS     DLL11

        LDA     #$FF
        LDX     Q
        STA     Q
        LDA     CTWOS,X
        AND     #$3F
        BNE     DLL12

.DLL11
        STA     Q
        LDA     #$00
.DLL12
        STA     (SC),Y
        INY
        STA     (SC),Y
        INY
        STA     (SC),Y
        INY
        STA     (SC),Y
        TYA
        CLC
        ADC     #$05
        TAY
        CPY     #$3C
        BCC     DLL10

        INC     L000B
        INC     L000B
        RTS

.ADD_COPY
        STA     T1
        AND     #$80
        STA     T
        EOR     S
        BMI     MU8_COPY

        LDA     R
        CLC
        ADC     P
        TAX
        LDA     S
        ADC     T1
        ORA     T
        RTS

.MU8_COPY
        LDA     S
        AND     #$7F
        STA     U
        LDA     P
        SEC
        SBC     R
        TAX
        LDA     T1
        AND     #$7F
        SBC     U
        BCS     MU9_COPY

        STA     U
        TXA
        EOR     #$FF
        ADC     #$01
        TAX
        LDA     #$00
        SBC     U
        ORA     #$80
.MU9_COPY
        EOR     T
        RTS

        EQUB    $41,$23,$6D,$65,$6D,$3A,$53,$54
        EQUB    $41,$6C,$61,$74,$63,$68,$3A,$52
        EQUB    $54,$53,$0D,$13,$74,$09,$5C,$2E
        EQUB    $2E,$2E,$2E,$0D,$18,$60,$05,$20
        EQUB    $0D,$1A,$F4,$21,$5C,$2E,$2E,$2E
        EQUB    $2E,$2E,$2E,$2E,$2E,$2E,$2E,$42
        EQUB    $61,$79,$20,$56,$69,$65,$77,$2E
        EQUB    $2E,$2E,$2E,$2E,$2E,$2E,$2E,$2E
        EQUB    $2E,$0D,$1A,$FE,$05,$20,$0D,$1B
        EQUB    $08,$11,$2E,$48,$41

        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $18,$18,$18,$18,$18,$00,$18,$00
        EQUB    $6C,$6C,$6C,$00,$00,$00,$00,$00
        EQUB    $36,$36,$7F,$36,$7F,$36,$36,$00
        EQUB    $0C,$3F,$68,$3E,$0B,$7E,$18,$00
        EQUB    $60,$66,$0C,$18,$30,$66,$06,$00
        EQUB    $38,$6C,$6C,$38,$6D,$66,$3B,$00
        EQUB    $0C,$18,$30,$00,$00,$00,$00,$00
        EQUB    $0C,$18,$30,$30,$30,$18,$0C,$00
        EQUB    $30,$18,$0C,$0C,$0C,$18,$30,$00
        EQUB    $00,$18,$7E,$3C,$7E,$18,$00,$00
        EQUB    $00,$18,$18,$7E,$18,$18,$00,$00
        EQUB    $00,$00,$00,$00,$00,$18,$18,$30
        EQUB    $00,$00,$00,$7E,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$18,$18,$00
        EQUB    $00,$06,$0C,$18,$30,$60,$00,$00
        EQUB    $3C,$66,$6E,$7E,$76,$66,$3C,$00
        EQUB    $18,$38,$18,$18,$18,$18,$7E,$00
        EQUB    $3C,$66,$06,$0C,$18,$30,$7E,$00
        EQUB    $3C,$66,$06,$1C,$06,$66,$3C,$00
        EQUB    $0C,$1C,$3C,$6C,$7E,$0C,$0C,$00
        EQUB    $7E,$60,$7C,$06,$06,$66,$3C,$00
        EQUB    $1C,$30,$60,$7C,$66,$66,$3C,$00
        EQUB    $7E,$06,$0C,$18,$30,$30,$30,$00
        EQUB    $3C,$66,$66,$3C,$66,$66,$3C,$00
        EQUB    $3C,$66,$66,$3E,$06,$0C,$38,$00
        EQUB    $00,$00,$18,$18,$00,$18,$18,$00
        EQUB    $00,$00,$18,$18,$00,$18,$18,$30
        EQUB    $0C,$18,$30,$60,$30,$18,$0C,$00
        EQUB    $00,$00,$7E,$00,$7E,$00,$00,$00
        EQUB    $30,$18,$0C,$06,$0C,$18,$30,$00
        EQUB    $3C,$66,$0C,$18,$18,$00,$18,$00
        EQUB    $3C,$66,$6E,$6A,$6E,$60,$3C,$00
        EQUB    $3C,$66,$66,$7E,$66,$66,$66,$00
        EQUB    $7C,$66,$66,$7C,$66,$66,$7C,$00
        EQUB    $3C,$66,$60,$60,$60,$66,$3C,$00
        EQUB    $78,$6C,$66,$66,$66,$6C,$78,$00
        EQUB    $7E,$60,$60,$7C,$60,$60,$7E,$00
        EQUB    $7E,$60,$60,$7C,$60,$60,$60,$00
        EQUB    $3C,$66,$60,$6E,$66,$66,$3C,$00
        EQUB    $66,$66,$66,$7E,$66,$66,$66,$00
        EQUB    $7E,$18,$18,$18,$18,$18,$7E,$00
        EQUB    $3E,$0C,$0C,$0C,$0C,$6C,$38,$00
        EQUB    $66,$6C,$78,$70,$78,$6C,$66,$00
        EQUB    $60,$60,$60,$60,$60,$60,$7E,$00
        EQUB    $63,$77,$7F,$6B,$6B,$63,$63,$00
        EQUB    $66,$66,$76,$7E,$6E,$66,$66,$00
        EQUB    $3C,$66,$66,$66,$66,$66,$3C,$00
        EQUB    $7C,$66,$66,$7C,$60,$60,$60,$00
        EQUB    $3C,$66,$66,$66,$6A,$6C,$36,$00
        EQUB    $7C,$66,$66,$7C,$6C,$66,$66,$00
        EQUB    $3C,$66,$60,$3C,$06,$66,$3C,$00
        EQUB    $7E,$18,$18,$18,$18,$18,$18,$00
        EQUB    $66,$66,$66,$66,$66,$66,$3C,$00
        EQUB    $66,$66,$66,$66,$66,$3C,$18,$00
        EQUB    $63,$63,$6B,$6B,$7F,$77,$63,$00
        EQUB    $66,$66,$3C,$18,$3C,$66,$66,$00
        EQUB    $66,$66,$66,$3C,$18,$18,$18,$00
        EQUB    $7E,$06,$0C,$18,$30,$60,$7E,$00
        EQUB    $7C,$60,$60,$60,$60,$60,$7C,$00
        EQUB    $00,$60,$30,$18,$0C,$06,$00,$00
        EQUB    $3E,$06,$06,$06,$06,$06,$3E,$00
        EQUB    $18,$3C,$66,$42,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$FF
        EQUB    $1C,$36,$30,$7C,$30,$30,$7E,$00
        EQUB    $00,$00,$3C,$06,$3E,$66,$3E,$00
        EQUB    $60,$60,$7C,$66,$66,$66,$7C,$00
        EQUB    $00,$00,$3C,$66,$60,$66,$3C,$00
        EQUB    $06,$06,$3E,$66,$66,$66,$3E,$00
        EQUB    $00,$00,$3C,$66,$7E,$60,$3C,$00
        EQUB    $1C,$30,$30,$7C,$30,$30,$30,$00
        EQUB    $00,$00,$3E,$66,$66,$3E,$06,$3C
        EQUB    $60,$60,$7C,$66,$66,$66,$66,$00
        EQUB    $18,$00,$38,$18,$18,$18,$3C,$00
        EQUB    $18,$00,$38,$18,$18,$18,$18,$70
        EQUB    $60,$60,$66,$6C,$78,$6C,$66,$00
        EQUB    $38,$18,$18,$18,$18,$18,$3C,$00
        EQUB    $00,$00,$36,$7F,$6B,$6B,$63,$00
        EQUB    $00,$00,$7C,$66,$66,$66,$66,$00
        EQUB    $00,$00,$3C,$66,$66,$66,$3C,$00
        EQUB    $00,$00,$7C,$66,$66,$7C,$60,$60
        EQUB    $00,$00,$3E,$66,$66,$3E,$06,$07
        EQUB    $00,$00,$6C,$76,$60,$60,$60,$00
        EQUB    $00,$00,$3E,$60,$3C,$06,$7C,$00
        EQUB    $30,$30,$7C,$30,$30,$30,$1C,$00
        EQUB    $00,$00,$66,$66,$66,$66,$3E,$00
        EQUB    $00,$00,$66,$66,$66,$3C,$18,$00
        EQUB    $00,$00,$63,$6B,$6B,$7F,$36,$00
        EQUB    $00,$00,$66,$3C,$18,$3C,$66,$00
        EQUB    $00,$00,$66,$66,$66,$3E,$06,$3C
        EQUB    $00,$00,$7E,$0C,$18,$30,$7E,$00
        EQUB    $0C,$18,$18,$70,$18,$18,$0C,$00
        EQUB    $18,$18,$18,$00,$18,$18,$18,$00
        EQUB    $30,$18,$18,$0E,$18,$18,$30,$00
        EQUB    $31,$6B,$46,$00,$00,$00,$00,$00
        EQUB    $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF

.log
        EQUB    $00,$00,$20,$32,$40,$4A,$52,$59
        EQUB    $60,$65,$6A,$6E,$72,$76,$79,$7D
        EQUB    $80,$82,$85,$87,$8A,$8C,$8E,$90
        EQUB    $92,$94,$96,$98,$99,$9B,$9D,$9E
        EQUB    $A0,$A1,$A2,$A4,$A5,$A6,$A7,$A9
        EQUB    $AA,$AB,$AC,$AD,$AE,$AF,$B0,$B1
        EQUB    $B2,$B3,$B4,$B5,$B6,$B7,$B8,$B9
        EQUB    $B9,$BA,$BB,$BC,$BD,$BD,$BE,$BF
        EQUB    $C0,$C0,$C1,$C2,$C2,$C3,$C4,$C4
        EQUB    $C5,$C6,$C6,$C7,$C7,$C8,$C9,$C9
        EQUB    $CA,$CA,$CB,$CC,$CC,$CD,$CD,$CE
        EQUB    $CE,$CF,$CF,$D0,$D0,$D1,$D1,$D2
        EQUB    $D2,$D3,$D3,$D4,$D4,$D5,$D5,$D5
        EQUB    $D6,$D6,$D7,$D7,$D8,$D8,$D9,$D9
        EQUB    $D9,$DA,$DA,$DB,$DB,$DB,$DC,$DC
        EQUB    $DD,$DD,$DD,$DE,$DE,$DE,$DF,$DF
        EQUB    $E0,$E0,$E0,$E1,$E1,$E1,$E2,$E2
        EQUB    $E2,$E3,$E3,$E3,$E4,$E4,$E4,$E5
        EQUB    $E5,$E5,$E6,$E6,$E6,$E7,$E7,$E7
        EQUB    $E7,$E8,$E8,$E8,$E9,$E9,$E9,$EA
        EQUB    $EA,$EA,$EA,$EB,$EB,$EB,$EC,$EC
        EQUB    $EC,$EC,$ED,$ED,$ED,$ED,$EE,$EE
        EQUB    $EE,$EE,$EF,$EF,$EF,$EF,$F0,$F0
        EQUB    $F0,$F1,$F1,$F1,$F1,$F1,$F2,$F2
        EQUB    $F2,$F2,$F3,$F3,$F3,$F3,$F4,$F4
        EQUB    $F4,$F4,$F5,$F5,$F5,$F5,$F5,$F6
        EQUB    $F6,$F6,$F6,$F7,$F7,$F7,$F7,$F7
        EQUB    $F8,$F8,$F8,$F8,$F9,$F9,$F9,$F9
        EQUB    $F9,$FA,$FA,$FA,$FA,$FA,$FB,$FB
        EQUB    $FB,$FB,$FB,$FC,$FC,$FC,$FC,$FC
        EQUB    $FD,$FD,$FD,$FD,$FD,$FD,$FE,$FE
        EQUB    $FE,$FE,$FE,$FF,$FF,$FF,$FF,$FF

.logL
        EQUB    $60,$00,$00,$B8,$00,$4D,$B8,$D6
        EQUB    $00,$70,$4D,$B4,$B8,$6A,$D6,$05
        EQUB    $00,$CC,$70,$EF,$4D,$8E,$B4,$C1
        EQUB    $B8,$9A,$6A,$28,$D6,$75,$05,$89
        EQUB    $00,$6C,$CC,$23,$70,$B4,$EF,$22
        EQUB    $4D,$71,$8E,$A4,$B4,$BD,$C1,$BF
        EQUB    $B8,$AC,$9A,$85,$6A,$4B,$28,$01
        EQUB    $D6,$A7,$75,$3F,$05,$C9,$89,$46
        EQUB    $00,$B7,$6C,$1D,$CC,$79,$23,$CB
        EQUB    $70,$13,$B4,$52,$EF,$8A,$22,$B9
        EQUB    $4D,$E0,$71,$00,$8E,$1A,$A4,$2D
        EQUB    $B4,$39,$BD,$40,$C1,$41,$BF,$3C
        EQUB    $B8,$32,$AC,$24,$9A,$10,$85,$F8
        EQUB    $6A,$DB,$4B,$BA,$28,$95,$01,$6C
        EQUB    $D6,$3F,$A7,$0E,$75,$DA,$3F,$A2
        EQUB    $05,$67,$C9,$29,$89,$E8,$46,$A3
        EQUB    $00,$5C,$B7,$12,$6C,$C5,$1D,$75
        EQUB    $CC,$23,$79,$CE,$23,$77,$CB,$1E
        EQUB    $70,$C2,$13,$64,$B4,$03,$52,$A1
        EQUB    $EF,$3D,$8A,$D6,$22,$6E,$B9,$03
        EQUB    $4D,$97,$E0,$29,$71,$B9,$00,$47
        EQUB    $8E,$D4,$1A,$5F,$A4,$E8,$2D,$70
        EQUB    $B4,$F7,$39,$7B,$BD,$FF,$40,$81
        EQUB    $C1,$01,$41,$80,$BF,$FE,$3C,$7A
        EQUB    $B8,$F5,$32,$6F,$AC,$E8,$24,$5F
        EQUB    $9A,$D5,$10,$4A,$85,$BE,$F8,$31
        EQUB    $6A,$A3,$DB,$13,$4B,$83,$BA,$F1
        EQUB    $28,$5F,$95,$CB,$01,$36,$6C,$A1
        EQUB    $D6,$0A,$3F,$73,$A7,$DB,$0E,$42
        EQUB    $75,$A7,$DA,$0C,$3F,$71,$A2,$D4
        EQUB    $05,$36,$67,$98,$C9,$F9,$29,$59
        EQUB    $89,$B8,$E8,$17,$46,$75,$A3,$D2

.antilog
        EQUB    $01,$01,$01,$01,$01,$01,$01,$01
        EQUB    $01,$01,$01,$01,$01,$01,$01,$01
        EQUB    $01,$01,$01,$01,$01,$01,$01,$01
        EQUB    $01,$01,$01,$01,$01,$01,$01,$01
        EQUB    $02,$02,$02,$02,$02,$02,$02,$02
        EQUB    $02,$02,$02,$02,$02,$02,$02,$02
        EQUB    $02,$02,$02,$03,$03,$03,$03,$03
        EQUB    $03,$03,$03,$03,$03,$03,$03,$03
        EQUB    $04,$04,$04,$04,$04,$04,$04,$04
        EQUB    $04,$04,$04,$05,$05,$05,$05,$05
        EQUB    $05,$05,$05,$06,$06,$06,$06,$06
        EQUB    $06,$06,$07,$07,$07,$07,$07,$07
        EQUB    $08,$08,$08,$08,$08,$08,$09,$09
        EQUB    $09,$09,$09,$0A,$0A,$0A,$0A,$0B
        EQUB    $0B,$0B,$0B,$0C,$0C,$0C,$0C,$0D
        EQUB    $0D,$0D,$0E,$0E,$0E,$0E,$0F,$0F
        EQUB    $10,$10,$10,$11,$11,$11,$12,$12
        EQUB    $13,$13,$13,$14,$14,$15,$15,$16
        EQUB    $16,$17,$17,$18,$18,$19,$19,$1A
        EQUB    $1A,$1B,$1C,$1C,$1D,$1D,$1E,$1F
        EQUB    $20,$20,$21,$22,$22,$23,$24,$25
        EQUB    $26,$26,$27,$28,$29,$2A,$2B,$2C
        EQUB    $2D,$2E,$2F,$30,$31,$32,$33,$34
        EQUB    $35,$36,$38,$39,$3A,$3B,$3D,$3E
        EQUB    $40,$41,$42,$44,$45,$47,$48,$4A
        EQUB    $4C,$4D,$4F,$51,$52,$54,$56,$58
        EQUB    $5A,$5C,$5E,$60,$62,$64,$67,$69
        EQUB    $6B,$6D,$70,$72,$75,$77,$7A,$7D
        EQUB    $80,$82,$85,$88,$8B,$8E,$91,$94
        EQUB    $98,$9B,$9E,$A2,$A5,$A9,$AD,$B1
        EQUB    $B5,$B8,$BD,$C1,$C5,$C9,$CE,$D2
        EQUB    $D7,$DB,$E0,$E5,$EA,$EF,$F5,$FA

        EQUB    $01,$02,$03,$04,$05,$06,$00,$01
        EQUB    $02,$03,$04,$05,$06,$00,$01,$02
        EQUB    $03,$04,$05,$06,$00,$01,$02,$03
        EQUB    $04,$05,$06,$00,$01,$02,$03,$04
        EQUB    $05,$06,$00,$01,$02,$03,$04,$05
        EQUB    $06,$00,$01,$02,$03,$04,$05,$06
        EQUB    $00,$01,$02,$03,$04,$05,$06,$00
        EQUB    $01,$02,$03,$04,$05,$06,$00,$01
        EQUB    $02,$03,$04,$05,$06,$00,$01,$02
        EQUB    $03,$04,$05,$06,$00,$01,$02,$03
        EQUB    $04,$05,$06,$00,$01,$02,$03,$04
        EQUB    $05,$06,$00,$01,$02,$03,$04,$05
        EQUB    $06,$00,$01,$02,$03,$04,$05,$06
        EQUB    $00,$01,$02,$03,$04,$05,$06,$00
        EQUB    $01,$02,$03,$04,$05,$06,$00,$01
        EQUB    $02,$03,$04,$05,$06,$00,$01,$02
        EQUB    $03,$04,$05,$06,$00,$01,$02,$03
        EQUB    $04,$05,$06,$00,$01,$02,$03,$04
        EQUB    $05,$06,$00,$01,$02,$03,$04,$05
        EQUB    $06,$00,$01,$02,$03,$04,$05,$06
        EQUB    $00,$01,$02,$03,$04,$05,$06,$00
        EQUB    $01,$02,$03,$04,$05,$06,$00,$01
        EQUB    $02,$03,$04,$05,$06,$00,$01,$02
        EQUB    $03,$04,$05,$06,$00,$01,$02,$03
        EQUB    $04,$05,$06,$00,$01,$02,$03,$04
        EQUB    $05,$06,$00,$01,$02,$03,$04,$05
        EQUB    $06,$00,$01,$02,$03,$04,$05,$06
        EQUB    $00,$01,$02,$03,$04,$05,$06,$00
        EQUB    $01,$02,$03,$04,$05,$06,$00,$01
        EQUB    $02,$03,$04,$05,$06,$00,$01,$02
        EQUB    $03,$04,$05,$06,$00,$01,$02,$03
        EQUB    $04,$05,$06,$00,$01,$02,$03,$04
        EQUB    $01,$01,$01,$01,$01,$01,$02,$02
        EQUB    $02,$02,$02,$02,$02,$03,$03,$03
        EQUB    $03,$03,$03,$03,$04,$04,$04,$04
        EQUB    $04,$04,$04,$05,$05,$05,$05,$05
        EQUB    $05,$05,$06,$06,$06,$06,$06,$06
        EQUB    $06,$07,$07,$07,$07,$07,$07,$07
        EQUB    $08,$08,$08,$08,$08,$08,$08,$09
        EQUB    $09,$09,$09,$09,$09,$09,$0A,$0A
        EQUB    $0A,$0A,$0A,$0A,$0A,$0B,$0B,$0B
        EQUB    $0B,$0B,$0B,$0B,$0C,$0C,$0C,$0C
        EQUB    $0C,$0C,$0C,$0D,$0D,$0D,$0D,$0D
        EQUB    $0D,$0D,$0E,$0E,$0E,$0E,$0E,$0E
        EQUB    $0E,$0F,$0F,$0F,$0F,$0F,$0F,$0F
        EQUB    $10,$10,$10,$10,$10,$10,$10,$11
        EQUB    $11,$11,$11,$11,$11,$11,$12,$12
        EQUB    $12,$12,$12,$12,$12,$13,$13,$13
        EQUB    $13,$13,$13,$13,$14,$14,$14,$14
        EQUB    $14,$14,$14,$15,$15,$15,$15,$15
        EQUB    $15,$15,$16,$16,$16,$16,$16,$16
        EQUB    $16,$17,$17,$17,$17,$17,$17,$17
        EQUB    $18,$18,$18,$18,$18,$18,$18,$19
        EQUB    $19,$19,$19,$19,$19,$19,$1A,$1A
        EQUB    $1A,$1A,$1A,$1A,$1A,$1B,$1B,$1B
        EQUB    $1B,$1B,$1B,$1B,$1C,$1C,$1C,$1C
        EQUB    $1C,$1C,$1C,$1D,$1D,$1D,$1D,$1D
        EQUB    $1D,$1D,$1E,$1E,$1E,$1E,$1E,$1E
        EQUB    $1E,$1F,$1F,$1F,$1F,$1F,$1F,$1F
        EQUB    $20,$20,$20,$20,$20,$20,$20,$21
        EQUB    $21,$21,$21,$21,$21,$21,$22,$22
        EQUB    $22,$22,$22,$22,$22,$23,$23,$23
        EQUB    $23,$23,$23,$23,$24,$24,$24,$24
        EQUB    $24,$24,$24,$25,$25,$25,$25,$25
        EQUB    $96,$97,$9A,$9B,$9D,$9E,$9F,$A6
        EQUB    $A7,$AB,$AC,$AD,$AE,$AF,$B2,$B3
        EQUB    $B4,$B5,$B6,$B7,$B9,$BA,$BB,$BC
        EQUB    $BD,$BE,$BF,$CB,$CD,$CE,$CF,$D3
        EQUB    $D6,$D7,$D9,$DA,$DB,$DC,$DD,$DE
        EQUB    $DF,$E5,$E6,$E7,$E9,$EA,$EB,$EC
        EQUB    $ED,$EE,$EF,$F2,$F3,$F4,$F5,$F6
        EQUB    $F7,$F9,$FA,$FB,$FC,$FD,$FE,$FF

.COMC
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00

.CATF
        EQUB    $00,$00

.L2C55
        EQUB    $00

.DAMP
        EQUB    $00

.DJD
        EQUB    $00

.L2C58
        EQUB    $00

.FLH
        EQUB    $00

.L2C5A
        EQUB    $00

.L2C5B
        EQUB    $00

.L2C5C
        EQUB    $00,$00,$00

.BSTK
        EQUB    $00,$00

.L2C61
        EQUB    $07

.L2C62
        EQUB    $01,$41,$58,$46,$59,$4A,$4B,$55
        EQUB    $54,$60

.S%
        CLD
        JSR     MOVE_CODE

        JSR     BRKBK

        JMP     BEGIN

.MOVE_CODE
        LDA     #$C0
        STA     FRIN
        LDA     #$2C
        STA     L0E42
        LDA     #$7F
        LDY     #$47
        LDX     #$19
        JSR     MOVE_CODE_L1

        LDA     #$FF
        STA     FRIN
        LDA     #$7F
        STA     L0E42
        LDA     #$B1
        LDY     #$FF
        LDX     #$62
.MOVE_CODE_L1
        STX     T
        STA     L000B
        LDA     #$00
        STA     SC
.MOVE_CODE_L2
        LDA     (SC),Y
        SEC
        SBC     T
        STA     (SC),Y
        STA     T
        TYA
        BNE     L2CAF

        DEC     L000B
.L2CAF
        DEY
        CPY     FRIN
        BNE     MOVE_CODE_L2

        LDA     L000B
        CMP     L0E42
        BNE     MOVE_CODE_L2

        RTS

        EQUB    $B7

        EQUB    $AA,$45,$23

.DOENTRY
        JSR     RES2

        JSR     LAUN

        LDA     #$00
        STA     DELTA
        STA     GNTMP
        STA     L0045
        LDA     #$FF
        STA     FSH
        STA     ASH
        STA     ENERGY
        JSR     HALL

        LDY     #$2C
        JSR     DELAY

        LDA     TP
        AND     #$03
        BNE     EN1

        LDA     L127C
        BEQ     EN4

        LDA     GCNT
        LSR     A
        BNE     EN4

        JMP     BRIEF

.EN1
        CMP     #$03
        BNE     EN2

        JMP     DEBRIEF

.EN2
        LDA     GCNT
        CMP     #$02
        BNE     EN4

        LDA     TP
        AND     #$0F
        CMP     #$02
        BNE     EN3

        LDA     L127C
        CMP     #$05
        BCC     EN4

        JMP     BRIEF2

.EN3
        CMP     #$06
        BNE     EN5

        LDA     QQ0
        CMP     #$D7
        BNE     EN4

        LDA     QQ1
        CMP     #$54
        BNE     EN4

        JMP     BRIEF3

.EN5
        CMP     #$0A
        BNE     EN4

        LDA     QQ0
        CMP     #$3F
        BNE     EN4

        LDA     QQ1
        CMP     #$48
        BNE     EN4

        JMP     DEBRIEF2

.EN4
        JMP     BAY

        EQUB    $FB

        EQUB    $04,$F7,$08,$EF,$10,$DF,$20,$BF
        EQUB    $40,$7F,$80

.M%
        LDA     K%
        STA     RAND
        LDX     JSTX
        JSR     cntr

        JSR     cntr

        TXA
        EOR     #$80
        TAY
        AND     #$80
        STA     ALP2
        STX     JSTX
        EOR     #$80
        STA     L0049
        TYA
        BPL     L2D72

        EOR     #$FF
        CLC
        ADC     #$01
.L2D72
        LSR     A
        LSR     A
        CMP     #$08
        BCS     L2D79

        LSR     A
.L2D79
        STA     ALP1
        ORA     ALP2
        STA     ALPHA
        LDX     JSTY
        JSR     cntr

        TXA
        EOR     #$80
        TAY
        AND     #$80
        STX     JSTY
        STA     L0074
        EOR     #$80
        STA     BET2
        TYA
        BPL     L2D97

        EOR     #$FF
.L2D97
        ADC     #$04
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        CMP     #$03
        BCS     L2DA2

        LSR     A
.L2DA2
        STA     BET1
        ORA     BET2
        STA     BETA
        LDA     BSTK
        BEQ     BS2

        LDA     L12A9
        LSR     A
        LSR     A
        CMP     #$28
        BCC     L2DB8

        LDA     #$28
.L2DB8
        STA     DELTA
        BNE     MA4

.BS2
        LDA     KY2
        BEQ     MA17

        LDA     DELTA
        CMP     #$28
        BCS     MA17

        INC     DELTA
.MA17
        LDA     KY1
        BEQ     MA4

        DEC     DELTA
        BNE     MA4

        INC     DELTA
.MA4
        LDA     KY15
        AND     NOMSL
        BEQ     MA20

        LDY     #$0C
        JSR     ABORT

        JSR     BEEP_LONG_LOW

        LDA     #$00
        STA     MSAR
.MA20
        LDA     MSTG
        BPL     MA25

        LDA     KY14
        BEQ     MA25

        LDX     NOMSL
        BEQ     MA25

        STA     MSAR
        LDY     #$0F
        JSR     MSBAR

.MA25
        LDA     KY16
        BEQ     MA24

        LDA     MSTG
        BMI     MA64

        JSR     FRMIS

.MA24
        LDA     KY12
        BEQ     MA76

        LDA     BOMB
        BMI     MA76

        ASL     BOMB
        BEQ     MA76

        JSR     L31ED

.MA76
        LDA     KY20
        BEQ     MA78

        LDA     #$00
        STA     auto
.MA78
        LDA     KY13
        AND     ESCP
        BEQ     noescp

        LDA     MJ
        BNE     noescp

        JMP     ESCAPE

.noescp
        LDA     KY18
        BEQ     L2E36

        JSR     WARP

.L2E36
        LDA     KY17
        AND     ECM
        BEQ     MA64

        LDA     ECMA
        BNE     MA64

        DEC     ECMP
        JSR     ECBLB2

.MA64
        LDA     KY19
        AND     DKCMP
        BEQ     MA68

        STA     auto
.MA68
        LDA     #$00
        STA     LAS
        STA     DELT4
        LDA     DELTA
        LSR     A
        ROR     DELT4
        LSR     A
        ROR     DELT4
        STA     L0077
        LDA     LASCT
        BNE     MA3

        LDA     KY7
        BEQ     MA3

        LDA     GNTMP
        CMP     #$F2
        BCS     MA3

        LDX     VIEW
        LDA     LASER,X
        BEQ     MA3

        PHA
        AND     #$7F
        STA     LAS
        STA     LAS2
        JSR     LASER_NOISE

        JSR     LASLI

        PLA
        BPL     ma1

        LDA     #$00
.ma1
        AND     #$FA
        STA     LASCT
.MA3
        LDX     #$00
.MAL1
        STX     XSAV
        LDA     FRIN,X
        BNE     L2E9D

        JMP     MA18

.L2E9D
        STA     TYPE
        JSR     GINF

        LDY     #$24
.MAL2
        LDA     (INF),Y
        STA     INWK,Y
        DEY
        BPL     MAL2

        LDA     TYPE
        BMI     MA21

        ASL     A
        TAY
        LDA     L7FFE,Y
        STA     XX0
        LDA     L7FFF,Y
        STA     L0037
        LDA     BOMB
        BPL     MA21

        CPY     #$04
        BEQ     MA21

        CPY     #$3A
        BEQ     MA21

        CPY     #$3E
        BCS     MA21

        LDA     L00BB
        AND     #$20
        BNE     MA21

        ASL     L00BB
        SEC
        ROR     L00BB
        LDX     TYPE
        JSR     EXNO2

.MA21
        JSR     MVEIT

        LDY     #$24
.MAL3
        LDA     INWK,Y
        STA     (INF),Y
        DEY
        BPL     MAL3

        LDA     L00BB
        AND     #$A0
        JSR     MAS4

        BNE     MA65

        LDA     INWK
        ORA     L009F
        ORA     L00A2
        BMI     MA65

        LDX     TYPE
        BMI     MA65

        CPX     #$02
        BEQ     ISDK

        AND     #$C0
        BNE     MA65

        CPX     #$01
        BEQ     MA65

        LDA     BST
        AND     L00A1
        BPL     MA58

        CPX     #$05
        BEQ     oily

        LDY     #$00
        LDA     (XX0),Y
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        BEQ     MA58

        ADC     #$01
        BNE     slvy2

.oily
        JSR     DORND

        AND     #$07
.slvy2
        JSR     tnpr1

        LDY     #$4E
        BCS     MA59

        LDY     QQ29
        ADC     QQ20,Y
        STA     QQ20,Y
        TYA
        ADC     #$D0
        JSR     MESS

        ASL     NEWB
        SEC
        ROR     NEWB
.MA65
        JMP     MA26

.ISDK
        LDA     L0449
        AND     #$04
        BNE     MA62

        LDA     L00AA
        CMP     #$D6
        BCC     MA62

        JSR     SPS1

        LDA     X2
        CMP     #$59
        BCC     MA62

        LDA     L00AC
        AND     #$7F
        CMP     #$50
        BCC     MA62

.GOIN
        JMP     DOENTRY

.MA62
        LDA     DELTA
        CMP     #$05
        BCC     MA67

        JMP     DEATH

.MA59
        JSR     EXNO3

        ASL     L00BB
        SEC
        ROR     L00BB
        BNE     MA26

.MA67
        LDA     #$01
        STA     DELTA
        LDA     #$05
        BNE     MA63

.MA58
        ASL     L00BB
        SEC
        ROR     L00BB
        LDA     L00BF
        SEC
        ROR     A
.MA63
        JSR     OOPS

        JSR     EXNO3

.MA26
        LDA     NEWB
        BPL     L2F99

        JSR     SCAN

.L2F99
        LDA     QQ11
        BNE     MA15

        JSR     PLUT

        JSR     HITCH

        BCC     MA8

        LDA     MSAR
        BEQ     MA47

        JSR     BEEP

        LDX     XSAV
        LDY     #$03
        JSR     ABORT2

.MA47
        LDA     LAS
        BEQ     MA8

        LDX     #$0F
        JSR     EXNO

        LDA     TYPE
        CMP     #$02
        BEQ     L3004

        CMP     #$1F
        BCC     BURN

        LDA     LAS
        CMP     #$17
        BNE     L3004

        LSR     LAS
        LSR     LAS
.BURN
        LDA     L00BF
        SEC
        SBC     LAS
        BCS     MA14

        ASL     L00BB
        SEC
        ROR     L00BB
        LDA     TYPE
        CMP     #$07
        BNE     nosp

        LDA     LAS
        CMP     #$32
        BNE     nosp

        JSR     DORND

        LDX     #$08
        AND     #$03
        JSR     SPIN2

.nosp
        LDY     #$04
        JSR     SPIN

        LDY     #$05
        JSR     SPIN

        LDX     TYPE
.L2FFF
        JSR     EXNO2

L3000 = L2FFF+1
.MA14
        STA     L00BF
.L3004
        LDA     TYPE
        JSR     ANGRY

.MA8
        JSR     LL9

.MA15
        LDY     #$23
        LDA     L00BF
        STA     (INF),Y
        LDA     NEWB
        BMI     KS1S

        LDA     L00BB
        BPL     MAC1

        AND     #$20
        BEQ     MAC1

        LDA     NEWB
        AND     #$40
        ORA     FIST
        STA     FIST
        LDA     DLY
        ORA     MJ
        BNE     KS1S

        LDY     #$0A
        LDA     (XX0),Y
        BEQ     KS1S

        TAX
        INY
        LDA     (XX0),Y
        TAY
        JSR     MCASH

        LDA     #$00
        JSR     MESS

.KS1S
        JMP     KS1

.MAC1
        LDA     TYPE
        BMI     MA27

        JSR     FAROF

        BCC     KS1S

.MA27
        LDY     #$1F
        LDA     L00BB
        STA     (INF),Y
        LDX     XSAV
        INX
        JMP     MAL1

.MA18
        LDA     BOMB
        BPL     MA77

        JSR     WSCAN_COPY

        ASL     BOMB
        BMI     MA77

        JSR     L31AC

.MA77
        LDA     MCNT
        AND     #$07
        BNE     MA22

        LDX     ENERGY
        BPL     b

        LDX     ASH
        JSR     SHD

        STX     ASH
        LDX     FSH
        JSR     SHD

        STX     FSH
.b
        SEC
        LDA     ENGY
        ADC     ENERGY
        BCS     L308D

        STA     ENERGY
.L308D
        LDA     MJ
        BNE     MA23S

        LDA     MCNT
        AND     #$1F
        BNE     MA93

        LDA     SSPR
        BNE     MA23S

        TAY
        JSR     MAS2

        BNE     MA23S

        LDX     #$1C
.MAL4
        LDA     K%,X
        STA     INWK,X
        DEX
        BPL     MAL4

        INX
        LDY     #$09
        JSR     MAS1

        BNE     MA23S

        LDX     #$03
        LDY     #$0B
        JSR     MAS1

        BNE     MA23S

        LDX     #$06
        LDY     #$0D
        JSR     MAS1

        BNE     MA23S

        LDA     #$C0
        JSR     FAROF2

        BCC     MA23S

        JSR     WPLS

        JSR     NWSPS

.MA23S
        JMP     MA23

.MA22
        LDA     MJ
        BNE     MA23S

        LDA     MCNT
        AND     #$1F
.MA93
        CMP     #$0A
        BNE     MA29

        LDA     #$32
        CMP     ENERGY
        BCC     L30EE

        ASL     A
        JSR     MESS

.L30EE
        LDY     #$FF
        STY     ALTIT
        INY
        JSR     m

        BNE     MA23

        JSR     MAS3

        BCS     MA23

        SBC     #$24
        BCC     MA28

        STA     R
        JSR     LL5

        LDA     Q
        STA     ALTIT
        BNE     MA23

.MA28
        JMP     DEATH

.MA29
        CMP     #$0F
        BNE     MA33

        LDA     auto
        BEQ     MA23

        LDA     #$7B
        BNE     MA34

.MA33
        CMP     #$14
        BNE     MA23

        LDA     #$1E
        STA     CABTMP
        LDA     SSPR
        BNE     MA23

        LDY     #$25
        JSR     MAS2

        BNE     MA23

        JSR     MAS3

        EOR     #$FF
        ADC     #$1E
        STA     CABTMP
        BCS     MA28

        CMP     #$E0
        BCC     MA23

        LDA     BST
        BEQ     MA23

        LDA     L0077
        LSR     A
        ADC     QQ14
        CMP     #$46
        BCC     L3154

        LDA     #$46
.L3154
        STA     QQ14
        LDA     #$A0
.MA34
        JSR     MESS

.MA23
        LDA     LAS2
        BEQ     MA16

        LDA     LASCT
        CMP     #$08
        BCS     MA16

        JSR     LASLI2

        LDA     #$00
        STA     LAS2
.MA16
        LDA     ECMP
        BEQ     MA69

        JSR     DENGY

        BEQ     MA70

.MA69
        LDA     ECMA
        BEQ     MA66

        LDY     #$07
        JSR     NOISE

        DEC     ECMA
        BNE     MA66

.MA70
        JSR     ECMOF

.MA66
        LDA     QQ11
        BNE     oh

        JMP     STARS

.SPIN
        JSR     DORND

        BPL     oh

        TYA
        TAX
        LDY     #$00
        AND     (XX0),Y
        AND     #$0F
.SPIN2
        STA     CNT
        BEQ     oh

.L31A2
        LDA     #$00
        JSR     SFS1

        DEC     CNT
        BNE     L31A2

.oh
        RTS

.L31AC
        LDA     #$FF
        STA     COL
        LDA     QQ11
        BNE     L31DE

        LDY     #$01
        LDA     L321D
        STA     XX12
        LDA     L3227
        STA     L0051
.L31C0
        LDA     XX12
        STA     XX15
        LDA     L0051
        STA     Y1
        LDA     L321D,Y
        STA     X2
        STA     XX12
        LDA     L3227,Y
        STA     Y2
        STA     L0051
        JSR     LL30

        INY
        CPY     #$0A
        BCC     L31C0

.L31DE
        RTS

.WSCAN_COPY
        JSR     L31E2

.L31E2
        JSR     L31E5

.L31E5
        LDY     #$06
        JSR     NOISE

        JSR     L31AC

.L31ED
        LDY     #$00
.L31EF
        JSR     DORND

        AND     #$7F
        ADC     #$03
        STA     L3227,Y
        TXA
        AND     #$1F
        CLC
        ADC     L3213,Y
        STA     L321D,Y
        INY
        CPY     #$0A
        BCC     L31EF

        LDX     #$00
        STX     L3226
        DEX
        STX     L321D
        BCS     L31AC

.L3213
        CPX     #$E0
        CPY     #$A0
        BRA     L3279

        EQUB    $40

        EQUB    $20,$00,$00

.L321D
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00

.L3226
        EQUB    $00

.L3227
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00

.MT27
        LDA     #$D9
        BNE     L3237

        LDA     #$DC
.L3237
        CLC
        ADC     GCNT
        BNE     DETOK

.DETOK3
        PHA
        TAX
        TYA
        PHA
        LDA     V
        PHA
        LDA     L003B
        PHA
        LDA     #$7C
        STA     V
        LDA     #$AF
        BNE     DTEN

.DETOK
        PHA
        TAX
        TYA
        PHA
        LDA     V
        PHA
        LDA     L003B
        PHA
        LDA     #$00
        STA     V
        LDA     #$A4
.DTEN
        STA     L003B
        LDY     #$00
.DTL1
        LDA     (V),Y
        EOR     #$57
        BNE     DT1

        DEX
        BEQ     DTL2

.DT1
        INY
        BNE     DTL1

        INC     L003B
        BNE     DTL1

.DTL2
        INY
        BNE     L3278

        INC     L003B
.L3278
        LDA     (V),Y
L3279 = L3278+1
        EOR     #$57
        BEQ     DTEX

        JSR     DETOK2

        JMP     DTL2

.DTEX
        PLA
        STA     L003B
        PLA
        STA     V
        PLA
        TAY
        PLA
        RTS

.DETOK2
        CMP     #$20
        BCC     DT3

        BIT     DTW3
        BPL     DT8

        TAX
        TYA
        PHA
        LDA     V
        PHA
        LDA     L003B
        PHA
        TXA
        JSR     TT27

        JMP     DT7

.DT8
        CMP     #$5B
        BCC     DTS

        CMP     #$81
        BCC     DT6

        CMP     #$D7
        BCC     DETOK

        SBC     #$D7
        ASL     A
        PHA
        TAX
        LDA     TKN2,X
        JSR     DTS

        PLA
        TAX
        LDA     L340A,X
.DTS
        CMP     #$41
        BCC     DT9

        BIT     DTW6
        BMI     DT10

        BIT     DTW2
        BMI     DT5

.DT10
        ORA     L3B66
.DT5
        AND     DTW8
.DT9
        JMP     DASC

.DT3
        TAX
        TYA
        PHA
        LDA     V
        PHA
        LDA     L003B
        PHA
        TXA
        ASL     A
        TAX
        LDA     L33C7,X
        STA     L32F5
        LDA     VRTS,X
        STA     L32F6
        TXA
        LSR     A
.DTM
        JSR     DASC

L32F5 = DTM+1
L32F6 = DTM+2
.DT7
        PLA
        STA     L003B
        PLA
        STA     V
        PLA
        TAY
        RTS

.DT6
        STA     SC
        TYA
        PHA
        LDA     V
        PHA
        LDA     L003B
        PHA
        JSR     DORND

        TAX
        LDA     #$00
        CPX     #$33
        ADC     #$00
        CPX     #$66
        ADC     #$00
        CPX     #$99
        ADC     #$00
        CPX     #$CC
        LDX     SC
        ADC     L49C1,X
        JSR     DETOK

        JMP     DT7

        LDA     #$00
        EQUB    $2C

.MT2
        LDA     #$20
        STA     L3B66
        LDA     #$00
        STA     DTW6
        RTS

        LDA     #$06
        JSR     DOXC

        LDA     #$FF
        STA     DTW2
        RTS

        LDA     #$01
        STA     XC
        JMP     TT66

.MT13
        LDA     #$80
        STA     DTW6
        LDA     #$20
        STA     L3B66
        RTS

        LDA     #$80
        STA     QQ17
        LDA     #$FF
        EQUB    $2C

.MT5
        LDA     #$00
        STA     DTW3
        RTS

.MT14
        LDA     #$80
        EQUB    $2C

.MT15
        LDA     #$00
        STA     DTW4
        ASL     A
        STA     DTW5
        RTS

        LDA     QQ17
        AND     #$BF
        STA     QQ17
        LDA     #$03
        JSR     TT27

        LDX     DTW5
        LDA     L1145,X
        JSR     VOWEL

        BCC     MT171

        DEC     DTW5
.MT171
        LDA     #$99
        JMP     DETOK

        JSR     MT19

        JSR     DORND

        AND     #$03
        TAY
.MT18L
        JSR     DORND

        AND     #$3E
        TAX
        LDA     L340B,X
        JSR     DTS

        LDA     L340C,X
        JSR     DTS

        DEY
        BPL     MT18L

        RTS

.MT19
        LDA     #$DF
        STA     DTW8
        RTS

.VOWEL
        ORA     #$20
        CMP     #$61
        BEQ     VRTS

        CMP     #$65
        BEQ     VRTS

        CMP     #$69
        BEQ     VRTS

        CMP     #$6F
        BEQ     VRTS

        CMP     #$75
        BEQ     VRTS

.L33C7
        CLC
.VRTS
        RTS

.L33C9
        EQUB    $29,$33,$2C,$33,$E6,$57,$E6,$57
        EQUB    $5B,$33,$54,$33,$72,$3B,$37,$33
        EQUB    $42,$33,$72,$3B,$97,$35,$72,$3B
        EQUB    $49,$33,$61,$33,$64,$33,$70,$3B
        EQUB    $6E,$33,$8C,$33,$AB,$33,$72,$3B
        EQUB    $C1,$21,$BD,$49,$D3,$49,$F8,$49
        EQUB    $B3,$49,$0A,$69,$31,$32,$35,$32
        EQUB    $D6,$49,$60,$69,$69,$69,$72,$3B

.TKN2
        EQUB    $0C

.L340A
        EQUB    $0A

.L340B
        EQUB    $41

.L340C
        EQUB    $42,$4F,$55,$53,$45,$49,$54,$49
        EQUB    $4C,$45,$54,$53,$54,$4F,$4E,$4C
        EQUB    $4F,$4E,$55,$54,$48,$4E,$4F

.QQ16
        EQUB    $41

.L3424
        EQUB    $4C,$4C,$45,$58,$45,$47,$45,$5A
        EQUB    $41,$43,$45,$42,$49,$53,$4F,$55
        EQUB    $53,$45,$53,$41,$52,$4D,$41,$49
        EQUB    $4E,$44,$49,$52,$45,$41,$3F,$45
        EQUB    $52,$41,$54,$45,$4E,$42,$45,$52
        EQUB    $41,$4C,$41,$56,$45,$54,$49,$45
        EQUB    $44,$4F,$52,$51,$55,$41,$4E,$54
        EQUB    $45,$49,$53,$52,$49,$4F,$4E

.L3463
        EQUB    $3A,$30,$2E,$45

.L3467
        EQUB    $2E

.L3468
        EQUB    $6A,$61,$6D,$65,$73,$6F,$6E

.L346F
        EQUB    $0D

.L3470
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$10,$0F,$11
        EQUB    $00,$03,$1C,$0E,$00,$00,$0A,$00
        EQUB    $11,$3A,$07,$09,$08,$00,$00,$00
        EQUB    $00,$80

.L34BA
        EQUB    $00

.L34BB
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$3A,$30,$2E
        EQUB    $45,$2E

.L34CD
        EQUB    $4A,$41,$4D,$45,$53,$4F,$4E,$0D
        EQUB    $00,$14,$AD,$4A,$5A,$48,$02,$53
        EQUB    $B7,$00,$00,$03,$E8,$46,$00,$00
        EQUB    $0F,$00,$00,$00,$00,$00,$16,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$03,$00,$10,$0F,$11
        EQUB    $00,$03,$1C,$0E,$00,$00,$0A,$00
        EQUB    $11,$3A,$07,$09,$08,$00,$00,$00
        EQUB    $00,$80,$AA,$03,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00,$00,$00,$00,$00
        EQUB    $00,$00,$00,$00

.shpcol
        EQUB    $00,$0F,$FF,$FF,$FF,$FF,$F0,$F0
        EQUB    $F0,$FF,$FF,$FF,$FF,$FF,$FF,$F0
        EQUB    $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
        EQUB    $FF,$FF,$FF,$FF,$C9,$FA,$FA,$FF
        EQUB    $FF,$FF

.scacol
        EQUB    $00,$0F,$0C,$30,$30,$30,$03,$03
        EQUB    $03,$3C,$3C,$3C,$33,$33,$33,$03
        EQUB    $3C,$3C,$3C,$3C,$3C,$3C,$3C,$30
        EQUB    $3C,$3C,$33,$3C,$3C,$3F,$3C,$3C
        EQUB    $00,$3C,$00,$00,$00,$00

.UNIV
        EQUB    $00

.L357A
        EQUB    $04,$25,$04,$4A,$04,$6F,$04,$94
        EQUB    $04,$B9,$04,$DE,$04,$03,$05,$28
        EQUB    $05,$4D,$05,$72,$05,$97,$05,$BC
        EQUB    $05

.FLKB
        RTS

.NLIN3
        JSR     TT27

.NLIN4
        LDA     #$13
        BNE     NLIN2

.NLIN
        LDA     #$17
.L359D
        INC     YC
.NLIN2
        STA     Y1
        LDA     #$0F
        STA     COL
        LDX     #$02
        STX     XX15
        LDX     #$FE
        STX     X2
        JSR     HLOIN3

        LDA     #$FF
        STA     COL
        RTS

.HLOIN2
        JSR     EDGES

        STY     Y1
        LDA     #$00
        STA     LSO,Y
        JMP     HLOIN

.BLINE
        TXA
        ADC     K4
        STA     L006A
        LDA     L0023
        ADC     T
        STA     L006B
        LDA     FLAG
        BEQ     BL1

        INC     FLAG
.BL5
        LDY     LSP
        LDA     #$FF
        CMP     L0F7D,Y
        BEQ     BL7

        STA     LSY2,Y
        INC     LSP
        BNE     BL7

.BL1
        LDA     XX18
        STA     XX15
        LDA     L0065
        STA     Y1
        LDA     L0066
        STA     X2
        LDA     L0067
        STA     Y2
        LDA     K6
        STA     L004E
        LDA     L0069
        STA     L004F
        LDA     L006A
        STA     XX12
        LDA     L006B
        STA     L0051
        JSR     LL145

        BCS     BL5

        LDA     SWAP
        BEQ     BL9

        LDA     XX15
        LDY     X2
        STA     X2
        STY     XX15
        LDA     Y1
        LDY     Y2
        STA     Y2
        STY     Y1
.BL9
        LDY     LSP
        LDA     L0F7D,Y
        CMP     #$FF
        BNE     BL8

        LDA     XX15
        STA     LSX2,Y
        LDA     Y1
        STA     LSY2,Y
        INY
.BL8
        LDA     X2
        STA     LSX2,Y
        LDA     Y2
        STA     LSY2,Y
        INY
        STY     LSP
        JSR     LL30

        LDA     L0083
        BNE     BL5

.BL7
        LDA     K6
        STA     XX18
        LDA     L0069
        STA     L0065
        LDA     L006A
        STA     L0066
        LDA     L006B
        STA     L0067
        LDA     CNT
        CLC
        ADC     STP
        STA     CNT
        RTS

.FLIP
        LDA     #$FA
        STA     COL
        LDY     NOSTM
.FLL1
        LDX     SY,Y
        LDA     SX,Y
        STA     Y1
        STA     SY,Y
        TXA
        STA     XX15
        STA     SX,Y
        LDA     SZ,Y
        STA     ZZ
        JSR     PIXEL2

        DEY
        BNE     FLL1

        RTS

.STARS
        LDA     #$FA
        STA     COL
        LDX     VIEW
        BEQ     STARS1

        DEX
        BNE     ST11

        JMP     STARS6

.ST11
        JMP     STARS2

.STARS1
        LDY     NOSTM
.STL1
        JSR     DV42

        LDA     R
        LSR     P
        ROR     A
        LSR     P
        ROR     A
        ORA     #$01
        STA     Q
        LDA     SZL,Y
        SBC     DELT4
        STA     SZL,Y
        LDA     SZ,Y
        STA     ZZ
        SBC     L0077
        STA     SZ,Y
        JSR     MLU1

        STA     L003F
        LDA     P
        ADC     SYL,Y
        STA     YY
        STA     R
        LDA     Y1
        ADC     L003F
        STA     L003F
        STA     S
        LDA     SX,Y
        STA     XX15
        JSR     MLU2

        STA     L003D
        LDA     P
        ADC     SXL,Y
        STA     XX
        LDA     XX15
        ADC     L003D
        STA     L003D
        EOR     L0049
        JSR     MLS1

        JSR     ADD

        STA     L003F
        STX     YY
        EOR     ALP2
        JSR     MLS2

        JSR     ADD

        STA     L003D
        STX     XX
        LDX     BET1
        LDA     L003F
        EOR     L0074
        JSR     L44EA

        STA     Q
        JSR     MUT2

        ASL     P
        ROL     A
        STA     T
        LDA     #$00
        ROR     A
        ORA     T
        JSR     ADD

        STA     L003D
        TXA
        STA     SXL,Y
        LDA     YY
        STA     R
        LDA     L003F
        STA     S
        LDA     #$00
        STA     P
        LDA     BETA
        EOR     #$80
        JSR     PIX1

        LDA     L003D
        STA     XX15
        STA     SX,Y
        AND     #$7F
        CMP     #$78
        BCS     KILL1

        LDA     L003F
        STA     SY,Y
        STA     Y1
        AND     #$7F
        CMP     #$78
        BCS     KILL1

        LDA     SZ,Y
        CMP     #$10
        BCC     KILL1

        STA     ZZ
.STC1
        JSR     PIXEL2

        DEY
        BEQ     L375A

        JMP     STL1

.L375A
        RTS

.KILL1
        JSR     DORND

        ORA     #$04
        STA     Y1
        STA     SY,Y
        JSR     DORND

        ORA     #$08
        STA     XX15
        STA     SX,Y
        JSR     DORND

        ORA     #$90
        STA     SZ,Y
        STA     ZZ
        LDA     Y1
        JMP     STC1

.STARS6
        LDY     NOSTM
.STL6
        JSR     DV42

        LDA     R
        LSR     P
        ROR     A
        LSR     P
        ROR     A
        ORA     #$01
        STA     Q
        LDA     SX,Y
        STA     XX15
        JSR     MLU2

        STA     L003D
        LDA     SXL,Y
        SBC     P
        STA     XX
        LDA     XX15
        SBC     L003D
        STA     L003D
        JSR     MLU1

        STA     L003F
        LDA     SYL,Y
        SBC     P
        STA     YY
        STA     R
        LDA     Y1
        SBC     L003F
        STA     L003F
        STA     S
        LDA     SZL,Y
        ADC     DELT4
        STA     SZL,Y
        LDA     SZ,Y
        STA     ZZ
        ADC     L0077
        STA     SZ,Y
        LDA     L003D
        EOR     ALP2
        JSR     MLS1

        JSR     ADD

        STA     L003F
        STX     YY
        EOR     L0049
        JSR     MLS2

        JSR     ADD

        STA     L003D
        STX     XX
        LDA     L003F
        EOR     L0074
        LDX     BET1
        JSR     L44EA

        STA     Q
        LDA     L003D
        STA     S
        EOR     #$80
        JSR     MUT1

        ASL     P
        ROL     A
        STA     T
        LDA     #$00
        ROR     A
        ORA     T
        JSR     ADD

        STA     L003D
        TXA
        STA     SXL,Y
        LDA     YY
        STA     R
        LDA     L003F
        STA     S
        LDA     #$00
        STA     P
        LDA     BETA
        JSR     PIX1

        LDA     L003D
        STA     XX15
        STA     SX,Y
        LDA     L003F
        STA     SY,Y
        STA     Y1
        AND     #$7F
        CMP     #$6E
        BCS     KILL6

        LDA     SZ,Y
        CMP     #$A0
        BCS     KILL6

        STA     ZZ
.STC6
        JSR     PIXEL2

        DEY
        BEQ     ST3_UC

        JMP     STL6

.ST3_UC
        RTS

.KILL6
        JSR     DORND

        AND     #$7F
        ADC     #$0A
        STA     SZ,Y
        STA     ZZ
        LSR     A
        BCS     ST4_UC

        LSR     A
        LDA     #$FC
        ROR     A
        STA     XX15
        STA     SX,Y
        JSR     DORND

        STA     Y1
        STA     SY,Y
        JMP     STC6

.ST4_UC
        JSR     DORND

        STA     XX15
        STA     SX,Y
        LSR     A
        LDA     #$E6
        ROR     A
        STA     Y1
        STA     SY,Y
        BNE     STC6

.MAS1
        LDA     INWK,Y
        ASL     A
        STA     L0057
        LDA     L009D,Y
        ROL     A
        STA     L0058
        LDA     #$00
        ROR     A
        STA     L0059
        JSR     MVT3

        STA     L009E,X
        LDY     L0057
        STY     INWK,X
        LDY     L0058
        STY     L009D,X
        AND     #$7F
        RTS

.m
        LDA     #$00
.MAS2
        ORA     L0402,Y
        ORA     L0405,Y
        ORA     L0408,Y
        AND     #$7F
        RTS

.MAS3
        LDA     L0401,Y
        JSR     SQUA2

        STA     R
        LDA     L0404,Y
        JSR     SQUA2

        ADC     R
        BCS     MA30

        STA     R
        LDA     L0407,Y
        JSR     SQUA2

        ADC     R
        BCC     L38CC

.MA30
        LDA     #$FF
.L38CC
        RTS

.wearedocked
        LDA     #$CD
        JSR     DETOK

        JSR     TT67

        JMP     L3915

.st4
        LDX     #$09
        CMP     #$19
        BCS     st3

        DEX
        CMP     #$0A
        BCS     st3

        DEX
        CMP     #$02
        BCS     st3

        DEX
        BNE     st3

.STATUS
        LDA     #$08
        JSR     TRADEMODE

        JSR     TT111

        LDA     #$07
        STA     XC
        LDA     #$7E
        JSR     NLIN3

        LDA     #$0F
        LDY     QQ12
        BNE     wearedocked

        LDA     #$E6
        LDY     JUNK
        LDX     L0E43,Y
        BEQ     st6

        LDY     ENERGY
        CPY     #$80
        ADC     #$01
.st6
        JSR     plf

.L3915
        LDA     #$7D
        JSR     spc

        LDA     #$13
        LDY     FIST
        BEQ     st5

        CPY     #$32
        ADC     #$01
.st5
        JSR     plf

        LDA     #$10
        JSR     spc

        LDA     L127C
        BNE     st4

        TAX
        LDA     TALLY
        LSR     A
        LSR     A
.L3938
        INX
        LSR     A
        BNE     L3938

.st3
        TXA
        CLC
        ADC     #$15
        JSR     plf

        LDA     #$12
        JSR     plf2

        LDA     ESCP
        BEQ     L3952

        LDA     #$70
        JSR     plf2

.L3952
        LDA     BST
        BEQ     L395C

        LDA     #$6F
        JSR     plf2

.L395C
        LDA     ECM
        BEQ     L3966

        LDA     #$6C
        JSR     plf2

.L3966
        LDA     #$71
        STA     XX4
.stqv
        TAY
        LDX     L11ED,Y
        BEQ     L3973

        JSR     plf2

.L3973
        INC     XX4
        LDA     XX4
        CMP     #$75
        BCC     stqv

        LDX     #$00
.st
        STX     CNT
        LDY     LASER,X
        BEQ     st1

        TXA
        CLC
        ADC     #$60
        JSR     spc

        LDA     #$67
        LDX     CNT
        LDY     LASER,X
        CPY     #$8F
        BNE     L3998

        LDA     #$68
.L3998
        CPY     #$97
        BNE     L399E

        LDA     #$75
.L399E
        CPY     #$32
        BNE     L39A4

        LDA     #$76
.L39A4
        JSR     plf2

.st1
        LDX     CNT
        INX
        CPX     #$04
        BCC     st

        RTS

.plf2
        JSR     plf

        LDA     #$06
        STA     XC
        RTS

.MVT3
        LDA     L0059
        STA     S
        AND     #$80
        STA     T
        EOR     L009E,X
        BMI     MV13

        LDA     L0057
        CLC
        ADC     INWK,X
        STA     L0057
        LDA     L0058
        ADC     L009D,X
        STA     L0058
        LDA     L0059
        ADC     L009E,X
        AND     #$7F
        ORA     T
        STA     L0059
        RTS

.MV13
        LDA     S
        AND     #$7F
        STA     S
        LDA     INWK,X
        SEC
        SBC     L0057
        STA     L0057
        LDA     L009D,X
        SBC     L0058
        STA     L0058
        LDA     L009E,X
        AND     #$7F
        SBC     S
        ORA     #$80
        EOR     T
        STA     L0059
        BCS     MV14

        LDA     #$01
        SBC     L0057
        STA     L0057
        LDA     #$00
        SBC     L0058
        STA     L0058
        LDA     #$00
        SBC     L0059
        AND     #$7F
        ORA     T
        STA     L0059
.MV14
        RTS

.MVS5
        LDA     L009D,X
        AND     #$7F
        LSR     A
        STA     T
        LDA     INWK,X
        SEC
        SBC     T
        STA     R
        LDA     L009D,X
        SBC     #$00
        STA     S
        LDA     INWK,Y
        STA     P
        LDA     L009D,Y
        AND     #$80
        STA     T
        LDA     L009D,Y
        AND     #$7F
        LSR     A
        ROR     P
        LSR     A
        ROR     P
        LSR     A
        ROR     P
        LSR     A
        ROR     P
        ORA     T
        EOR     RAT2
        STX     Q
        JSR     ADD

        STA     L0057
        STX     K
        LDX     Q
        LDA     L009D,Y
        AND     #$7F
        LSR     A
        STA     T
        LDA     INWK,Y
        SEC
        SBC     T
        STA     R
        LDA     L009D,Y
        SBC     #$00
        STA     S
        LDA     INWK,X
        STA     P
        LDA     L009D,X
        AND     #$80
        STA     T
        LDA     L009D,X
        AND     #$7F
        LSR     A
        ROR     P
        LSR     A
        ROR     P
        LSR     A
        ROR     P
        LSR     A
        ROR     P
        ORA     T
        EOR     #$80
        EOR     RAT2
        STX     Q
        JSR     ADD

        STA     L009D,Y
        STX     INWK,Y
        LDX     Q
        LDA     K
        STA     INWK,X
        LDA     L0057
        STA     L009D,X
        RTS

.L3A9F
        EQUB    $48,$76,$E8,$00

.pr2
        LDA     #$03
.L3AA5
        LDY     #$00
.TT11
        STA     U
        LDA     #$00
        STA     K
        STA     L0057
        STY     L0058
        STX     L0059
.BPRNT
        LDX     #$0B
        STX     T
        PHP
        BCC     TT30

        DEC     T
        DEC     U
.TT30
        LDA     #$0B
        SEC
        STA     XX17
        SBC     U
        STA     U
        INC     U
        LDY     #$00
        STY     S
        JMP     TT36

.TT35
        ASL     L0059
        ROL     L0058
        ROL     L0057
        ROL     K
        ROL     S
        LDX     #$03
.tt35_lc
        LDA     K,X
        STA     XX15,X
        DEX
        BPL     tt35_lc

        LDA     S
        STA     L004E
        ASL     L0059
        ROL     L0058
        ROL     L0057
        ROL     K
        ROL     S
        ASL     L0059
        ROL     L0058
        ROL     L0057
        ROL     K
        ROL     S
        CLC
        LDX     #$03
.tt36_lc
        LDA     K,X
        ADC     XX15,X
        STA     K,X
        DEX
        BPL     tt36_lc

        LDA     L004E
        ADC     S
        STA     S
        LDY     #$00
.TT36
        LDX     #$03
        SEC
.tt37_lc
        LDA     K,X
        SBC     L3A9F,X
        STA     XX15,X
        DEX
        BPL     tt37_lc

        LDA     S
        SBC     #$17
        STA     L004E
        BCC     TT37

        LDX     #$03
.tt38_lc
        LDA     XX15,X
        STA     K,X
        DEX
        BPL     tt38_lc

        LDA     L004E
        STA     S
        INY
        JMP     TT36

.TT37
        TYA
        BNE     TT32

        LDA     T
        BEQ     TT32

        DEC     U
        BPL     TT34

        LDA     #$20
        BNE     tt34_lc

.TT32
        LDY     #$00
        STY     T
        CLC
        ADC     #$30
.tt34_lc
        JSR     DASC

.TT34
        DEC     T
        BPL     L3B54

        INC     T
.L3B54
        DEC     XX17
        BMI     rT10

        BNE     L3B62

        PLP
        BCC     L3B62

        LDA     #$2E
        JSR     DASC

.L3B62
        JMP     TT35

.rT10
        RTS

.L3B66
        EQUB    $20

.DTW2
        EQUB    $FF

.DTW3
        EQUB    $00

.DTW4
        EQUB    $00

.DTW5
        EQUB    $00

.DTW6
        EQUB    $00

.DTW8
        EQUB    $FF

.FEED
        LDA     #$0C
        EQUB    $2C

.MT16
        LDA     #$41
L3B71 = MT16+1
.DASC
        STX     SC
        LDX     #$FF
        STX     DTW8
        CMP     #$2E
        BEQ     DA8

        CMP     #$3A
        BEQ     DA8

        CMP     #$0A
        BEQ     DA8

        CMP     #$0C
        BEQ     DA8

        CMP     #$20
        BEQ     DA8

        INX
.DA8
        STX     DTW2
        LDX     SC
        BIT     DTW4
        BMI     L3B9B

        JMP     TT26

.L3B9B
        BIT     DTW4
        BVS     L3BA4

        CMP     #$0C
        BEQ     DA1

.L3BA4
        LDX     DTW5
        STA     BUF,X
        LDX     SC
        INC     DTW5
        CLC
        RTS

.DA1
        TXA
        PHA
        TYA
        PHA
.DA5
        LDX     DTW5
        BEQ     L3C32

        CPX     #$1F
        BCC     DA6

        LSR     L000B
.DA11
        LDA     L000B
        BMI     L3BC8

        LDA     #$40
        STA     L000B
.L3BC8
        LDY     #$1D
.DAL1
        LDA     L1164
        CMP     #$20
        BEQ     DA2

.DAL2
        DEY
        BMI     DA11

        BEQ     DA11

        LDA     BUF,Y
        CMP     #$20
        BNE     DAL2

        ASL     L000B
        BMI     DAL2

        STY     SC
        LDY     DTW5
.DAL6
        LDA     BUF,Y
        STA     L1147,Y
        DEY
        CPY     SC
        BCS     DAL6

        INC     DTW5
.DAL3
        CMP     BUF,Y
        BNE     DAL1

        DEY
        BPL     DAL3

        BMI     DA11

.DA2
        LDX     #$1E
        JSR     DAS1

        LDA     #$0C
        JSR     TT26

        LDA     DTW5
        SBC     #$1E
        STA     DTW5
        TAX
        BEQ     L3C32

        LDY     #$00
        INX
.DAL4
        LDA     L1165,Y
        STA     BUF,Y
        INY
        DEX
        BNE     DAL4

        BEQ     DA5

.DAS1
        LDY     #$00
.DAL5
        LDA     BUF,Y
        JSR     TT26

        INY
        DEX
        BNE     DAL5

        RTS

.DA6
        JSR     DAS1

.L3C32
        STX     DTW5
        PLA
        TAY
        PLA
        TAX
        LDA     #$0C
.L3C3B
        EQUB    $2C

.BELL
        LDA     #$07
        JMP     TT26

.ESCAPE
        JSR     RES2

        LDX     #$0B
        STX     TYPE
        JSR     FRS1

        BCS     ES1

        LDX     #$18
        JSR     FRS1

.ES1
        LDA     #$08
        STA     L00B7
        LDA     #$C2
        STA     L00BA
        LSR     A
        STA     L00BC
.ESL1
        JSR     MVEIT

        LDA     QQ11
        ORA     VIEW
        BNE     L3C6A

        JSR     LL9

.L3C6A
        DEC     L00BC
        BNE     ESL1

        JSR     SCAN

        LDA     #$00
        LDX     #$10
.ESL2
        STA     QQ20,X
        DEX
        BPL     ESL2

        STA     FIST
        STA     ESCP
        LDA     #$46
        STA     QQ14
        JMP     GOIN

.HME2
        LDA     #$FF
        STA     COL
        LDA     #$0E
        JSR     DETOK

        JSR     TT103

        JSR     TT81

        LDA     #$00
        STA     XX20
.HME3
        JSR     MT14

        JSR     cpl

        LDX     DTW5
        LDA     L00A1,X
        CMP     #$0D
        BNE     HME6

.HME4
        DEX
        LDA     L00A1,X
        ORA     #$20
        CMP     BUF,X
        BEQ     HME4

        TXA
        BMI     HME5

.HME6
        JSR     TT20

        INC     XX20
        BNE     HME3

        JSR     TT111

        JSR     TT103

        JSR     BEEP_LONG_LOW

        LDA     #$D7
        JMP     DETOK

.HME5
        LDA     L0061
        STA     QQ9
        LDA     L005F
        STA     QQ10
        JSR     TT111

        JSR     TT103

        JSR     MT15

        JMP     T95

.L3CE1
        EQUB    $0B

        EQUB    $44,$3B,$00,$82,$B0,$00,$00,$00
        EQUB    $05,$50,$11,$05,$D1,$28,$05,$40
        EQUB    $06,$10,$60,$90,$13,$10,$D1,$00
        EQUB    $00,$00,$14,$51,$F8,$10,$60,$75
        EQUB    $00,$00,$00

.HALL
        LDA     #$00
        JSR     DOVDU19

        LDA     #$00
        JSR     TT66

        JSR     DORND

        BPL     HA7

        AND     #$03
        STA     T
        ASL     A
        ASL     A
        ASL     A
        ADC     T
        TAX
        LDY     #$03
        STY     CNT2
.HAL8
        LDY     #$02
.HAL9
        LDA     L3CE1,X
        STA     XX15,Y
        INX
        DEY
        BPL     HAL9

        TXA
        PHA
        JSR     HAS1

        PLA
        TAX
        DEC     CNT2
        BNE     HAL8

        LDY     #$80
        BNE     HA9

.HA7
        LSR     A
        STA     Y1
        JSR     DORND

        STA     XX15
        JSR     DORND

        AND     #$03
        ADC     #$11
        STA     X2
        JSR     HAS1

        LDY     #$00
.HA9
        STY     L1F85
        JMP     HANGER

.HAS1
        JSR     ZINF

        LDA     XX15
        STA     L00A2
        LSR     A
        ROR     L009E
        LDA     Y1
        STA     INWK
        LSR     A
        LDA     #$01
        ADC     #$00
        STA     L00A3
        LDA     #$80
        STA     L00A1
        STA     RAT2
        LDA     #$0B
        STA     L00BE
        JSR     DORND

        STA     XSAV
.HAL5
        LDX     #$15
        LDY     #$09
        JSR     MVS5

        LDX     #$17
        LDY     #$0B
        JSR     MVS5

        LDX     #$19
        LDY     #$0D
        JSR     MVS5

        DEC     XSAV
        BNE     HAL5

        LDY     X2
        BEQ     HA1

        TYA
        ASL     A
        TAX
        LDA     L7FFE,X
        STA     XX0
        LDA     L7FFF,X
        STA     L0037
        BEQ     HA1

        LDY     #$01
        LDA     (XX0),Y
        STA     Q
        INY
        LDA     (XX0),Y
        STA     R
        JSR     LL5

        LDA     #$64
        SBC     Q
        LSR     A
        STA     L009F
        JSR     TIDY

        JMP     LL9

.HA1
        RTS

.TA35_COPY
        LDA     INWK
        ORA     L009F
        ORA     L00A2
        BNE     TA87_COPY

        LDA     #$50
        JSR     OOPS

.TA87_COPY
        LDX     #$04
        BNE     L3E37

.TA34
        LDA     #$00
        JSR     MAS4

        BEQ     L3DE0

        JMP     TN4

.L3DE0
        JSR     L3E3A

        JSR     EXNO3

        LDA     #$FA
        JMP     OOPS

.TA18
        LDA     ECMA
        BNE     TA35_COPY

        LDA     L00BC
        ASL     A
        BMI     TA34

        LSR     A
        TAX
        LDA     UNIV,X
        STA     V
        LDA     L357A,X
        JSR     VCSUB

        LDA     L0016
        ORA     L0019
        ORA     L001C
        AND     #$7F
        ORA     L0015
        ORA     L0018
        ORA     L001B
        BNE     TA64

        LDA     L00BC
        CMP     #$82
        BEQ     TA35_COPY

        LDY     #$1F
        LDA     (V),Y
        BIT     L3E48
        BNE     TA35

        ORA     #$80
        STA     (V),Y
.TA35
        LDA     INWK
        ORA     L009F
        ORA     L00A2
        BNE     TA87

        LDA     #$50
        JSR     OOPS

.TA87
        LDA     L00BC
        AND     #$7F
        LSR     A
        TAX
.L3E37
        JSR     EXNO2

.L3E3A
        ASL     L00BB
        SEC
        ROR     L00BB
.TA1
        RTS

.TA64
        JSR     DORND

        CMP     #$10
        BCS     TA19S

.M32
        LDY     #$20
L3E48 = M32+1
        LDA     (V),Y
        LSR     A
        BCS     L3E51

.TA19S
        JMP     TA19

.L3E51
        JMP     ECBLB2

.TACTICS
        LDA     #$03
        STA     RAT
        LDA     #$04
        STA     RAT2
        LDA     #$16
        STA     CNT2
        CPX     #$01
        BEQ     TA18

        CPX     #$02
        BNE     TA13

        LDA     NEWB
        AND     #$04
        BNE     TN5

        LDA     L0E58
        BNE     TA1

        JSR     DORND

        CMP     #$FD
        BCC     TA1

        AND     #$01
        ADC     #$08
        TAX
        BNE     TN6

.TN5
        JSR     DORND

        CMP     #$F0
        BCC     TA1

        LDA     L0E5E
        CMP     #$06
        BCS     TA22

        LDX     #$10
.TN6
        LDA     #$F1
        JMP     SFS1

.TA13
        CPX     #$0F
        BNE     TA17

        JSR     DORND

        CMP     #$C8
        BCC     TA22

        LDX     #$00
        STX     L00BC
        LDX     #$24
        STX     NEWB
        AND     #$03
        ADC     #$11
        TAX
        JSR     TN6

        LDA     #$00
        STA     L00BC
        RTS

.TA17
        LDY     #$0E
        LDA     L00BF
        CMP     (XX0),Y
        BCS     TA21

        INC     L00BF
.TA21
        CPX     #$1E
        BNE     TA14

        LDA     L0E6B
        BNE     TA14

        LSR     L00BC
        ASL     L00BC
        LSR     L00B7
.TA22
        RTS

.TA14
        JSR     DORND

        LDA     NEWB
        LSR     A
        BCC     TN1

        CPX     #$32
        BCS     TA22

.TN1
        LSR     A
        BCC     TN2

        LDX     FIST
        CPX     #$28
        BCC     TN2

        LDA     NEWB
        ORA     #$04
        STA     NEWB
        LSR     A
        LSR     A
.TN2
        LSR     A
        BCS     TN3

        LSR     A
        LSR     A
        BCC     GOPL

        JMP     DOCKIT

.GOPL
        JSR     SPS1

        JMP     TA151

.TN3
        LSR     A
        BCC     TN4

        LDA     SSPR
        BEQ     TN4

        LDA     L00BC
        AND     #$81
        STA     L00BC
.TN4
        LDX     #$08
.TAL1
        LDA     INWK,X
        STA     K3,X
        DEX
        BPL     TAL1

.TA19
        JSR     TAS2

        LDY     #$0A
        JSR     TAS3

        STA     CNT
        LDA     TYPE
        CMP     #$01
        BNE     L3F28

        JMP     TA20

.L3F28
        CMP     #$0E
        BNE     TN7

        JSR     DORND

        CMP     #$C8
        BCC     TN7

        JSR     DORND

        LDX     #$17
        CMP     #$64
        BCS     L3F3E

        LDX     #$11
.L3F3E
        JMP     TN6

.TN7
        JSR     DORND

        CMP     #$FA
        BCC     TA7

        JSR     DORND

        ORA     #$68
        STA     L00B9
.TA7
        LDY     #$0E
        LDA     (XX0),Y
        LSR     A
        CMP     L00BF
        BCC     TA3

        LSR     A
        LSR     A
        CMP     L00BF
        BCC     ta3_lc

        JSR     DORND

        CMP     #$E6
        BCC     ta3_lc

        LDX     TYPE
        LDA     L8041,X
        BPL     ta3_lc

        LDA     NEWB
        AND     #$F0
        STA     NEWB
        LDY     #$24
        STA     (INF),Y
        LDA     #$00
        STA     L00BC
        JMP     SESCP

.ta3_lc
        LDA     L00BB
        AND     #$07
        BEQ     TA3

        STA     T
        JSR     DORND

        AND     #$1F
        CMP     T
        BCS     TA3

        LDA     ECMA
        BNE     TA3

        DEC     L00BB
        LDA     TYPE
        CMP     #$1D
        BNE     TA16

        LDX     #$1E
        LDA     L00BC
        JMP     SFS1

.TA16
        JMP     SFRMIS

.TA3
        LDA     #$00
        JSR     MAS4

        AND     #$E0
        BNE     TA4

        LDX     CNT
        CPX     #$A0
        BCC     TA4

        LDY     #$13
        LDA     (XX0),Y
        AND     #$F8
        BEQ     TA4

        LDA     L00BB
        ORA     #$40
        STA     L00BB
        CPX     #$A3
        BCC     TA4

        LDA     (XX0),Y
        LSR     A
        JSR     OOPS

        DEC     L00B8
        LDA     ECMA
        BNE     L4039

        JSR     BEING_HIT_NOISE

.TA4
        LDA     L00A3
        CMP     #$03
        BCS     TA5

        LDA     L009D
        ORA     L00A0
        AND     #$FE
        BEQ     TA15

.TA5
        JSR     DORND

        ORA     #$80
        CMP     L00BC
        BCS     TA15

.TA20
        JSR     TAS6

        LDA     CNT
        EOR     #$80
.TA152
        STA     CNT
.TA15
        LDY     #$10
        JSR     TAS3

        TAX
        EOR     #$80
        AND     #$80
        STA     L00BA
.L4000
        TXA
        ASL     A
        CMP     RAT2
        BCC     TA11

        LDA     RAT
        ORA     L00BA
        STA     L00BA
.TA11
        LDA     L00B9
        ASL     A
        CMP     #$20
        BCS     TA12

        LDY     #$16
        JSR     TAS3

        TAX
        EOR     L00BA
        AND     #$80
        EOR     #$80
        STA     L00B9
        TXA
        ASL     A
        CMP     RAT2
        BCC     TA12

        LDA     RAT
        ORA     L00B9
        STA     L00B9
.TA12
        LDA     CNT
        BMI     TA9

        CMP     CNT2
        BCC     TA9

        LDA     #$03
        STA     L00B8
.L4039
        RTS

.TA9
        AND     #$7F
        CMP     #$12
        BCC     TA10

        LDA     #$FF
        LDX     TYPE
        CPX     #$01
        BNE     L4049

        ASL     A
.L4049
        STA     L00B8
.TA10
        RTS

.TA151
        LDY     #$0A
        JSR     TAS3

        CMP     #$98
        BCC     ttt

        LDX     #$00
        STX     RAT2
.ttt
        JMP     TA152

.DOCKIT
        LDA     #$06
        STA     RAT2
        LSR     A
        STA     RAT
        LDA     #$1D
        STA     CNT2
        LDA     SSPR
        BNE     L406F

.GOPLS
        JMP     GOPL

.L406F
        JSR     VCSU1

        LDA     L0016
        ORA     L0019
        ORA     L001C
        AND     #$7F
        BNE     GOPLS

        JSR     TA2

        LDA     Q
        STA     K
        JSR     TAS2

        LDY     #$0A
        JSR     TAS4

        BMI     PH1

        CMP     #$23
        BCC     PH1

        LDY     #$0A
        JSR     TAS3

        CMP     #$A2
        BCS     PH3

        LDA     K
        CMP     #$9D
        BCC     PH2

        LDA     TYPE
        BMI     PH3

.PH2
        JSR     TAS6

        JSR     TA151

.PH22
        LDX     #$00
        STX     L00B8
        INX
        STX     L00B7
        RTS

.PH1
        JSR     VCSU1

        JSR     DCS1

        JSR     DCS1

        JSR     TAS2

        JSR     TAS6

        JMP     TA151

.TN11
        INC     L00B8
        LDA     #$7F
        STA     L00B9
        BNE     TN13

.PH3
        LDX     #$00
        STX     RAT2
        STX     L00BA
        LDA     TYPE
        BPL     PH32

        EOR     XX15
        EOR     Y1
        ASL     A
        LDA     #$02
        ROR     A
        STA     L00B9
        LDA     XX15
        ASL     A
        CMP     #$0C
        BCS     PH22

        LDA     Y1
        ASL     A
        LDA     #$02
        ROR     A
        STA     L00BA
        LDA     Y1
        ASL     A
        CMP     #$0C
        BCS     PH22

.PH32
        STX     L00B9
        LDA     L00B2
        STA     XX15
        LDA     L00B4
        STA     Y1
        LDA     L00B6
        STA     X2
        LDY     #$10
        JSR     TAS4

        ASL     A
        CMP     #$42
        BCS     TN11

        JSR     PH22

.TN13
        LDA     L001E
        BNE     TNRTS

        ASL     NEWB
        SEC
        ROR     NEWB
.TNRTS
        RTS

.VCSU1
        LDA     #$25
        STA     V
        LDA     #$04
.VCSUB
        STA     L003B
        LDY     #$02
        JSR     TAS1

        LDY     #$05
        JSR     TAS1

        LDY     #$08
.TAS1
        LDA     (V),Y
        EOR     #$80
        STA     L0059
        DEY
        LDA     (V),Y
        STA     L0058
        DEY
        LDA     (V),Y
        STA     L0057
        STY     U
        LDX     U
        JSR     MVT3

        LDY     U
        STA     L0016,X
        LDA     L0058
        STA     L0015,X
        LDA     L0057
        STA     K3,X
        RTS

.TAS4
        LDX     L0425,Y
        STX     Q
        LDA     XX15
        JSR     MULT12

        LDX     L0427,Y
        STX     Q
        LDA     Y1
        JSR     MAD

        STA     S
        STX     R
        LDX     L0429,Y
        STX     Q
        LDA     X2
        JMP     MAD

.TAS6
        LDA     XX15
        EOR     #$80
        STA     XX15
        LDA     Y1
        EOR     #$80
        STA     Y1
        LDA     X2
        EOR     #$80
        STA     X2
        RTS

.DCS1
        JSR     L418B

.L418B
        LDA     L042F
        LDX     #$00
        JSR     TAS7

        LDA     L0431
        LDX     #$03
        JSR     TAS7

        LDA     L0433
        LDX     #$06
.TAS7
        ASL     A
        STA     R
        LDA     #$00
        ROR     A
        EOR     #$80
        EOR     L0016,X
        BMI     TS71

        LDA     R
        ADC     K3,X
        STA     K3,X
        BCC     TS72

        INC     L0015,X
.TS72
        RTS

.TS71
        LDA     K3,X
        SEC
        SBC     R
        STA     K3,X
        LDA     L0015,X
        SBC     #$00
        STA     L0015,X
        BCS     TS72

        LDA     K3,X
        EOR     #$FF
        ADC     #$01
        STA     K3,X
        LDA     L0015,X
        EOR     #$FF
        ADC     #$00
        STA     L0015,X
        LDA     L0016,X
        EOR     #$80
        STA     L0016,X
        JMP     TS72

.HITCH
        CLC
        LDA     L00A4
        BNE     HI1

        LDA     TYPE
        BMI     HI1

        LDA     L00BB
        AND     #$20
        ORA     L009D
        ORA     L00A0
        BNE     HI1

        LDA     INWK
        JSR     SQUA2

.L41F7
        STA     S
L41F8 = L41F7+1
        LDA     P
        STA     R
        LDA     L009F
        JSR     SQUA2

        TAX
        LDA     P
        ADC     R
        STA     R
        TXA
        ADC     S
        BCS     TN10

        STA     S
        LDY     #$02
        LDA     (XX0),Y
        CMP     S
        BNE     HI1

        DEY
        LDA     (XX0),Y
        CMP     R
.HI1
        RTS

.TN10
        CLC
        RTS

.FRS1
        JSR     ZINF

        LDA     #$1C
        STA     L009F
        LSR     A
        STA     L00A2
        LDA     #$80
        STA     L00A1
        LDA     MSTG
        ASL     A
        ORA     #$80
        STA     L00BC
.fq1
        LDA     #$60
        STA     L00AA
        ORA     #$80
        STA     L00B2
        LDA     DELTA
        ROL     A
        STA     L00B7
        TXA
        JMP     NWSHP

.FRMIS
        LDX     #$01
        JSR     FRS1

        BCC     FR1

        LDX     MSTG
        JSR     GINF

        LDA     FRIN,X
        JSR     ANGRY

        LDY     #$00
        JSR     ABORT

        DEC     NOMSL
        LDY     #$08
        JSR     NOISE

.ANGRY
        CMP     #$02
        BEQ     AN2

        LDY     #$24
        LDA     (INF),Y
        AND     #$20
        BEQ     L4274

        JSR     AN2

.L4274
        LDY     #$20
        LDA     (INF),Y
        BEQ     HI1

        ORA     #$80
        STA     (INF),Y
        LDY     #$1C
        LDA     #$02
        STA     (INF),Y
        ASL     A
        LDY     #$1E
        STA     (INF),Y
        LDA     TYPE
        CMP     #$0B
        BCC     AN3

        LDY     #$24
        LDA     (INF),Y
        ORA     #$04
        STA     (INF),Y
.AN3
        RTS

.AN2
        LDA     L0449
        ORA     #$04
        STA     L0449
        RTS

.FR1
        LDA     #$C9
        JMP     MESS

.SESCP
        LDX     #$03
.L42A8
        LDA     #$FE
.SFS1
        STA     T1
        TXA
        PHA
        LDA     XX0
        PHA
        LDA     L0037
        PHA
        LDA     INF
        PHA
        LDA     L0039
        PHA
        LDY     #$24
.FRL2
        LDA     INWK,Y
        STA     XX3,Y
        LDA     (INF),Y
        STA     INWK,Y
        DEY
        BPL     FRL2

        LDA     TYPE
        CMP     #$02
        BNE     rx

        TXA
        PHA
        LDA     #$20
        STA     L00B7
        LDX     #$00
        LDA     L00A6
        JSR     SFS2

        LDX     #$03
        LDA     L00A8
        JSR     SFS2

        LDX     #$06
        LDA     L00AA
        JSR     SFS2

        PLA
        TAX
.rx
        LDA     T1
        STA     L00BC
        LSR     L00B9
        ASL     L00B9
        TXA
        CMP     #$09
        BCS     NOIL

        CMP     #$04
        BCC     NOIL

        PHA
        JSR     DORND

        ASL     A
        STA     L00BA
        TXA
        AND     #$0F
        STA     L00B7
        LDA     #$FF
        ROR     A
        STA     L00B9
        PLA
.NOIL
        JSR     NWSHP

        PLA
        STA     L0039
        PLA
        STA     INF
        LDX     #$24
.FRL3
        LDA     XX3,X
        STA     INWK,X
        DEX
        BPL     FRL3

        PLA
        STA     L0037
        PLA
        STA     XX0
        PLA
        TAX
        RTS

.SFS2
        ASL     A
        STA     R
        LDA     #$00
        ROR     A
        JMP     MVT1

.LL164
        LDY     #$0A
        JSR     NOISE

        LDY     #$0B
        JSR     NOISE

        LDA     #$04
        STA     HFX
        JSR     HFS2

        STZ     HFX
        RTS

.LAUN
        LDY     #$08
        JSR     NOISE

        LDA     #$08
.HFS2
        STA     STP
        LDA     QQ11
        PHA
        LDA     #$00
        JSR     TT66

        PLA
        STA     QQ11
.HFS1
        LDX     #$80
        STX     K3
        LDX     #$60
        STX     K4
        LDX     #$00
        STX     XX4
        STX     L0015
        STX     L0023
.HFL5
        JSR     HFL1

        INC     XX4
        LDX     XX4
        CPX     #$08
        BNE     HFL5

        RTS

.HFL1
        LDA     XX4
        AND     #$07
        CLC
        ADC     #$08
        STA     K
.HFL2
        LDA     #$01
        STA     LSP
        JSR     CIRCLE2

        ASL     K
        BCS     HF8

        LDA     K
        CMP     #$A0
        BCC     HFL2

.HF8
        RTS

.STARS2
        LDA     #$00
        CPX     #$02
        ROR     A
        STA     RAT
        EOR     #$80
        STA     RAT2
        JSR     ST2

        LDY     NOSTM
.STL2
        LDA     SZ,Y
        STA     ZZ
        LSR     A
        LSR     A
        LSR     A
        JSR     DV41

        LDA     P
        STA     L009B
        EOR     RAT2
        STA     S
        LDA     SXL,Y
        STA     P
        LDA     SX,Y
        STA     XX15
        JSR     ADD

        STA     S
        STX     R
        LDA     SY,Y
        STA     Y1
        EOR     BET2
        LDX     BET1
        JSR     L44EA

        JSR     ADD

        STX     XX
        STA     L003D
        LDX     SYL,Y
        STX     R
        LDX     Y1
        STX     S
        LDX     BET1
        EOR     L0074
        JSR     L44EA

        JSR     ADD

        STX     YY
        STA     L003F
        LDX     ALP1
        EOR     ALP2
        JSR     L44EA

        STA     Q
        LDA     XX
        STA     R
        LDA     L003D
        STA     S
        EOR     #$80
        JSR     MAD

        STA     L003D
        TXA
        STA     SXL,Y
        LDA     YY
        STA     R
        LDA     L003F
        STA     S
        JSR     MAD

        STA     S
        STX     R
        LDA     #$00
        STA     P
        LDA     ALPHA
        JSR     PIX1

        LDA     L003D
        STA     SX,Y
        STA     XX15
        AND     #$7F
        EOR     #$7F
        CMP     L009B
        BCC     KILL2

        BEQ     KILL2

        LDA     L003F
        STA     SY,Y
        STA     Y1
        AND     #$7F
        CMP     #$74
        BCS     ST5_UC

.STC2
        JSR     PIXEL2

        DEY
        BEQ     ST2

        JMP     STL2

.ST2
        LDA     ALPHA
        EOR     RAT
        STA     ALPHA
        LDA     ALP2
        EOR     RAT
        STA     ALP2
        EOR     #$80
        STA     L0049
        LDA     BET2
        EOR     RAT
        STA     BET2
        EOR     #$80
        STA     L0074
        RTS

.KILL2
        JSR     DORND

        STA     Y1
        STA     SY,Y
        LDA     #$73
        ORA     RAT
        STA     XX15
        STA     SX,Y
        BNE     STF1

.ST5_UC
        JSR     DORND

        STA     XX15
        STA     SX,Y
        LDA     #$6E
        ORA     L0049
        STA     Y1
        STA     SY,Y
.STF1
        JSR     DORND

        ORA     #$08
        STA     ZZ
        STA     SZ,Y
        BNE     STC2

.MU5
        STA     K
        STA     L0057
        STA     L0058
        STA     L0059
        CLC
        RTS

.MULT3
        STA     R
        AND     #$7F
        STA     L0058
        LDA     Q
        AND     #$7F
        BEQ     MU5

        SEC
        SBC     #$01
        STA     T
        LDA     L000D
        LSR     L0058
        ROR     A
        STA     L0057
        LDA     P
        ROR     A
        STA     K
        LDA     #$00
        LDX     #$18
.MUL2
        BCC     L44C9

        ADC     T
.L44C9
        ROR     A
        ROR     L0058
        ROR     L0057
        ROR     K
        DEX
        BNE     MUL2

        STA     T
        LDA     R
        EOR     Q
        AND     #$80
        ORA     T
        STA     L0059
        RTS

.MLS2
        LDX     XX
        STX     R
        LDX     L003D
        STX     S
.MLS1
        LDX     ALP1
.L44EA
        STX     P
        TAX
        AND     #$80
        STA     T
        TXA
        AND     #$7F
        BEQ     MU6

        TAX
        DEX
        STX     T1
        LDA     #$00
        LSR     P
        BCC     L4502

        ADC     T1
.L4502
        ROR     A
        ROR     P
        BCC     L4509

        ADC     T1
.L4509
        ROR     A
        ROR     P
        BCC     L4510

        ADC     T1
.L4510
        ROR     A
        ROR     P
        BCC     L4517

        ADC     T1
.L4517
        ROR     A
        ROR     P
        BCC     L451E

        ADC     T1
.L451E
        ROR     A
        ROR     P
        LSR     A
        ROR     P
        LSR     A
        ROR     P
        LSR     A
        ROR     P
        ORA     T
        RTS

.MU6
        STA     L000D
        STA     P
        RTS

.SQUA
        AND     #$7F
.SQUA2
        STA     P
        TAX
        BNE     MU11

.MU1
        CLC
        STX     P
        TXA
        RTS

.MLU1
        LDA     SY,Y
        STA     Y1
.MLU2
        AND     #$7F
        STA     P
.MULTU
        LDX     Q
        BEQ     MU1

.MU11
        DEX
        STX     T
        LDA     #$00
        TAX
        LSR     P
        BCC     L4557

        ADC     T
.L4557
        ROR     A
        ROR     P
        BCC     L455E

        ADC     T
.L455E
        ROR     A
        ROR     P
        BCC     L4565

        ADC     T
.L4565
        ROR     A
        ROR     P
        BCC     L456C

        ADC     T
.L456C
        ROR     A
        ROR     P
        BCC     L4573

        ADC     T
.L4573
        ROR     A
        ROR     P
        BCC     L457A

        ADC     T
.L457A
        ROR     A
        ROR     P
        BCC     L4581

        ADC     T
.L4581
        ROR     A
        ROR     P
        BCC     L4588

        ADC     T
.L4588
        ROR     A
        ROR     P
        RTS

.FMLTU2
        AND     #$1F
        TAX
        LDA     SNE,X
        STA     Q
        LDA     K
.FMLTU
        STX     P
        STA     widget
        TAX
        BEQ     MU3

        LDA     logL,X
        LDX     Q
        BEQ     MU3again

        CLC
        ADC     logL,X
        LDA     log,X
        LDX     widget
        ADC     log,X
        BCC     MU3again

        TAX
        LDA     antilog,X
        LDX     P
        RTS

.MU3again
        LDA     #$00
.MU3
        LDX     P
        RTS

.L45BE
        STX     Q
.MLTU2
        EOR     #$FF
        LSR     A
        STA     L000D
        LDA     #$00
        LDX     #$10
        ROR     P
.MUL7
        BCS     MU21

        ADC     Q
        ROR     A
        ROR     L000D
        ROR     P
        DEX
        BNE     MUL7

        RTS

.MU21
        LSR     A
        ROR     L000D
        ROR     P
        DEX
        BNE     MUL7

        RTS

        LDX     ALP1
        STX     P
.MUT2
        LDX     L003D
        STX     S
.MUT1
        LDX     XX
        STX     R
.MULT1
        TAX
        AND     #$7F
        LSR     A
        STA     P
        TXA
        EOR     Q
        AND     #$80
        STA     T
        LDA     Q
        AND     #$7F
        BEQ     mu10

        TAX
        DEX
        STX     T1
        LDA     #$00
        TAX
        BCC     L460B

        ADC     T1
.L460B
        ROR     A
        ROR     P
        BCC     L4612

        ADC     T1
.L4612
        ROR     A
        ROR     P
        BCC     L4619

        ADC     T1
.L4619
        ROR     A
        ROR     P
        BCC     L4620

        ADC     T1
.L4620
        ROR     A
        ROR     P
        BCC     L4627

        ADC     T1
.L4627
        ROR     A
        ROR     P
        BCC     L462E

        ADC     T1
.L462E
        ROR     A
        ROR     P
        BCC     L4635

        ADC     T1
.L4635
        ROR     A
        ROR     P
        LSR     A
        ROR     P
        ORA     T
        RTS

.mu10
        STA     P
        RTS

.MULT12
        JSR     MULT1

        STA     S
        LDA     P
        STA     R
        RTS

.TAS3
        LDX     INWK,Y
        STX     Q
        LDA     XX15
        JSR     MULT12

        LDX     L009E,Y
        STX     Q
        LDA     Y1
        JSR     MAD

        STA     S
        STX     R
        LDX     L00A0,Y
        STX     Q
        LDA     X2
.MAD
        JSR     MULT1

.ADD
        STA     T1
        AND     #$80
        STA     T
        EOR     S
        BMI     MU8

        LDA     R
        CLC
        ADC     P
        TAX
        LDA     S
        ADC     T1
        ORA     T
        RTS

.MU8
        LDA     S
        AND     #$7F
        STA     U
        LDA     P
        SEC
        SBC     R
        TAX
        LDA     T1
        AND     #$7F
        SBC     U
        BCS     MU9

        STA     U
        TXA
        EOR     #$FF
        ADC     #$01
        TAX
        LDA     #$00
        SBC     U
        ORA     #$80
.MU9
        EOR     T
        RTS

.TIS1
        STX     Q
        EOR     #$80
        JSR     MAD

        TAX
        AND     #$80
        STA     T
        TXA
        AND     #$7F
        LDX     #$FE
        STX     T1
.DVL3
        ASL     A
        CMP     #$60
        BCC     DV4

        SBC     #$60
.DV4
        ROL     T1
        BCS     DVL3

        LDA     T1
        ORA     T
        RTS

.DV42
        LDA     SZ,Y
.DV41
        STA     Q
        LDA     DELTA
.DVID4
        ASL     A
        STA     P
        LDA     #$00
        ROL     A
        CMP     Q
        BCC     L46DC

        SBC     Q
.L46DC
        ROL     P
        ROL     A
        CMP     Q
        BCC     L46E5

        SBC     Q
.L46E5
        ROL     P
        ROL     A
        CMP     Q
        BCC     L46EE

        SBC     Q
.L46EE
        ROL     P
        ROL     A
        CMP     Q
        BCC     L46F7

        SBC     Q
.L46F7
        ROL     P
        ROL     A
        CMP     Q
        BCC     L4700

        SBC     Q
.L4700
        ROL     P
        ROL     A
        CMP     Q
        BCC     L4709

        SBC     Q
.L4709
        ROL     P
        ROL     A
        CMP     Q
        BCC     L4712

        SBC     Q
.L4712
        ROL     P
        ROL     A
        CMP     Q
        BCC     L471B

        SBC     Q
.L471B
        ROL     P
        LDX     #$00
        STA     widget
        TAX
        BEQ     LLfix_COPY

        LDA     logL,X
        LDX     Q
        SEC
        SBC     logL,X
        LDX     widget
        LDA     log,X
        LDX     Q
        SBC     log,X
        BCS     LL2_COPY

        TAX
        LDA     antilog,X
.LLfix_COPY
        STA     R
        RTS

.LL2_COPY
        LDA     #$FF
        STA     R
        RTS

.DVID3B2
        STA     S_COPY
        LDA     L00A2
        ORA     #$01
        STA     Q
        LDA     L00A3
        STA     R
        LDA     L00A4
        STA     S
        LDA     P
        ORA     #$01
        STA     P
        LDA     S_COPY
        EOR     S
        AND     #$80
        STA     T
        LDY     #$00
        LDA     S_COPY
        AND     #$7F
.DVL9
        CMP     #$40
        BCS     DV14

        ASL     P
        ROL     L000D
        ROL     A
        INY
        BNE     DVL9

.DV14
        STA     S_COPY
        LDA     S
        AND     #$7F
.DVL6
        DEY
        ASL     Q
        ROL     R
        ROL     A
        BPL     DVL6

        STA     Q
        LDA     #$FE
        STA     R
        LDA     S_COPY
.LL31_COPY
        ASL     A
        BCS     LL29_COPY

        CMP     Q
        BCC     L4794

        SBC     Q
.L4794
        ROL     R
        BCS     LL31_COPY

        JMP     LL31_COPY_RTS

.LL29_COPY
        SBC     Q
        SEC
        ROL     R
        BCS     LL31_COPY

        LDA     R
.LL31_COPY_RTS
        LDA     #$00
        STA     L0057
        STA     L0058
        STA     L0059
        TYA
        BPL     DV12

        LDA     R
.DVL8
        ASL     A
        ROL     L0057
        ROL     L0058
        ROL     L0059
        INY
        BNE     DVL8

        STA     K
        LDA     L0059
        ORA     T
        STA     L0059
        RTS

.DV13
        LDA     R
        STA     K
        LDA     T
        STA     L0059
        RTS

.DV12
        BEQ     DV13

        LDA     R
.DVL10
        LSR     A
        DEY
        BNE     DVL10

        STA     K
        LDA     T
        STA     L0059
        RTS

.cntr
        LDA     auto
        BNE     cnt2_lc

        LDA     DAMP
        BNE     RE1

.cnt2_lc
        TXA
        BPL     BUMP

        DEX
        BMI     L485E

.BUMP
        INX
        BNE     RE1

        DEX
        BEQ     BUMP

.RE1
        RTS

.BUMP2
        STA     T
        TXA
        CLC
        ADC     T
        TAX
        BCC     RE2

        LDX     #$FF
.RE2
        BPL     djd1

.L4800
        LDA     T
        RTS

.REDU2
        STA     T
        TXA
        SEC
        SBC     T
        TAX
        BCS     RE3

        LDX     #$01
.RE3
        BPL     L4800

.djd1
        LDA     DJD
        BNE     L4800

        LDX     #$80
        BMI     L4800

.ARCTAN
        LDA     P
        EOR     Q
        STA     T1
        LDA     Q
        BEQ     AR2

        ASL     A
        STA     Q
        LDA     P
        ASL     A
        CMP     Q
        BCS     AR1

        JSR     ARS1

        SEC
.AR4
        LDX     T1
        BMI     AR3

        RTS

.AR1
        LDX     Q
        STA     Q
        STX     P
        TXA
        JSR     ARS1

        STA     T
        LDA     #$40
        SBC     T
        BCS     AR4

.AR2
        LDA     #$3F
        RTS

.AR3
        STA     T
        LDA     #$80
        SBC     T
        RTS

.ARS1
        JSR     LL28

        LDA     R
        LSR     A
        LSR     A
        LSR     A
        TAX
        LDA     ACT,X
.L485E
        RTS

.LASLI
        JSR     DORND

        AND     #$07
        ADC     #$5C
        STA     LASY
        JSR     DORND

        AND     #$07
        ADC     #$7C
        STA     LASX
        LDA     GNTMP
        ADC     #$08
        STA     GNTMP
        JSR     DENGY

.LASLI2
        LDA     QQ11
        BNE     L485E

        LDA     #$F0
        STA     COL
        LDA     #$20
        LDY     #$E0
        DEC     LASY
        DEC     LASY
        JSR     las_lc

        INC     LASY
        INC     LASY
        LDA     #$30
        LDY     #$D0
.las_lc
        STA     X2
        LDA     LASX
        STA     XX15
        LDA     LASY
        STA     Y1
        LDA     #$BF
        STA     Y2
        JSR     LL30

        LDA     LASX
        STA     XX15
        LDA     LASY
        STA     Y1
        STY     X2
        LDA     #$BF
        STA     Y2
        JMP     LL30

.PDESC
        LDA     QQ8
        ORA     L00E0
        BNE     PD1

        LDA     QQ12
        BPL     PD1

        LDY     #$00
.PDL1
        LDA     LAF47,Y
        CMP     ZZ
        BNE     PD2

        LDA     LAF61,Y
        AND     #$7F
        CMP     GCNT
        BNE     PD2

        LDA     LAF61,Y
        BMI     PD3

        LDA     TP
        LSR     A
        BCC     PD1

        JSR     MT14

        LDA     #$01
        EQUB    $2C

.PD3
        LDA     #$B0
        JSR     DETOK2

        TYA
        JSR     DETOK3

        LDA     #$B1
        BNE     PD4

.PD2
        DEY
        BNE     PDL1

.PD1
        LDX     #$03
.PDL1_BRACES
        LDA     L0060,X
        STA     RAND,X
        DEX
        BPL     PDL1_BRACES

        LDA     #$05
.PD4
        JMP     DETOK

.BRIEF2
        LDA     TP
        ORA     #$04
        STA     TP
        LDA     #$0B
.BRP
        LDX     #$FF
        STX     COL
        JSR     DETOK

        JMP     BAY

.BRIEF3
        LDA     TP
        AND     #$F0
        ORA     #$0A
        STA     TP
        LDA     #$DE
        BNE     BRP

.DEBRIEF2
        LDA     TP
        ORA     #$04
        STA     TP
        LDA     #$02
        STA     ENGY
        INC     L127C
        LDA     #$DF
        BNE     BRP

.DEBRIEF
        LSR     TP
        ASL     TP
        LDX     #$50
        LDY     #$C3
        JSR     MCASH

        LDA     #$0F
.BRPS
        BNE     BRP

.BRIEF
        LSR     TP
        SEC
        ROL     TP
        JSR     BRIS

        JSR     ZINF

        LDA     #$1F
        STA     TYPE
        JSR     NWSHP

        LDA     #$01
        JSR     DOXC

        STA     L00A3
        LDA     #$0D
        JSR     TT66

        LDA     #$40
        STA     MCNT
.BRL1
        LDX     #$7F
        STX     L00B9
        STX     L00BA
        JSR     LL9

        JSR     MVEIT

        DEC     MCNT
        BNE     BRL1

.BRL2
        LSR     INWK
        INC     L00A2
        BEQ     BR2

        INC     L00A2
        BEQ     BR2

        LDX     L009F
        INX
        CPX     #$78
        BCC     L499D

        LDX     #$78
.L499D
        STX     L009F
        JSR     LL9

        JSR     MVEIT

        DEC     MCNT
        JMP     BRL2

.BR2
        INC     L00A3
        JSR     PAS1

        LDA     #$0A
        BNE     BRPS

.BRIS
        LDA     #$D8
        JSR     DETOK

        LDY     #$64
        JMP     DELAY

.PAUSE
        JSR     PAS1

.L49C0
        BNE     PAUSE

L49C1 = L49C0+1
.PAL1
        JSR     PAS1

        BEQ     PAL1

        LDA     #$00
        STA     L00BB
        LDA     #$01
        JSR     TT66

        JSR     LL9

        LDA     #$0A
        BIT     L06A9
        STA     YC
        LDA     #$FF
        STA     COL
        JMP     MT13

.PAS1
        LDA     #$78
        STA     L009F
        LDA     #$00
        STA     INWK
        STA     L00A2
        LDA     #$02
        STA     L00A3
        JSR     LL9

        JSR     MVEIT

        JMP     RDKEY

.PAUSE2
        JSR     RDKEY

        BNE     PAUSE2

        JSR     RDKEY

        BEQ     PAUSE2

        RTS

.GINF
        TXA
        ASL     A
        TAY
        LDA     UNIV,Y
        STA     INF
        LDA     L357A,Y
        STA     L0039
        RTS

.L4A11
        LDX     #$01
.L4A13
        LDA     QQ0,X
        STA     QQ9,X
        DEX
        BPL     L4A13

        RTS

.L4A1C
        EQUB    $10

        EQUB    $15,$1A,$1F,$9B,$A0,$2E,$A5,$24
        EQUB    $29,$3D,$33,$38,$AA,$42,$47,$4C
        EQUB    $51,$56,$8C,$60,$65,$87,$82,$5B
        EQUB    $6A,$B4,$B9,$BE,$E1,$E6,$EB,$F0
        EQUB    $F5,$FA,$73,$78,$7D

.L4A42
        LSR     A
.L4A43
        RTS

.L4A44
        RTS

.L4A45
        STA     XX15
        STA     X2
        LDA     #$18
        STA     Y1
        LDA     #$98
        STA     Y2
        JMP     LL30

.tnpr1
        STA     QQ29
        LDA     #$01
.tnpr
        PHA
        LDX     #$0C
        CPX     QQ29
        BCC     L4A6F

.L4A61
        ADC     QQ20,X
        DEX
        BPL     L4A61

        ADC     L1265
        CMP     CRGO
        PLA
        RTS

.L4A6F
        LDY     QQ29
        ADC     QQ20,Y
        CMP     #$C8
        PLA
        RTS

.DOXC
        STA     XC
        RTS

.DOYC
        STA     YC
        RTS

        INC     YC
        RTS

.TRADEMODE
        JSR     TT66

        JSR     FLKB

.L4A88
        LDA     #$30
        JSR     DOVDU19

        LDA     #$FF
        STA     COL
        RTS

.TT20
        JSR     L4A95

.L4A95
        JSR     TT54

.TT54
        LDA     QQ15
        CLC
        ADC     L0060
        TAX
        LDA     L005F
        ADC     L0061
        TAY
        LDA     L0060
        STA     QQ15
        LDA     L0061
        STA     L005F
        LDA     L0063
        STA     L0061
        LDA     L0062
        STA     L0060
        CLC
        TXA
        ADC     L0060
        STA     L0062
        TYA
        ADC     L0061
        STA     L0063
        RTS

.TT146
        LDA     QQ8
        ORA     L00E0
        BNE     L4AC8

        INC     YC
        RTS

.L4AC8
        LDA     #$BF
        JSR     TT68

        LDX     QQ8
        LDY     L00E0
        SEC
        JSR     pr5

        LDA     #$C3
.TT60
        JSR     TT27

.TTX69
        INC     YC
.TT69
        LDA     #$80
        STA     QQ17
.L4AE0
        LDA     #$0C
        JMP     TT27

.TT70
        LDA     #$AD
        JSR     TT27

        JMP     TT72

.spc
        JSR     TT27

        JMP     TT162

.TT25
        LDA     #$01
        JSR     TRADEMODE

        LDA     #$09
        STA     XC
        LDA     #$A3
        JSR     NLIN3

        JSR     TTX69

        JSR     TT146

        LDA     #$C2
        JSR     TT68

        LDA     QQ3
        CLC
        ADC     #$01
        LSR     A
        CMP     #$02
        BEQ     TT70

        LDA     QQ3
        BCC     L4B1D

        SBC     #$05
        CLC
.L4B1D
        ADC     #$AA
        JSR     TT27

.TT72
        LDA     QQ3
        LSR     A
        LSR     A
        CLC
        ADC     #$A8
        JSR     TT60

        LDA     #$A2
        JSR     TT68

        LDA     QQ4
        CLC
        ADC     #$B1
        JSR     TT60

        LDA     #$C4
        JSR     TT68

        LDX     QQ5
        INX
        CLC
        JSR     pr2

        JSR     TTX69

        LDA     #$C0
        JSR     TT68

        SEC
        LDX     QQ6
        JSR     pr2

        LDA     #$C6
        JSR     TT60

        LDA     #$28
        JSR     TT27

        LDA     L0062
        BMI     L4B69

        LDA     #$BC
        JSR     TT27

        JMP     L4BA5

.L4B69
        LDA     L0063
        LSR     A
        LSR     A
        PHA
        AND     #$07
        CMP     #$03
        BCS     TT205

        ADC     #$E3
        JSR     spc

.TT205
        PLA
        LSR     A
        LSR     A
        LSR     A
        CMP     #$06
        BCS     L4B86

        ADC     #$E6
        JSR     spc

.L4B86
        LDA     L0061
        EOR     L005F
        AND     #$07
        STA     QQ19
        CMP     #$06
        BCS     L4B97

        ADC     #$EC
        JSR     spc

.L4B97
        LDA     L0063
        AND     #$03
        CLC
        ADC     QQ19
        AND     #$07
        ADC     #$F2
        JSR     TT27

.L4BA5
        LDA     #$53
        JSR     TT27

        LDA     #$29
        JSR     TT60

        LDA     #$C1
        JSR     TT68

        LDX     QQ7
        LDY     L00DE
        JSR     pr6

        JSR     TT162

        STZ     QQ17
        LDA     #$4D
        JSR     TT27

        LDA     #$E2
        JSR     TT60

        LDA     #$FA
        JSR     TT68

        LDA     L0063
        LDX     L0061
        AND     #$0F
        CLC
        ADC     #$0B
        TAY
        JSR     pr5

        JSR     TT162

        LDA     #$6B
        JSR     DASC

        LDA     #$6D
        JSR     DASC

        JSR     TTX69

        JMP     PDESC

.TT24
        LDA     L005F
        AND     #$07
        STA     QQ3
        LDA     L0060
        LSR     A
        LSR     A
        LSR     A
        AND     #$07
        STA     QQ4
        LSR     A
        BNE     L4C07

        LDA     QQ3
        ORA     #$02
        STA     QQ3
.L4C07
        LDA     QQ3
        EOR     #$07
        CLC
        STA     QQ5
        LDA     L0061
        AND     #$03
        ADC     QQ5
        STA     QQ5
        LDA     QQ4
        LSR     A
        ADC     QQ5
        STA     QQ5
        ASL     A
        ASL     A
        ADC     QQ3
        ADC     QQ4
        ADC     #$01
        STA     QQ6
        LDA     QQ3
        EOR     #$07
        ADC     #$03
        STA     P
        LDA     QQ4
        ADC     #$04
        STA     Q
        JSR     MULTU

        LDA     QQ6
        STA     Q
        JSR     MULTU

        ASL     P
        ROL     A
        ASL     P
        ROL     A
        ASL     P
        ROL     A
        STA     L00DE
        LDA     P
        STA     QQ7
        RTS

.TT22
        LDA     #$40
        JSR     TT66

        LDA     #$10
        JSR     DOVDU19

        LDA     #$FF
        STA     COL
        LDA     #$07
        STA     XC
        JSR     TT81

        LDA     #$C7
        JSR     TT27

        JSR     NLIN

        LDA     #$99
        JSR     L359D

        JSR     TT14

        LDX     #$00
.L4C76
        STX     XSAV
        LDX     L0061
        LDY     L0062
        TYA
        ORA     #$50
        STA     ZZ
        LDA     #$0F
        STA     COL
        LDA     L005F
        JSR     L4A42

        CLC
        ADC     #$18
        JSR     PIXEL

        JSR     TT20

        LDX     XSAV
        INX
        BNE     L4C76

        LDA     QQ9
        JSR     L4A44

        STA     QQ19
        LDA     QQ10
        JSR     L4A42

        STA     L006E
        LDA     #$04
        STA     L006F
        LDA     #$AF
        STA     COL
.TT15
        LDA     #$18
        LDX     QQ11
        BPL     L4CB6

        LDA     #$00
.L4CB6
        STA     L0072
        LDA     QQ19
        SEC
        SBC     L006F
        BIT     QQ11
        BMI     L4CC9

        BCC     L4CC7

        CMP     #$02
        BCS     L4CC9

.L4CC7
        LDA     #$02
.L4CC9
        STA     XX15
        LDA     QQ19
        CLC
        ADC     L006F
        BCS     L4CD6

        CMP     #$FE
        BCC     L4CD8

.L4CD6
        LDA     #$FE
.L4CD8
        STA     X2
        LDA     L006E
        CLC
        ADC     L0072
        STA     Y1
        JSR     HLOIN3

        LDA     L006E
        SEC
        SBC     L006F
        BCS     L4CED

        LDA     #$00
.L4CED
        CLC
        ADC     L0072
        STA     Y1
        LDA     L006E
        CLC
        ADC     L006F
        ADC     L0072
        CMP     #$98
        BCC     L4D03

        LDX     QQ11
        BMI     L4D03

        LDA     #$98
.L4D03
        STA     Y2
        LDA     QQ19
        STA     XX15
        STA     X2
        JMP     LL30

.TT126
        LDA     #$68
        STA     QQ19
        LDA     #$5A
        STA     L006E
        LDA     #$10
        STA     L006F
        LDA     #$AF
        STA     COL
        JSR     TT15

        LDA     QQ14
        JSR     L4A43

        STA     K
        JMP     TT128

.TT14
        LDA     QQ11
        BMI     TT126

        LDA     QQ14
        LSR     A
        JSR     L4A42

        STA     K
        LDA     QQ0
        JSR     L4A44

        STA     QQ19
        LDA     QQ1
        JSR     L4A42

        STA     L006E
        LDA     #$07
        STA     L006F
        LDA     #$FF
        STA     COL
        JSR     TT15

        LDA     L006E
        CLC
        ADC     #$18
        STA     L006E
.TT128
        LDA     QQ19
        STA     K3
        LDA     L006E
        STA     K4
        STZ     L0023
        STZ     L0015
        LDX     #$01
        STX     LSP
        INX
        STX     STP
        LDA     #$F0
        STA     COL
        JMP     CIRCLE2

.TT219
        LDA     #$02
        JSR     TRADEMODE

        JSR     TT163

        LDA     #$80
        STA     QQ17
        LDA     #$00
        STA     QQ29
.L4D86
        JSR     TT151

        LDA     QQ25
        BNE     L4D9D

        JMP     TT222

.L4D91
        LDY     #$B0
.L4D93
        JSR     TT162

        TYA
        JSR     prq

        JSR     dn2

.L4D9D
        JSR     CLYNS

        LDA     #$CC
        JSR     TT27

        LDA     QQ29
        CLC
        ADC     #$D0
        JSR     TT27

        LDA     #$2F
        JSR     TT27

        JSR     TT152

        LDA     #$3F
        JSR     TT27

        JSR     L4AE0

        LDX     #$00
        STX     R
        LDX     #$0C
        STX     T1
        JSR     gnum

        BCS     L4D91

        STA     P
        JSR     tnpr

        LDY     #$CE
        LDA     R
        BEQ     L4DD8

        BCS     L4D93

.L4DD8
        LDA     QQ24
        STA     Q
        JSR     GCASH

        JSR     LCASH

        LDY     #$C5
        BCC     L4D93

        LDY     QQ29
        LDA     R
        PHA
        CLC
        ADC     QQ20,Y
        STA     QQ20,Y
        LDA     AVL,Y
        SEC
        SBC     R
        STA     AVL,Y
        PLA
        BEQ     TT222

        JSR     dn

.TT222
        LDA     QQ29
        CLC
        ADC     #$05
        JSR     DOYC

        LDA     #$00
        JSR     DOXC

        INC     QQ29
        LDA     QQ29
        CMP     #$11
        BCS     BAY2

        JMP     L4D86

.BAY2
        LDA     #$89
        JMP     FRCE

.gnum
        LDA     #$F0
        STA     COL
        LDX     #$00
        STX     R
        LDX     #$0C
        STX     T1
.L4E2F
        JSR     TT217

        LDX     R
        BNE     NWDAV2

        CMP     #$59
        BEQ     L4E75

        CMP     #$4E
        BEQ     NWDAV3

.NWDAV2
        STA     Q
        SEC
        SBC     #$30
        BCC     L4E6E

        CMP     #$0A
        BCS     BAY2

        STA     S
        LDA     R
        CMP     #$1A
        BCS     L4E99

        ASL     A
        STA     T
        ASL     A
        ASL     A
        ADC     T
        ADC     S
        BCS     L4E99

        STA     R
        CMP     QQ25
        BEQ     L4E65

        BCS     L4E99

.L4E65
        LDA     Q
        JSR     DASC

        DEC     T1
        BNE     L4E2F

.L4E6E
        LDA     #$FF
        STA     COL
        LDA     R
        RTS

.L4E75
        JSR     DASC

        LDA     QQ25
        STA     R
        JMP     L4E6E

.NWDAV3
        JSR     DASC

        STZ     R
        JMP     L4E6E

.NWDAV4
        JSR     L4AE0

        LDA     #$B0
        JSR     prq

        JSR     dn2

        LDY     QQ29
        JMP     NWDAVxx

.L4E99
        LDA     Q
        JSR     DASC

        SEC
        JMP     L4E6E

.TT208
        LDA     #$04
        JSR     TRADEMODE

        LDA     #$0A
        STA     XC
        LDA     #$CD
        JSR     TT27

        LDA     #$CE
        JSR     NLIN3

        JSR     L4AE0

.TT210
        LDY     #$00
.L4EBA
        STY     QQ29
.NWDAVxx
        LDX     QQ20,Y
        BEQ     L4F2A

        TYA
        ASL     A
        ASL     A
        TAY
        LDA     L6E6E,Y
        STA     L006E
        TXA
        PHA
        JSR     TT69

        CLC
        LDA     QQ29
        ADC     #$D0
        JSR     TT27

        LDA     #$0E
        JSR     DOXC

        PLA
        TAX
        STA     QQ25
        CLC
        JSR     pr2

        JSR     TT152

        LDA     QQ11
        CMP     #$04
        BNE     L4F2A

        LDA     #$CD
        JSR     TT27

        LDA     #$CE
        JSR     DETOK

        JSR     gnum

        BEQ     L4F2A

        BCS     NWDAV4

        LDA     QQ29
        LDX     #$FF
        STX     QQ17
        JSR     TT151

        LDY     QQ29
        LDA     QQ20,Y
        SEC
        SBC     R
        STA     QQ20,Y
        LDA     R
        STA     P
        LDA     QQ24
        STA     Q
        JSR     GCASH

        JSR     MCASH

        LDA     #$00
        STA     QQ17
.L4F2A
        LDY     QQ29
        INY
        CPY     #$11
        BCC     L4EBA

        LDA     QQ11
        CMP     #$04
        BNE     L4F3E

        JSR     dn2

        JMP     BAY2

.L4F3E
        JSR     TT69

        LDA     L1264
        ORA     L1265
        BNE     L4F4A

.L4F49
        RTS

.L4F4A
        CLC
        LDA     #$00
        LDX     L1264
        LDY     L1265
        JSR     TT11

        JSR     DORND

        AND     #$03
        CLC
        ADC     #$6F
        JSR     DETOK

        LDA     #$C6
        JSR     DETOK

        LDA     L1265
        BNE     L4F71

        LDX     L1264
        DEX
        BEQ     L4F49

.L4F71
        LDA     #$73
        JMP     DASC

.TT213
        LDA     #$08
        JSR     TRADEMODE

        LDA     #$0B
        STA     XC
        LDA     #$A4
        JSR     TT60

        JSR     NLIN4

        JSR     fwl

        LDA     CRGO
        CMP     #$1A
        BCC     L4F96

        LDA     #$6B
        JSR     TT27

.L4F96
        JMP     TT210

        JSR     TT27

        LDA     #$CE
        JSR     DETOK

        JSR     TT217

        ORA     #$20
        CMP     #$79
        BEQ     L4FAF

        LDA     #$6E
        JMP     DASC

.L4FAF
        JSR     DASC

        SEC
        RTS

.TT16
        TXA
        PHA
        DEY
        TYA
        EOR     #$FF
        PHA
        JSR     WSCAN

        JSR     TT103

        PLA
        STA     L0070
        LDA     QQ10
        JSR     TT123

        LDA     L0071
        STA     QQ10
        STA     L006E
        PLA
        STA     L0070
        LDA     QQ9
        JSR     TT123

        LDA     L0071
        STA     QQ9
        STA     QQ19
.TT103
        LDA     #$AF
        STA     COL
        LDA     QQ11
        BMI     TT105

        LDA     QQ9
        JSR     L4A44

        STA     QQ19
        LDA     QQ10
        JSR     L4A42

        STA     L006E
        LDA     #$04
        STA     L006F
        JMP     TT15

.TT123
        STA     L0071
        CLC
        ADC     L0070
        LDX     L0070
        BMI     L5006

        BCC     L5008

        RTS

.L5006
        BCC     L500A

.L5008
        STA     L0071
.L500A
        RTS

.TT105
        LDA     QQ9
        SEC
        SBC     QQ0
        BCS     L5017

        EOR     #$FF
        ADC     #$01
.L5017
        CMP     #$1D
        BCS     L500A

        LDA     QQ9
        SEC
        SBC     QQ0
        BPL     L5027

        CMP     #$E9
        BCC     L500A

.L5027
        ASL     A
        ASL     A
        CLC
        ADC     #$68
        JSR     L4A43

        STA     QQ19
        LDA     QQ10
        SEC
        SBC     QQ1
        BCS     L503D

        EOR     #$FF
        ADC     #$01
.L503D
        CMP     #$23
        BCS     L500A

        LDA     QQ10
        SEC
        SBC     QQ1
        ASL     A
        CLC
        ADC     #$5A
        JSR     L4A43

        STA     L006E
        LDA     #$08
        STA     L006F
        LDA     #$AF
        STA     COL
        JMP     TT15

.TT23
        LDA     #$80
        JSR     TT66

        LDA     #$10
        JSR     DOVDU19

        LDA     #$FF
        STA     COL
        LDA     #$07
        STA     XC
        LDA     #$BE
        JSR     NLIN3

        JSR     TT14

        JSR     TT103

        JSR     TT81

        LDA     #$FF
        STA     COL
        LDA     #$00
        STA     XX20
        LDX     #$18
.L5085
        STA     INWK,X
        DEX
        BPL     L5085

.L508A
        LDA     L0061
        SEC
        SBC     QQ0
        BCS     L5096

        EOR     #$FF
        ADC     #$01
.L5096
        CMP     #$1D
        BCS     L50FB

        LDA     L005F
        SEC
        SBC     QQ1
        BCS     L50A6

        EOR     #$FF
        ADC     #$01
.L50A6
        CMP     #$28
        BCS     L50FB

        LDA     L0061
        SEC
        SBC     QQ0
        ASL     A
        ASL     A
        ADC     #$68
        JSR     L4A43

        STA     XX12
        LSR     A
        LSR     A
        LSR     A
        INC     A
        STA     XC
        LDA     L005F
        SEC
        SBC     QQ1
        ASL     A
        ADC     #$5A
        JSR     L4A43

        STA     K4
        LSR     A
        LSR     A
        LSR     A
        TAY
        LDX     INWK,Y
        BEQ     L50E0

        INY
        LDX     INWK,Y
        BEQ     L50E0

        DEY
        DEY
        LDX     INWK,Y
        BNE     L5109

.L50E0
        STY     YC
        CPY     #$03
        BCC     L512A

        CPY     #$15
        BCS     L512A

        TYA
        PHA
        LDA     L0061
        JSR     L5193

        PLA
        TAY
        LDA     L00E0
        BNE     L512A

        LDA     QQ8
        CMP     #$46
.L50FB
        BCS     L512A

        LDA     #$FF
        STA     INWK,Y
        LDA     #$80
        STA     QQ17
        JSR     cpl

.L5109
        LDA     #$00
        STA     L0015
        STA     L0023
        STA     L0057
        LDA     XX12
        STA     K3
        LDA     L0063
        AND     #$01
        ADC     #$02
        STA     K
        JSR     FLFLLS

        JSR     SUN

        JSR     FLFLLS

        LDA     #$FF
        STA     COL
.L512A
        JSR     TT20

        INC     XX20
        BEQ     L5134

        JMP     L508A

.L5134
        RTS

.TT81
        LDX     #$05
.L5137
        LDA     QQ21,X
        STA     QQ15,X
        DEX
        BPL     L5137

        RTS

.TT111
        JSR     TT81

        LDY     #$7F
        STY     T
        LDA     #$00
        STA     U
.L514B
        LDA     L0061
        SEC
        SBC     QQ9
        BCS     L5156

        EOR     #$FF
        ADC     #$01
.L5156
        LSR     A
        STA     S
        LDA     L005F
        SEC
        SBC     QQ10
        BCS     L5164

        EOR     #$FF
        ADC     #$01
.L5164
        LSR     A
        CLC
        ADC     S
        CMP     T
        BCS     L517B

        STA     T
        LDX     #$05
.L5170
        LDA     QQ15,X
        STA     QQ19,X
        DEX
        BPL     L5170

        LDA     U
        STA     ZZ
.L517B
        JSR     TT20

        INC     U
        BNE     L514B

        LDX     #$05
.L5184
        LDA     QQ19,X
        STA     QQ15,X
        DEX
        BPL     L5184

        LDA     L005F
        STA     QQ10
        LDA     L0061
        STA     QQ9
.L5193
        SEC
        SBC     QQ0
        BCS     L519D

        EOR     #$FF
        ADC     #$01
.L519D
        JSR     SQUA2

        STA     L0057
        LDA     P
        STA     K
        LDA     L005F
        SEC
        SBC     QQ1
        BCS     L51B2

        EOR     #$FF
        ADC     #$01
.L51B2
        LSR     A
        JSR     SQUA2

        PHA
        LDA     P
        CLC
        ADC     K
        STA     Q
        PLA
        ADC     L0057
        BCC     L51C5

        LDA     #$FF
.L51C5
        STA     R
        JSR     LL5

        LDA     Q
        ASL     A
        LDX     #$00
        STX     L00E0
        ROL     L00E0
        ASL     A
        ROL     L00E0
        STA     QQ8
        JMP     TT24

.hy6
        JSR     CLYNS

        LDA     #$0F
        STA     XC
        LDA     #$F0
        STA     COL
        LDA     #$CD
        JMP     DETOK

.hyp
        LDA     QQ12
        BNE     hy6

        LDA     L0045
        BEQ     L51F4

        RTS

.L51F4
        LDA     #$FF
        STA     COL
        JSR     CTRL

        BMI     Ghy

        LDA     QQ11
        BEQ     L524B

        AND     #$C0
        BNE     L5206

        RTS

.L5206
        JSR     hm

.L5209
        LDA     QQ8
        ORA     L00E0
        BNE     L5210

        RTS

.L5210
        LDX     #$05
.L5212
        LDA     QQ15,X
        STA     L12A0,X
        DEX
        BPL     L5212

        LDA     #$07
        STA     XC
        LDA     #$16
        STA     YC
        LDA     #$00
        STA     QQ17
        LDA     #$BD
        JSR     TT27

        LDA     L00E0
        BNE     L5236

        LDA     QQ14
        CMP     QQ8
        BCS     L5239

.L5236
        JMP     TT147

.L5239
        LDA     #$2D
        JSR     TT27

        JSR     cpl

        LDA     #$0F
.wW
        STA     L0045
        STA     QQ22
        TAX
        JMP     L52A5

.L524B
        JSR     TT111

        JMP     L5209

.Ghy
        LDX     GHYP
        BEQ     L527A

        INX
        STX     GHYP
        STX     FIST
        LDA     #$02
        JSR     wW

        LDX     #$05
        INC     GCNT
        LDA     GCNT
        AND     #$F7
        STA     GCNT
.L526F
        LDA     QQ21,X
        ASL     A
        ROL     QQ21,X
        DEX
        BPL     L526F

.L5279
        LDA     #$60
L527A = L5279+1
        STA     QQ9
        STA     QQ10
        JSR     L5495

        JSR     TT111

        LDX     #$05
.L5287
        LDA     QQ15,X
        STA     L12A0,X
        DEX
        BPL     L5287

        LDX     #$00
        STX     QQ8
        STX     L00E0
        LDA     #$74
        JSR     MESS

.jmp
        LDA     QQ9
        STA     QQ0
        LDA     QQ10
        STA     QQ1
        RTS

.L52A5
        LDA     #$F0
        STA     COL
        LDA     #$01
        STA     XC
        STA     YC
        LDY     #$00
        CLC
        LDA     #$03
        JMP     TT11

.pr6
        CLC
.pr5
        LDA     #$05
        JMP     TT11

.TT147
        LDA     #$CA
.prq
        JSR     TT27

        LDA     #$3F
        JMP     TT27

.TT151q
        PLA
        RTS

.TT151
        PHA
        STA     L0071
        ASL     A
        ASL     A
        STA     QQ19
        LDA     MJ
        BNE     TT151q

        LDA     #$01
        JSR     DOXC

        PLA
        ADC     #$D0
        JSR     TT27

        LDA     #$0E
        STA     XC
        LDX     QQ19
        LDA     L6E6E,X
        STA     L006E
        LDA     L127A
        AND     L6E70,X
        CLC
        ADC     L6E6D,X
        STA     QQ24
        JSR     TT152

        JSR     L5398

        LDA     L006E
        BMI     L530A

        LDA     QQ24
        ADC     L0070
        JMP     L5310

.L530A
        LDA     QQ24
        SEC
        SBC     L0070
.L5310
        STA     QQ24
        STA     P
        LDA     #$00
        JSR     L551E

        SEC
        JSR     pr5

        LDY     L0071
        LDA     #$05
        LDX     AVL,Y
        STX     QQ25
        CLC
        BEQ     L5331

        JSR     L3AA5

        JMP     TT152

.L5331
        LDA     #$19
        JSR     DOXC

        LDA     #$2D
        BNE     L5349

.TT152
        LDA     L006E
        AND     #$60
        BEQ     L534C

        CMP     #$20
        BEQ     L5353

        JSR     L5358

.TT162
        LDA     #$20
.L5349
        JMP     TT27

.L534C
        LDA     #$74
        JSR     DASC

        BCC     TT162

.L5353
        LDA     #$6B
        JSR     DASC

.L5358
        LDA     #$67
        JMP     DASC

.TT163
        LDA     #$11
        JSR     DOXC

        LDA     #$FF
        BNE     L5349

.L5366
        LDA     #$10
        JSR     TRADEMODE

        LDA     #$05
        STA     XC
        LDA     #$A7
        JSR     NLIN3

        LDA     #$03
        STA     YC
        JSR     TT163

        LDA     #$06
        STA     YC
        LDA     #$00
        STA     QQ29
.L5384
        LDX     #$80
        STX     QQ17
        JSR     TT151

        INC     YC
        INC     QQ29
        LDA     QQ29
        CMP     #$11
        BCC     L5384

        RTS

.L5398
        LDA     L006E
        AND     #$1F
        LDY     L1294
        STA     L006F
        CLC
        LDA     #$00
        STA     L1279
.L53A7
        DEY
        BMI     L53AF

        ADC     L006F
        JMP     L53A7

.L53AF
        STA     L0070
        RTS

        JSR     TT111

.L53B5
        JSR     jmp

        LDX     #$05
.L53BA
        LDA     L12A0,X
        STA     L129A,X
        DEX
        BPL     L53BA

        INX
        STX     L0E7B
        LDA     QQ3
        STA     L1294
        LDA     QQ5
        STA     L1297
        LDA     QQ4
        STA     L1296
        JSR     DORND

        STA     L127A
        LDX     #$00
        STX     XX4
.L53E0
        LDA     L6E6E,X
        STA     L006E
        JSR     L5398

        LDA     L6E70,X
        AND     L127A
        CLC
        ADC     L6E6F,X
        LDY     L006E
        BMI     L53FC

        SEC
        SBC     L0070
        JMP     L53FF

.L53FC
        CLC
        ADC     L0070
.L53FF
        BPL     L5403

        LDA     #$00
.L5403
        LDY     XX4
        AND     #$3F
        STA     AVL,Y
        INY
        TYA
        STA     XX4
        ASL     A
        ASL     A
        TAX
        CMP     #$3F
        BCC     L53E0

        RTS

.L5416
        JSR     L63DF

        LDA     #$FF
        STA     L00BC
        LDA     #$1D
        JSR     NWSHP

        LDA     #$1E
        JMP     NWSHP

.L5427
        LSR     L1242
        SEC
        ROL     L1242
.L542E
        LDA     #$03
        JSR     TT66

        JSR     LL164

        JSR     RES2

        STY     MJ
.L543C
        JSR     L5416

        LDA     #$02
        CMP     L0E6B
        BCS     L543C

        STA     NOSTM
        LDX     #$00
        JSR     LOOK1

        LDA     QQ1
        EOR     #$1F
        STA     QQ1
        RTS

.L5456
        RTS

.L5457
        LDA     QQ14
        SEC
        SBC     QQ8
        BCS     L5461

        LDA     #$00
.L5461
        STA     QQ14
        LDA     QQ11
        BNE     L546E

        JSR     TT66

        JSR     LL164

.L546E
        JSR     CTRL

        AND     L2C58
        BMI     L5427

        JSR     DORND

        CMP     #$FD
        BCS     L542E

        JSR     L53B5

        JSR     RES2

        JSR     L5A24

        LDA     QQ11
        AND     #$3F
        BNE     L5456

        JSR     TTX66

        LDA     QQ11
        BNE     L54CB

        INC     QQ11
.L5495
        LDX     QQ12
        BEQ     L54C4

        JSR     LAUN

        JSR     RES2

        JSR     TT111

        INC     L00A4
        JSR     SOS1

        LDA     #$80
        STA     L00A4
        INC     L00A3
        JSR     NWSPS

        LDA     #$0C
        STA     DELTA
        JSR     L6698

        ORA     FIST
        STA     FIST
        LDA     #$FF
        STA     QQ11
        JSR     HFS1

.L54C4
        LDX     #$00
        STX     QQ12
        JMP     LOOK1

.L54CB
        BMI     L54D0

        JMP     TT22

.L54D0
        JMP     TT23

.LCASH
        STX     T1
        LDA     L1240
        SEC
        SBC     T1
        STA     L1240
        STY     T1
        LDA     L123F
        SBC     T1
        STA     L123F
        LDA     L123E
        SBC     #$00
        STA     L123E
        LDA     L123D
        SBC     #$00
        STA     L123D
        BCS     L551A

.MCASH
        TXA
        CLC
        ADC     L1240
        STA     L1240
        TYA
        ADC     L123F
        STA     L123F
        LDA     L123E
        ADC     #$00
        STA     L123E
        LDA     L123D
        ADC     #$00
        STA     L123D
        CLC
.L551A
        RTS

.GCASH
        JSR     MULTU

.L551E
        ASL     P
        ROL     A
        ASL     P
        ROL     A
        TAY
        LDX     P
        RTS

.L5528
        JMP     BAY

.L552B
        LDA     #$20
        JSR     TRADEMODE

        LDA     #$0C
        STA     XC
        LDA     #$CF
        JSR     spc

        LDA     #$B9
        JSR     NLIN3

        LDA     #$80
        STA     QQ17
        INC     YC
        LDA     L1297
        CLC
        ADC     #$03
        CMP     #$0C
        BCC     L5550

        LDA     #$0E
.L5550
        STA     Q
        STA     QQ25
        INC     Q
        LDA     #$46
        SEC
        SBC     QQ14
        ASL     A
        STA     L5735
        LDX     #$01
.L5563
        STX     L0083
        JSR     L4AE0

        LDX     L0083
        CLC
        JSR     pr2

        JSR     TT162

        LDA     L0083
        CLC
        ADC     #$68
        JSR     TT27

        LDA     L0083
        JSR     L56AA

        SEC
        LDA     #$19
        STA     XC
        LDA     #$06
        JSR     TT11

        LDX     L0083
        INX
        CPX     Q
        BCC     L5563

        JSR     CLYNS

        LDA     #$7F
        JSR     prq

        JSR     gnum

        BEQ     L5528

        BCS     L5528

        SBC     #$00
        PHA
        LDA     #$02
        STA     XC
        INC     YC
        PLA
        PHA
        JSR     L569A

        PLA
        BNE     L55B4

        LDX     #$46
        STX     QQ14
.L55B4
        CMP     #$01
        BNE     L55CA

        LDX     NOMSL
        INX
        LDY     #$7C
        CPX     #$05
        BCS     L560C

        STX     NOMSL
        JSR     L63AE

        LDA     #$01
.L55CA
        LDY     #$6B
        CMP     #$02
        BNE     L55DA

        LDX     #$25
        CPX     CRGO
        BEQ     L560C

        STX     CRGO
.L55DA
        CMP     #$03
        BNE     L55E7

        INY
        LDX     ECM
        BNE     L560C

        DEC     ECM
.L55E7
        CMP     #$04
        BNE     L55F5

        JSR     L56B7

        LDA     #$0F
        JSR     L5709

        LDA     #$04
.L55F5
        CMP     #$05
        BNE     L5601

        JSR     L56B7

        LDA     #$8F
        JSR     L5709

.L5601
        LDY     #$6F
        CMP     #$06
        BNE     L5627

        LDX     BST
        BEQ     L5624

.L560C
        STY     K
        JSR     L56AD

        JSR     MCASH

        LDA     K
        JSR     spc

        LDA     #$1F
        JSR     TT27

.L561E
        JSR     dn2

        JMP     BAY

.L5624
        DEC     BST
.L5627
        INY
        CMP     #$07
        BNE     L5634

        LDX     ESCP
        BNE     L560C

        DEC     ESCP
.L5634
        INY
        CMP     #$08
        BNE     L5643

        LDX     BOMB
        BNE     L560C

        LDX     #$7F
        STX     BOMB
.L5643
        INY
        CMP     #$09
        BNE     L5650

        LDX     ENGY
        BNE     L560C

        INC     ENGY
.L5650
        INY
        CMP     #$0A
        BNE     L565D

        LDX     DKCMP
        BNE     L560C

        DEC     DKCMP
.L565D
        INY
        CMP     #$0B
        BNE     L566A

        LDX     GHYP
        BNE     L560C

        DEC     GHYP
.L566A
        INY
        CMP     #$0C
        BNE     L5677

        JSR     L56B7

        LDA     #$97
        JSR     L5709

.L5677
        INY
        CMP     #$0D
        BNE     L5684

        JSR     L56B7

        LDA     #$32
        JSR     L5709

.L5684
        JSR     dn

        JMP     L552B

.dn
        JSR     TT162

        LDA     #$77
        JSR     spc

.dn2
        JSR     BEEP

        LDY     #$19
        JMP     DELAY

.L569A
        JSR     L56AD

        JSR     LCASH

        BCS     L56B6

        LDA     #$C5
        JSR     prq

        JMP     L561E

.L56AA
        SEC
        SBC     #$01
.L56AD
        ASL     A
        TAY
        LDX     L5735,Y
        LDA     L5736,Y
        TAY
.L56B6
        RTS

.L56B7
        LDA     L1297
        CMP     #$08
        BCC     L56C3

        LDA     #$20
        JSR     TT66

.L56C3
        LDA     #$10
        TAY
        STA     YC
.L56C8
        LDA     #$0C
        STA     XC
        TYA
        CLC
        ADC     #$20
        JSR     spc

        LDA     YC
        CLC
        ADC     #$50
        JSR     TT27

        INC     YC
        LDY     YC
        CPY     #$14
        BCC     L56C8

        JSR     CLYNS

.L56E6
        LDA     #$AF
        JSR     prq

        JSR     TT217

        SEC
        SBC     #$30
        CMP     #$04
        BCC     L56FB

        JSR     CLYNS

        JMP     L56E6

.L56FB
        TAX
        RTS

.hm
        JSR     TT103

        JSR     TT111

        JSR     TT103

        JMP     CLYNS

.L5709
        STA     T1
        LDA     LASER,X
        BEQ     L572F

        LDY     #$04
        CMP     #$0F
        BEQ     L5724

        LDY     #$05
        CMP     #$8F
        BEQ     L5724

        LDY     #$0C
        CMP     #$97
        BEQ     L5724

        LDY     #$0D
.L5724
        STX     ZZ
        TYA
        JSR     L56AD

        JSR     MCASH

        LDX     ZZ
.L572F
        LDA     T1
        STA     LASER,X
        RTS

.L5735
        EQUB    $01

.L5736
        EQUB    $00,$2C,$01,$A0,$0F,$70,$17,$A0
        EQUB    $0F,$10,$27,$82,$14,$10,$27,$28
        EQUB    $23,$98,$3A,$10,$27,$50,$C3,$60
        EQUB    $EA,$40,$1F

.cpl
        LDX     #$05
.L5753
        LDA     QQ15,X
        STA     QQ19,X
        DEX
        BPL     L5753

        LDY     #$03
        BIT     QQ15
        BVS     L5761

        DEY
.L5761
        STY     T
.L5763
        LDA     L0063
        AND     #$1F
        BEQ     L576E

        ORA     #$80
        JSR     TT27

.L576E
        JSR     TT54

        DEC     T
        BPL     L5763

        LDX     #$05
.L5777
        LDA     QQ19,X
        STA     QQ15,X
        DEX
        BPL     L5777

        RTS

.L577F
        LDY     #$00
.L5781
        LDA     L122C,Y
        CMP     #$0D
        BEQ     L578E

        JSR     DASC

        INY
        BNE     L5781

.L578E
        RTS

.L578F
        BIT     MJ
        BMI     L57A9

        JSR     L579A

        JSR     cpl

.L579A
        LDX     #$05
.L579C
        LDA     QQ15,X
        LDY     L129A,X
        STA     L129A,X
        STY     QQ15,X
        DEX
        BPL     L579C

.L57A9
        RTS

.L57AA
        CLC
        LDX     GCNT
        INX
        JMP     pr2

.fwl
        LDA     #$69
        JSR     TT68

        LDX     QQ14
        SEC
        JSR     pr2

        LDA     #$C3
        JSR     plf

        LDA     #$77
        BNE     TT27

.L57C7
        LDX     #$03
.L57C9
        LDA     L123D,X
        STA     K,X
        DEX
        BPL     L57C9

        LDA     #$09
        STA     U
        SEC
        JSR     BPRNT

        LDA     #$E2
.plf
        JSR     TT27

        JMP     L4AE0

.TT68
        JSR     TT27

.L57E4
        LDA     #$3A
.TT27
        TAX
        BEQ     L57C7

        BMI     L5861

        DEX
        BEQ     L57AA

        DEX
        BEQ     L578F

        DEX
        BNE     L57F7

        JMP     cpl

.L57F7
        DEX
        BEQ     L577F

        DEX
        BEQ     fwl

        DEX
        BNE     L5805

        LDA     #$80
        STA     QQ17
        RTS

.L5805
        DEX
        DEX
        BNE     L580C

        STX     QQ17
        RTS

.L580C
        DEX
        BEQ     L5847

        CMP     #$60
        BCS     ex

        CMP     #$0E
        BCC     L581B

        CMP     #$20
        BCC     L5843

.L581B
        LDX     QQ17
        BEQ     L585E

        BMI     L5832

        BIT     QQ17
        BVS     L5857

.L5825
        CMP     #$41
        BCC     L582F

        CMP     #$5B
        BCS     L582F

        ADC     #$20
.L582F
        JMP     DASC

.L5832
        BIT     QQ17
        BVS     L584F

        CMP     #$41
        BCC     L585E

        PHA
        TXA
        ORA     #$40
        STA     QQ17
        PLA
        BNE     L582F

.L5843
        ADC     #$72
        BNE     ex

.L5847
        LDA     #$15
        JSR     DOXC

        JMP     L57E4

.L584F
        CPX     #$FF
        BEQ     L58B6

        CMP     #$41
        BCS     L5825

.L5857
        PHA
        TXA
        AND     #$BF
        STA     QQ17
        PLA
.L585E
        JMP     DASC

.L5861
        CMP     #$A0
        BCS     L5879

        AND     #$7F
        ASL     A
        TAY
        LDA     QQ16,Y
        JSR     TT27

        LDA     L3424,Y
        CMP     #$3F
        BEQ     L58B6

        JMP     TT27

.L5879
        SBC     #$A0
.ex
        TAX
        LDA     #$00
        STA     V
        LDA     #$A0
        STA     L003B
        LDY     #$00
        TXA
        BEQ     L589C

.L5889
        LDA     (V),Y
        BEQ     L5894

        INY
        BNE     L5889

        INC     L003B
        BNE     L5889

.L5894
        INY
        BNE     L5899

        INC     L003B
.L5899
        DEX
        BNE     L5889

.L589C
        TYA
        PHA
        LDA     L003B
        PHA
        LDA     (V),Y
        EOR     #$23
        JSR     TT27

        PLA
        STA     L003B
        PLA
        TAY
        INY
        BNE     L58B2

        INC     L003B
.L58B2
        LDA     (V),Y
        BNE     L589C

.L58B6
        RTS

        LDX     #$15
.L58B9
        LDA     L0000,X
        LDY     L0000,X
        STA     L0000,X
        STY     L0000,X
        INX
        BNE     L58B9

        RTS

.L58C5
        LDA     L00BB
        ORA     #$A0
        STA     L00BB
        RTS

.DOEXP
        LDA     L00BB
        AND     #$40
        BEQ     L58D5

        JSR     L5932

.L58D5
        LDA     L00A2
        STA     T
        LDA     L00A3
        CMP     #$20
        BCC     L58E3

        LDA     #$FE
        BNE     L58EB

.L58E3
        ASL     T
        ROL     A
        ASL     T
        ROL     A
        SEC
        ROL     A
.L58EB
        STA     Q
        LDY     #$01
        LDA     (XX19),Y
        STA     L12A6
        ADC     #$04
        BCS     L58C5

        STA     (XX19),Y
        JSR     DVID4

        LDA     P
        CMP     #$1C
        BCC     L5907

        LDA     #$FE
        BNE     L5910

.L5907
        ASL     R
        ROL     A
        ASL     R
        ROL     A
        ASL     R
        ROL     A
.L5910
        DEY
        STA     (XX19),Y
        LDA     L00BB
        AND     #$BF
        STA     L00BB
        AND     #$08
        BEQ     L58B6

        LDY     #$02
        LDA     (XX19),Y
        TAY
.L5922
        LDA     L00F9,Y
        STA     (XX19),Y
        DEY
        CPY     #$06
        BNE     L5922

        LDA     L00BB
        ORA     #$40
        STA     L00BB
.L5932
        LDY     #$00
        LDA     (XX19),Y
        STA     Q
        INY
        LDA     (XX19),Y
        BPL     L593F

        EOR     #$FF
.L593F
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        ORA     #$01
        STA     U
        INY
        LDA     (XX19),Y
        STA     L0088
        LDA     L0003
        PHA
        LDY     #$06
.L5951
        LDX     #$03
.L5953
        INY
        LDA     (XX19),Y
        STA     K3,X
        DEX
        BPL     L5953

        STY     CNT
        LDY     #$02
.L595F
        INY
        LDA     (XX19),Y
        EOR     CNT
        STA     LFFFF,Y
        CPY     #$06
        BNE     L595F

        LDY     U
        STY     CNT2
.L596F
        CLC
        LDA     RAND
        ROL     A
        TAX
        ADC     L0004
        STA     RAND
        STX     L0004
        LDA     L0003
        TAX
        ADC     L0005
        STA     L0003
        STX     L0005
        STA     ZZ
        AND     #$03
        TAX
        LDA     L5A0D,X
        STA     COL
        LDA     L0015
        STA     R
        LDA     K3
        JSR     L59D8

        BNE     L59C1

        CPX     #$BF
        BCS     L59C1

        STX     Y1
        LDA     L0017
        STA     R
        LDA     L0016
        JSR     L59D8

        BNE     L59AE

        LDA     Y1
        JSR     PIXEL

.L59AE
        DEC     CNT2
        BPL     L596F

        LDY     CNT
        CPY     L0088
        BCC     L5951

        PLA
        STA     L0003
        LDA     L0406
        STA     L0005
        RTS

.L59C1
        CLC
        LDA     RAND
        ROL     A
        TAX
        ADC     L0004
        STA     RAND
        STX     L0004
        LDA     L0003
        TAX
        ADC     L0005
        STA     L0003
        STX     L0005
        JMP     L59AE

.L59D8
        STA     S
        CLC
        LDA     RAND
        ROL     A
        TAX
        ADC     L0004
        STA     RAND
        STX     L0004
        LDA     L0003
        TAX
        ADC     L0005
        STA     L0003
        STX     L0005
        ROL     A
        BCS     L59FC

        JSR     FMLTU

        ADC     R
        TAX
        LDA     S
        ADC     #$00
        RTS

.L59FC
        JSR     FMLTU

        STA     T
        LDA     R
        SBC     T
        TAX
        LDA     S
        SBC     #$00
        RTS

        EQUB    $00

        EQUB    $02

.L5A0D
        EQUB    $0F,$F0,$0F,$FF

.SOS1
        JSR     L63AE

        LDA     #$7F
        STA     L00B9
        STA     L00BA
        LDA     L1297
        AND     #$02
        ORA     #$80
        JMP     NWSHP

.L5A24
        LDA     L1264
        BEQ     SOLAR

        LDA     #$00
        STA     QQ20
        STA     L1251
        JSR     DORND

        AND     #$0F
        ADC     L1264
        ORA     #$04
        ROL     A
        STA     L1264
        ROL     L1265
        BPL     SOLAR

        ROR     L1265
.SOLAR
        LSR     FIST
        JSR     ZINF

        LDA     L005F
        AND     #$03
        ADC     #$03
        STA     L00A4
        ROR     A
        STA     L009E
        STA     L00A1
        JSR     SOS1

        LDA     L0061
        AND     #$07
        ORA     #$81
        STA     L00A4
        LDA     L0063
        AND     #$03
        STA     L009E
        STA     L009D
        LDA     #$00
        STA     L00B9
        STA     L00BA
        LDA     #$81
        JSR     NWSHP

.NWSTARS
        LDA     QQ11
        BNE     WPSHPS

.L5A7C
        LDA     #$FA
        STA     COL
        LDY     NOSTM
.L5A82
        JSR     DORND

        ORA     #$08
        STA     SZ,Y
        STA     ZZ
        JSR     DORND

        STA     SX,Y
        STA     XX15
        JSR     DORND

        STA     SY,Y
        STA     Y1
        JSR     PIXEL2

        DEY
        BNE     L5A82

.WPSHPS
        LDX     #$00
.L5AA4
        LDA     FRIN,X
        BEQ     L5ACC

        BMI     L5AC9

        STA     TYPE
        JSR     GINF

        LDY     #$1F
.L5AB2
        LDA     (INF),Y
        STA     INWK,Y
        DEY
        BPL     L5AB2

        STX     XSAV
        JSR     SCAN

        LDX     XSAV
        LDY     #$1F
        LDA     (INF),Y
        AND     #$A7
        STA     (INF),Y
.L5AC9
        INX
        BNE     L5AA4

.L5ACC
        LDX     #$00
        STX     LSP
        DEX
        STX     LSX2
        STX     LSY2
.FLFLLS
        LDY     #$C7
        LDA     #$00
.L5ADB
        STA     LSO,Y
        DEY
        BNE     L5ADB

        DEY
        STY     L00D4
        RTS

.L5AE5
        LDA     #$06
        SEI
        STA     VIA
        STX     LFE01
        CLI
        RTS

.L5AF0
        DEX
        RTS

.SHD
        INX
        BEQ     L5AF0

.DENGY
        DEC     ENERGY
        PHP
        BNE     L5AFC

        INC     ENERGY
.L5AFC
        PLP
        RTS

.L5AFE
        JSR     DOT

        LDA     SSPR
        BNE     L5B37

        JSR     SPS1

        JMP     L5B3A

.L5B0C
        ASL     A
        TAX
        LDA     #$00
        ROR     A
        TAY
        LDA     #$14
        STA     Q
        TXA
        JSR     DVID4

        LDX     P
        TYA
        BMI     L5B22

        LDY     #$00
        RTS

.L5B22
        LDY     #$FF
        TXA
        EOR     #$FF
        TAX
        INX
        RTS

.L5B2A
        LDX     #$08
.L5B2C
        LDA     L0425,X
        STA     K3,X
        DEX
        BPL     L5B2C

        JMP     TAS2

.L5B37
        JSR     L5B2A

.L5B3A
        LDA     XX15
        JSR     L5B0C

        TXA
        ADC     #$C3
        STA     COMX
        LDA     Y1
        JSR     L5B0C

        STX     T
        LDA     #$CC
        SBC     T
        STA     COMY
        LDA     #$0F
        LDX     X2
        BPL     L5B5B

        LDA     #$0C
.L5B5B
        STA     COMC
        JMP     DOT

.OOPS
        STA     T
        LDX     #$00
        LDY     #$08
        LDA     (INF),Y
        BMI     L5B7A

        LDA     FSH
        SBC     T
        BCC     L5B74

        STA     FSH
        RTS

.L5B74
        LDX     #$00
        STX     FSH
        BCC     L5B87

.L5B7A
        LDA     ASH
        SBC     T
        BCC     L5B83

        STA     ASH
        RTS

.L5B83
        LDX     #$00
        STX     ASH
.L5B87
        ADC     ENERGY
        STA     ENERGY
        BEQ     L5B8F

        BCS     L5B92

.L5B8F
        JMP     DEATH

.L5B92
        JSR     EXNO3

        JMP     L6E32

.L5B98
        LDA     L0401,X
        STA     K3,X
        LDA     L0402,X
        TAY
        AND     #$7F
        STA     L0015,X
        TYA
        AND     #$80
        STA     L0016,X
        RTS

.NWSPS
        JSR     SPBLB

        LDX     #$81
        STX     L00BC
        LDX     #$00
        STX     L00BA
        STX     NEWB
        STX     L0E42
        DEX
        STX     L00B9
        LDX     #$0A
        JSR     L5C8A

        JSR     L5C8A

        JSR     L5C8A

        LDA     L6760
        STA     L8002
        LDA     L6761
        STA     L8003
        LDA     L1297
        CMP     #$0A
        BCC     L5BE8

        LDA     L8040
        STA     L8002
        LDA     L8041
        STA     L8003
.L5BE8
        LDA     #$7E
        STA     XX19
        LDA     #$10
        STA     L00BE
        LDA     #$02
.NWSHP
        STA     T
        LDX     #$00
.L5BF6
        LDA     FRIN,X
        BEQ     L5C02

        INX
        CPX     #$0C
        BCC     L5BF6

.L5C00
        CLC
.L5C01
        RTS

.L5C02
        JSR     GINF

        LDA     T
        BMI     L5C5B

        ASL     A
        TAY
        LDA     L7FFF,Y
        BEQ     L5C00

        STA     L0037
        LDA     L7FFE,Y
        STA     XX0
        CPY     #$04
        BEQ     L5C4B

        LDY     #$05
        LDA     (XX0),Y
        STA     T1
        LDA     L1298
        SEC
        SBC     T1
        STA     XX19
        LDA     L1299
        SBC     #$00
        STA     L00BE
        LDA     XX19
        SBC     INF
        TAY
        LDA     L00BE
        SBC     L0039
        BCC     L5C01

        BNE     L5C41

        CPY     #$25
        BCC     L5C01

.L5C41
        LDA     XX19
        STA     L1298
        LDA     L00BE
        STA     L1299
.L5C4B
        LDY     #$0E
        LDA     (XX0),Y
        STA     L00BF
        LDY     #$13
        LDA     (XX0),Y
        AND     #$07
        STA     L00BB
        LDA     T
.L5C5B
        STA     FRIN,X
        TAX
        BMI     L5C73

        CPX     #$0F
        BEQ     L5C6D

        CPX     #$03
        BCC     L5C70

        CPX     #$0B
        BCS     L5C70

.L5C6D
        INC     JUNK
.L5C70
        INC     MANY,X
.L5C73
        LDY     T
        LDA     L8041,Y
        AND     #$6F
        ORA     NEWB
        STA     NEWB
        LDY     #$24
.L5C80
        LDA     INWK,Y
        STA     (INF),Y
        DEY
        BPL     L5C80

        SEC
        RTS

.L5C8A
        LDA     INWK,X
        EOR     #$80
        STA     INWK,X
        INX
        INX
        RTS

.ABORT
        LDX     #$FF
.ABORT2
        STX     MSTG
        LDX     NOMSL
        JSR     MSBAR

        STY     MSAR
        RTS

        TSB     L0000
        BRK
        EQUB    $00

        BRK
.L5CA6
        EQUB    $A5

        STZ     L0C85
        LDA     L009D
        STA     L000D
        LDA     L009E
        JSR     L614F

        BCS     L5CDD

        LDA     K
        ADC     #$80
        STA     K3
        TXA
        ADC     #$00
        STA     L0015
        LDA     L009F
        STA     P
        LDA     L00A0
        STA     L000D
        LDA     L00A1
        EOR     #$80
        JSR     L614F

        BCS     L5CDD

        LDA     K
        ADC     #$60
        STA     K4
        TXA
        ADC     #$00
        STA     L0023
        CLC
.L5CDD
        RTS

.L5CDE
        LDA     TYPE
        LSR     A
        BCS     L5CE6

        JMP     L6043

.L5CE6
        JMP     WPLS

.PLANET
        LDA     #$AF
        STA     COL
        LDA     L00A4
        CMP     #$30
        BCS     L5CDE

        ORA     L00A3
        BEQ     L5CDE

        JSR     L5CA6

        BCS     L5CDE

        LDA     #$60
        STA     L000D
        LDA     #$00
        STA     P
        JSR     DVID3B2

        LDA     L0057
        BEQ     L5D0F

        LDA     #$F8
        STA     K
.L5D0F
        LDA     TYPE
        LSR     A
        BCC     L5D17

        JMP     SUN

.L5D17
        JSR     L6043

        JSR     L5FCC

        BCS     L5D23

        LDA     L0057
        BEQ     L5D24

.L5D23
        RTS

.L5D24
        LDA     TYPE
        CMP     #$80
        BNE     L5D66

        LDA     K
        CMP     #$06
        BCC     L5D23

        LDA     L00AA
        EOR     #$80
        STA     P
        LDA     L00B0
        JSR     L6130

        LDX     #$09
        JSR     L5DBC

        STA     L0093
        STY     XX16
        JSR     L5DBC

        STA     L0094
        STY     L0025
        LDX     #$0F
        JSR     L6140

        JSR     L5DDA

        LDA     L00AA
        EOR     #$80
        STA     P
        LDA     L00B6
        JSR     L6130

        LDX     #$15
        JSR     L6140

        JMP     L5DDA

.L5D66
        LDA     L00B0
        BMI     L5D23

        LDX     #$0F
        JSR     L610F

        CLC
        ADC     K3
        STA     K3
        TYA
        ADC     L0015
        STA     L0015
        JSR     L610F

        STA     P
        LDA     K4
        SEC
        SBC     P
        STA     K4
        STY     P
        LDA     L0023
        SBC     P
        STA     L0023
        LDX     #$09
        JSR     L5DBC

        LSR     A
        STA     L0093
        STY     XX16
        JSR     L5DBC

        LSR     A
        STA     L0094
        STY     L0025
        LDX     #$15
        JSR     L5DBC

        LSR     A
        STA     L0095
        STY     L0026
        JSR     L5DBC

        LSR     A
        STA     L0096
        STY     L0027
        LDA     #$40
        STA     L0088
        LDA     #$00
        STA     CNT2
        JMP     L5DDE

.L5DBC
        LDA     INWK,X
        STA     P
        LDA     L009D,X
        AND     #$7F
        STA     L000D
        LDA     L009D,X
        AND     #$80
        JSR     DVID3B2

        LDA     K
        LDY     L0057
        BEQ     L5DD5

        LDA     #$FE
.L5DD5
        LDY     L0059
        INX
        INX
        RTS

.L5DDA
        LDA     #$1F
        STA     L0088
.L5DDE
        LDX     #$00
        STX     CNT
        DEX
        STX     FLAG
.L5DE5
        LDA     CNT2
        AND     #$1F
        TAX
        LDA     SNE,X
        STA     Q
        LDA     L0095
        JSR     FMLTU

        STA     R
        LDA     L0096
        JSR     FMLTU

        STA     K
        LDX     CNT2
        CPX     #$21
        LDA     #$00
        ROR     A
        STA     L0029
        LDA     CNT2
        CLC
        ADC     #$10
        AND     #$1F
        TAX
        LDA     SNE,X
        STA     Q
        LDA     L0094
        JSR     FMLTU

        STA     L0058
        LDA     L0093
        JSR     FMLTU

        STA     P
        LDA     CNT2
        ADC     #$0F
        AND     #$3F
        CMP     #$21
        LDA     #$00
        ROR     A
        STA     L0028
        LDA     L0029
        EOR     L0026
        STA     S
        LDA     L0028
        EOR     XX16
        JSR     ADD

        STA     T
        BPL     L5E4E

        TXA
        EOR     #$FF
        CLC
        ADC     #$01
        TAX
        LDA     T
        EOR     #$7F
        ADC     #$00
        STA     T
.L5E4E
        TXA
        ADC     K3
        STA     K6
        LDA     T
        ADC     L0015
        STA     L0069
        LDA     K
        STA     R
        LDA     L0029
        EOR     L0027
        STA     S
        LDA     L0058
        STA     P
        LDA     L0028
        EOR     L0025
        JSR     ADD

        EOR     #$80
        STA     T
        BPL     L5E83

        TXA
        EOR     #$FF
        CLC
        ADC     #$01
        TAX
        LDA     T
        EOR     #$7F
        ADC     #$00
        STA     T
.L5E83
        JSR     BLINE

        CMP     L0088
        BEQ     L5E8C

        BCS     L5E98

.L5E8C
        LDA     CNT2
        CLC
        ADC     STP
        AND     #$3F
        STA     CNT2
        JMP     L5DE5

.L5E98
        RTS

.L5E99
        JMP     WPLS

.L5E9C
        TXA
        EOR     #$FF
        CLC
        ADC     #$01
        TAX
.L5EA3
        LDA     #$FF
        BNE     L5EEF

.SUN
        LDA     #$F0
        STA     COL
        LDA     #$01
        STA     L00D4
        JSR     L60D5

        BCS     L5E99

        LDA     #$00
        LDX     K
        CPX     #$60
        ROL     A
        CPX     #$28
        ROL     A
        CPX     #$10
        ROL     A
        STA     CNT
        LDA     L0099
        LDX     S_COPY
        BNE     L5ED3

        CMP     L000D
        BCC     L5ED3

        LDA     L000D
        BNE     L5ED3

        LDA     #$01
.L5ED3
        STA     L0088
        LDA     L0099
        SEC
        SBC     K4
        TAX
        LDA     #$00
        SBC     L0023
        BMI     L5E9C

        BNE     L5EEB

        INX
        DEX
        BEQ     L5EA3

        CPX     K
        BCC     L5EEF

.L5EEB
        LDX     K
        LDA     #$00
.L5EEF
        STX     V
        STA     L003B
        LDA     K
        JSR     SQUA2

        STA     L0094
        LDA     P
        STA     L0093
        LDY     L0099
        LDA     L0040
        STA     YY
        LDA     L0041
        STA     L003F
.L5F08
        CPY     L0088
        BEQ     L5F17

        LDA     LSO,Y
        BEQ     L5F14

        JSR     HLOIN2

.L5F14
        DEY
        BNE     L5F08

.L5F17
        LDA     V
        JSR     SQUA2

        STA     T
        LDA     L0093
        SEC
        SBC     P
        STA     Q
        LDA     L0094
        SBC     T
        STA     R
        STY     Y1
        JSR     LL5

        LDY     Y1
        JSR     DORND

        AND     CNT
        CLC
        ADC     Q
        BCC     L5F3E

        LDA     #$FF
.L5F3E
        LDX     LSO,Y
        STA     LSO,Y
        BEQ     L5F90

        LDA     L0040
        STA     YY
        LDA     L0041
        STA     L003F
        TXA
        JSR     EDGES

        LDA     XX15
        STA     XX
        LDA     X2
        STA     L003D
        LDA     K3
        STA     YY
        LDA     L0015
        STA     L003F
        LDA     LSO,Y
        JSR     EDGES

        BCS     L5F75

        LDA     X2
        LDX     XX
        STX     X2
        STA     XX
        JSR     HLOIN

.L5F75
        LDA     XX
        STA     XX15
        LDA     L003D
        STA     X2
.L5F7D
        JSR     HLOIN

.L5F80
        DEY
        BEQ     L5FC2

        LDA     L003B
        BNE     L5FA4

        DEC     V
        BNE     L5F17

        DEC     L003B
.L5F8D
        JMP     L5F17

.L5F90
        LDX     K3
        STX     YY
        LDX     L0015
        STX     L003F
        JSR     EDGES

        BCC     L5F7D

        LDA     #$00
        STA     LSO,Y
        BEQ     L5F80

.L5FA4
        LDX     V
        INX
        STX     V
        CPX     K
        BCC     L5F8D

        BEQ     L5F8D

        LDA     L0040
        STA     YY
        LDA     L0041
        STA     L003F
.L5FB7
        LDA     LSO,Y
        BEQ     L5FBF

        JSR     HLOIN2

.L5FBF
        DEY
        BNE     L5FB7

.L5FC2
        CLC
        LDA     K3
        STA     L0040
        LDA     L0015
        STA     L0041
.L5FCB
        RTS

.L5FCC
        JSR     L60D5

        BCS     L5FCB

        LDA     #$00
        STA     LSX2
        LDX     K
        LDA     #$08
        CPX     #$08
        BCC     L5FE4

        LSR     A
        CPX     #$3C
        BCC     L5FE4

        LSR     A
.L5FE4
        STA     STP
.CIRCLE2
        LDX     #$FF
        STX     FLAG
        INX
        STX     CNT
.L5FED
        LDA     CNT
        JSR     FMLTU2

        LDX     #$00
        STX     T
        LDX     CNT
        CPX     #$21
        BCC     L6009

        EOR     #$FF
        ADC     #$00
        TAX
        LDA     #$FF
        ADC     #$00
        STA     T
        TXA
        CLC
.L6009
        ADC     K3
        STA     K6
        LDA     L0015
        ADC     T
        STA     L0069
        LDA     CNT
        CLC
        ADC     #$10
        JSR     FMLTU2

        TAX
        LDA     #$00
        STA     T
        LDA     CNT
        ADC     #$0F
        AND     #$3F
        CMP     #$21
        BCC     L6037

        TXA
        EOR     #$FF
        ADC     #$00
        TAX
        LDA     #$FF
        ADC     #$00
        STA     T
        CLC
.L6037
        JSR     BLINE

        CMP     #$41
        BCS     L6041

        JMP     L5FED

.L6041
        CLC
        RTS

.L6043
        LDY     LSX2
        BNE     L607D

.L6048
        CPY     LSP
        BCS     L607D

        LDA     LSY2,Y
        CMP     #$FF
        BEQ     L606E

        STA     Y2
        LDA     LSX2,Y
        STA     X2
        JSR     LL30

        INY
        LDA     SWAP
        BNE     L6048

        LDA     X2
        STA     XX15
        LDA     Y2
        STA     Y1
        JMP     L6048

.L606E
        INY
        LDA     LSX2,Y
        STA     XX15
        LDA     LSY2,Y
        STA     Y1
        INY
        JMP     L6048

.L607D
        LDA     #$01
        STA     LSP
        LDA     #$FF
        STA     LSX2
.L6086
        RTS

.WPLS
        LDA     L00D4
        BMI     L6086

        LDA     L0040
        STA     YY
        LDA     L0041
        STA     L003F
        LDY     #$BF
.L6095
        LDA     LSO,Y
        BEQ     L609D

        JSR     HLOIN2

.L609D
        DEY
        BNE     L6095

        DEY
        STY     L00D4
        RTS

.EDGES
        STA     T
        CLC
        ADC     YY
        STA     X2
        LDA     L003F
        ADC     #$00
        BMI     L60CE

        BEQ     L60B7

        LDA     #$FF
        STA     X2
.L60B7
        LDA     YY
        SEC
        SBC     T
        STA     XX15
        LDA     L003F
        SBC     #$00
        BNE     L60C6

        CLC
        RTS

.L60C6
        BPL     L60CE

        LDA     #$00
        STA     XX15
        CLC
        RTS

.L60CE
        LDA     #$00
        STA     LSO,Y
        SEC
        RTS

.L60D5
        LDA     K3
        CLC
        ADC     K
        LDA     L0015
        ADC     #$00
        BMI     L610D

        LDA     K3
        SEC
        SBC     K
        LDA     L0015
        SBC     #$00
        BMI     L60ED

        BNE     L610D

.L60ED
        LDA     K4
        CLC
        ADC     K
        STA     L000D
        LDA     L0023
        ADC     #$00
        BMI     L610D

        STA     S_COPY
        LDA     K4
        SEC
        SBC     K
        TAX
        LDA     L0023
        SBC     #$00
        BMI     L6172

        BNE     L610D

        CPX     L0099
        RTS

.L610D
        SEC
        RTS

.L610F
        JSR     L5DBC

        STA     P
        LDA     #$DE
        STA     Q
        STX     U
        JSR     MULTU

        LDX     U
        LDY     L0059
        BPL     L612D

        EOR     #$FF
        CLC
        ADC     #$01
        BEQ     L612D

        LDY     #$FF
        RTS

.L612D
        LDY     #$00
        RTS

.L6130
        STA     Q
        JSR     ARCTAN

        LDX     L00AA
        BMI     L613B

        EOR     #$80
.L613B
        LSR     A
        LSR     A
        STA     CNT2
        RTS

.L6140
        JSR     L5DBC

        STA     L0095
        STY     L0026
        JSR     L5DBC

        STA     L0096
        STY     L0027
        RTS

.L614F
        JSR     DVID3B2

        LDA     L0059
        AND     #$7F
        ORA     L0058
        BNE     L610D

        LDX     L0057
        CPX     #$04
        BCS     L6173

        LDA     L0059
        BPL     L6173

        LDA     K
        EOR     #$FF
        ADC     #$01
        STA     K
        TXA
        EOR     #$FF
        ADC     #$00
        TAX
.L6172
        CLC
.L6173
        RTS

.L6174
        JSR     L6DB4

        CMP     #$59
        BEQ     L6173

        CMP     #$4E
        BNE     L6174

        CLC
        RTS

.L6181
        LDA     QQ11
        BNE     L618A

        JSR     L6C90

        TXA
        RTS

.L618A
        JSR     L6C90

        LDA     L2C5C
        BEQ     L61A3

        LDA     JSTY
        JSR     L61D4

        TAY
        LDA     JSTX
        EOR     #$FF
        JSR     L61D4

        TAX
        LDA     L00C3
        RTS

.L61A3
        LDA     L00C3
        LDX     #$00
        LDY     #$00
        CMP     #$8C
        BNE     L61AE

        DEX
.L61AE
        CMP     #$8D
        BNE     L61B3

        INX
.L61B3
        CMP     #$8E
        BNE     L61B8

        DEY
.L61B8
        CMP     #$8F
        BNE     L61BD

        INY
.L61BD
        PHX
        LDA     #$00
        JSR     DKS4

        BMI     L61C9

        PLX
        LDA     L00C3
        RTS

.L61C9
        PLA
        ASL     A
        ASL     A
        TAX
        TYA
        ASL     A
        ASL     A
        TAY
        LDA     L00C3
        RTS

.L61D4
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        ADC     #$00
        SBC     #$03
        RTS

.L61DE
        LDA     P
        STA     L1298
        LDA     L000D
        STA     L1299
        RTS

.KS1
        LDX     XSAV
        JSR     L6242

        LDX     XSAV
        JMP     MAL1

.L61F3
        JSR     ZINF

        JSR     FLFLLS

        STA     L0E42
        STA     SSPR
        JSR     SPBLB

        LDA     #$06
        STA     L00A1
        LDA     #$81
        JMP     NWSHP

.L620B
        LDX     #$FF
.L620D
        INX
        LDA     FRIN,X
        BEQ     L61DE

        CMP     #$01
        BNE     L620D

        TXA
        ASL     A
        TAY
        LDA     UNIV,Y
        STA     SC
        LDA     L357A,Y
        STA     L000B
        LDY     #$20
        LDA     (SC),Y
        BPL     L620D

        AND     #$7F
        LSR     A
        CMP     XX4
        BCC     L620D

        BEQ     L623C

        SBC     #$01
        ASL     A
        ORA     #$80
        STA     (SC),Y
        BNE     L620D

.L623C
        LDA     #$00
        STA     (SC),Y
        BEQ     L620D

.L6242
        STX     XX4
        LDA     MSTG
        CMP     XX4
        BNE     L6254

        LDY     #$0C
        JSR     ABORT

        LDA     #$C8
        JSR     MESS

.L6254
        LDY     XX4
        LDX     FRIN,Y
        CPX     #$02
        BEQ     L61F3

        CPX     #$1F
        BNE     L626C

        LDA     TP
        ORA     #$02
        STA     TP
        INC     L127C
.L626C
        CPX     #$0F
        BEQ     L6278

        CPX     #$03
        BCC     L627B

        CPX     #$0B
        BCS     L627B

.L6278
        DEC     JUNK
.L627B
        DEC     MANY,X
        LDX     XX4
        LDY     #$05
        LDA     (XX0),Y
        LDY     #$21
        CLC
        ADC     (INF),Y
        STA     P
        INY
        LDA     (INF),Y
        ADC     #$00
        STA     L000D
.L6292
        INX
        LDA     FRIN,X
        STA     L0E40,X
        BNE     L629E

        JMP     L620B

.L629E
        ASL     A
        TAY
        LDA     L7FFE,Y
        STA     SC
        LDA     L7FFF,Y
        STA     L000B
        LDY     #$05
        LDA     (SC),Y
        STA     T
        LDA     P
        SEC
        SBC     T
        STA     P
        LDA     L000D
        SBC     #$00
        STA     L000D
        TXA
        ASL     A
        TAY
        LDA     UNIV,Y
        STA     SC
        LDA     L357A,Y
        STA     L000B
        LDY     #$24
        LDA     (SC),Y
        STA     (INF),Y
        DEY
        LDA     (SC),Y
        STA     (INF),Y
        DEY
        LDA     (SC),Y
        STA     L0057
        LDA     L000D
        STA     (INF),Y
        DEY
        LDA     (SC),Y
        STA     K
        LDA     P
        STA     (INF),Y
        DEY
.L62E8
        LDA     (SC),Y
        STA     (INF),Y
        DEY
        BPL     L62E8

        LDA     SC
        STA     INF
        LDA     L000B
        STA     L0039
        LDY     T
.L62F9
        DEY
        LDA     (K),Y
        STA     (P),Y
        TYA
        BNE     L62F9

        BEQ     L6292

.L6303
        LDX     GCNT
        DEX
        BNE     L6317

        LDA     QQ0
        CMP     #$90
        BNE     L6317

        LDA     QQ1
        CMP     #$21
        BEQ     L6318

.L6317
        CLC
.L6318
        RTS

        PHA
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        JSR     L6324

        PLA
        AND     #$0F
.L6324
        CMP     #$0A
        BCS     L632D

        ADC     #$30
        JMP     TT26

.L632D
        ADC     #$36
        JMP     TT26

.L6332
        JSR     ZERO

        LDX     #$06
.L6337
        STA     BETA,X
        DEX
        BPL     L6337

        STX     L2C5A
        TXA
        STA     QQ12
        LDX     #$02
.L6344
        STA     FSH,X
        DEX
        BPL     L6344

.RES2
        LDA     #$14
        STA     NOSTM
        LDX     #$FF
        STX     LSX2
        STX     LSY2
        STX     MSTG
        LDA     #$80
        STA     JSTY
        STA     ALP2
        STA     BET2
        ASL     A
        STA     BETA
        STA     BET1
        STA     L0049
        STA     L0074
        STA     MCNT
        LDA     #$03
        STA     DELTA
        STA     ALPHA
        STA     ALP1
        LDA     #$00
        STA     L0098
        LDA     #$BF
        STA     L0099
        LDA     SSPR
        BEQ     L6382

        JSR     SPBLB

.L6382
        LDA     ECMA
        BEQ     L6389

        JSR     ECMOF

.L6389
        JSR     WPSHPS

        JSR     ZERO

        LDA     #$00
        STA     L1298
        LDA     #$08
        STA     L1299
.ZINF
        LDY     #$24
        LDA     #$00
.L639D
        STA     INWK,Y
        DEY
        BPL     L639D

        LDA     #$60
        STA     L00AE
        STA     L00B2
        ORA     #$80
        STA     L00AA
        RTS

.L63AE
        LDX     #$04
.L63B0
        CPX     NOMSL
        BEQ     L63BE

        LDY     #$00
        JSR     MSBAR

        DEX
        BNE     L63B0

        RTS

.L63BE
        LDY     #$0C
        JSR     MSBAR

        DEX
        BNE     L63BE

        RTS

.L63C7
        LDA     QQ11
        BNE     L63D9

        LDA     L1281
        JSR     MESS

        LDA     #$00
        STA     DLY
        JMP     L644C

.L63D9
        JSR     CLYNS

        JMP     L644C

.L63DF
        JSR     ZINF

        JSR     DORND

        STA     T1
        AND     #$80
        STA     L009E
        TXA
        AND     #$80
        STA     L00A1
        LDA     #$19
        STA     L009D
        STA     L00A0
        STA     L00A3
        TXA
        CMP     #$F5
        ROL     A
        ORA     #$C0
        STA     L00BC
        CLC
.DORND
        LDA     RAND
        ROL     A
        TAX
        ADC     L0004
        STA     RAND
        STX     L0004
        LDA     L0003
        TAX
        ADC     L0005
        STA     L0003
        STX     L0005
        RTS

.L6415
        JSR     DORND

        LSR     A
        STA     L00BC
        STA     L00B9
        ROL     L00BB
        AND     #$1F
        ORA     #$10
        STA     L00B7
        JSR     DORND

        BMI     L6434

        LDA     L00BC
        ORA     #$C0
        STA     L00BC
        LDX     #$10
        STX     NEWB
.L6434
        AND     #$02
        ADC     #$0B
        CMP     #$0F
        BEQ     L643F

        JSR     NWSHP

.L643F
        JSR     M%

        DEC     DLY
        BEQ     L63C7

        BPL     L644C

        INC     DLY
.L644C
        DEC     MCNT
        BEQ     L6453

.L6450
        JMP     L6579

.L6453
        LDA     MJ
        BNE     L6450

        JSR     DORND

        CMP     #$23
        BCS     L64B4

        LDA     JUNK
        CMP     #$03
        BCS     L64B4

        JSR     ZINF

        LDA     #$26
        STA     L00A3
        JSR     DORND

        STA     INWK
        STX     L009F
        AND     #$80
        STA     L009E
        TXA
        AND     #$80
        STA     L00A1
        ROL     L009D
        ROL     L009D
        JSR     DORND

        BVS     L6415

        ORA     #$6F
        STA     L00B9
        LDA     SSPR
        BNE     L64B4

        TXA
        BCS     L649A

        AND     #$1F
        ORA     #$10
        STA     L00B7
        BCC     L649E

.L649A
        ORA     #$7F
        STA     L00BA
.L649E
        JSR     DORND

        CMP     #$FC
        BCC     L64AB

        LDA     #$0F
        STA     L00BC
        BNE     L64B1

.L64AB
        CMP     #$0A
        AND     #$01
        ADC     #$05
.L64B1
        JSR     NWSHP

.L64B4
        LDA     SSPR
        BEQ     L64BC

.L64B9
        JMP     L6579

.L64BC
        JSR     L6698

        ASL     A
        LDX     L0E5E
        BEQ     L64C8

        ORA     FIST
.L64C8
        STA     T
        JSR     L63DF

        CMP     #$88
        BEQ     L654A

        CMP     T
        BCS     L64DA

        LDA     #$10
        JSR     NWSHP

.L64DA
        LDA     L0E5E
        BNE     L64B9

        DEC     L0E7B
        BPL     L64B9

        INC     L0E7B
        LDA     TP
        AND     #$0C
        CMP     #$08
        BNE     L64FA

        JSR     DORND

        CMP     #$DC
        BCC     L64FA

.L64F7
        JSR     L5416

.L64FA
        JSR     DORND

        LDY     L1296
        BEQ     L650D

        CMP     #$5A
        BCS     L64B9

        AND     #$07
        CMP     L1296
        BCC     L64B9

.L650D
        JSR     L63DF

        CMP     #$64
        BCS     L655D

        INC     L0E7B
        AND     #$03
        ADC     #$18
        TAY
        JSR     L6303

        BCC     L6532

        LDA     #$F9
        STA     L00BC
        LDA     TP
        AND     #$03
        LSR     A
        BCC     L6532

        ORA     L0E6D
        BEQ     L6542

.L6532
        LDA     #$04
        STA     NEWB
        JSR     DORND

        CMP     #$C8
        ROL     A
        ORA     #$C0
        STA     L00BC
        TYA
.L6541
        BIT     L1FA9
L6542 = L6541+1
.L6544
        JSR     NWSHP

        JMP     L6579

.L654A
        LDA     L0406
        AND     #$3E
        BNE     L64F7

        LDA     #$12
        STA     L00B7
        LDA     #$79
        STA     L00BC
        LDA     #$20
        BNE     L6544

.L655D
        AND     #$03
        STA     L0E7B
        STA     L0083
.L6564
        JSR     DORND

        STA     T
        JSR     DORND

        AND     T
        AND     #$07
        ADC     #$11
        JSR     NWSHP

        DEC     L0083
        BPL     L6564

.L6579
        LDX     #$FF
        TXS
        LDX     GNTMP
        BEQ     L6584

        DEC     GNTMP
.L6584
        LDX     LASCT
        BEQ     L6590

        DEX
        BEQ     L658D

        DEX
.L658D
        STX     LASCT
.L6590
        JSR     DIALS

        LDA     QQ11
        BEQ     L65A2

        AND     L2C58
        LSR     A
        BCS     L65A2

        LDY     #$02
        JSR     DELAY

.L65A2
        JSR     L6181

.FRCE
        JSR     L65B2

        LDA     QQ12
        BEQ     L65AF

        JMP     L6579

.L65AF
        JMP     L643F

.L65B2
        CMP     #$88
        BNE     L65B9

        JMP     STATUS

.L65B9
        CMP     #$84
        BNE     L65C0

        JMP     TT22

.L65C0
        CMP     #$85
        BNE     L65C7

        JMP     TT23

.L65C7
        CMP     #$86
        BNE     L65D1

        JSR     TT111

        JMP     TT25

.L65D1
        CMP     #$89
        BNE     L65D8

        JMP     TT213

.L65D8
        CMP     #$87
        BNE     L65DF

        JMP     L5366

.L65DF
        CMP     #$80
        BNE     L65E6

        JMP     L5495

.L65E6
        BIT     QQ12
        BPL     L660E

        CMP     #$83
        BNE     L65F1

        JMP     L552B

.L65F1
        CMP     #$81
        BNE     L65F8

        JMP     TT219

.L65F8
        CMP     #$40
        BNE     L6607

        JSR     L69D6

        BCC     L6604

        JMP     L67A1

.L6604
        JMP     BAY

.L6607
        CMP     #$82
        BNE     L6625

        JMP     TT208

.L660E
        CMP     #$81
        BEQ     L6620

        CMP     #$82
        BEQ     L661D

        CMP     #$83
        BNE     L6625

        LDX     #$03
.L661C
        BIT     L02A2
L661D = L661C+1
.L661F
        BIT     L01A2
L6620 = L661F+1
        JMP     LOOK1

.L6625
        LDA     L00C3
        CMP     #$48
        BNE     L662E

        JMP     hyp

.L662E
        CMP     #$44
        BEQ     T95

        CMP     #$46
        BNE     L6643

        LDA     QQ12
        BEQ     L667F

        LDA     QQ11
        AND     #$C0
        BEQ     L667F

        JMP     HME2

.L6643
        STA     T1
        LDA     QQ11
        AND     #$C0
        BEQ     L6661

        LDA     L0045
        BNE     L6661

        LDA     T1
        CMP     #$4F
        BNE     L665E

        JSR     TT103

        JSR     L4A11

        JMP     TT103

.L665E
        JSR     TT16

.L6661
        LDA     L0045
        BEQ     L667F

        DEC     QQ22
        BNE     L667F

        LDX     L0045
        DEX
        JSR     L52A5

        LDA     #$05
        STA     QQ22
        LDX     L0045
        JSR     L52A5

        DEC     L0045
        BNE     L667F

        JMP     L5457

.L667F
        RTS

.T95
        LDA     QQ11
        AND     #$C0
        BEQ     L667F

        JSR     hm

        JSR     cpl

        LDA     #$80
        STA     QQ17
        LDA     #$0C
        JSR     DASC

        JMP     TT146

.L6698
        LDA     L124E
        CLC
        ADC     L1251
        ASL     A
        ADC     L1255
        RTS

.FAROF
        LDA     #$E0
.FAROF2
        CMP     L009D
        BCC     L66B0

        CMP     L00A0
        BCC     L66B0

        CMP     L00A3
.L66B0
        RTS

.MAS4
        ORA     L009D
        ORA     L00A0
        ORA     L00A3
        RTS

.L66B8
        EQUB    $FF

.BRBR
        LDX     L66B8
        TXS
        JSR     MASTER_SWAP_ZP_3000

        STZ     CATF
        LDY     #$00
        LDA     #$07
.L66C7
        JSR     TT26

        INY
        LDA     (L00FD),Y
        BNE     L66C7

        JSR     L6DB4

        JMP     L69D6

.DEATH
        LDY     #$04
        JSR     NOISE

        JSR     RES2

        ASL     DELTA
        ASL     DELTA
        LDX     #$18
        JSR     L5AE5

        LDA     #$0D
        JSR     TT66

        STZ     QQ11
        JSR     BOX

        JSR     L5A7C

        LDA     #$FF
        STA     COL
        LDA     #$0C
        STA     XC
        STA     YC
        LDA     #$92
        JSR     ex

.L6702
        JSR     L63DF

        LSR     A
        LSR     A
        STA     INWK
        LDY     #$00
        STY     L009D
        STY     L00A0
        STY     L00A3
        STY     L00BC
        DEY
        STY     MCNT
        EOR     #$2A
        STA     L009F
        ORA     #$50
        STA     L00A2
        TXA
        AND     #$8F
        STA     L00B9
        LDY     #$40
        STY     LASCT
        SEC
        ROR     A
        AND     #$87
        STA     L00BA
        LDX     #$05
        LDA     L8007
        BEQ     L6738

        BCC     L6738

        DEX
.L6738
        JSR     fq1

        JSR     DORND

        AND     #$80
        LDY     #$1F
        STA     (INF),Y
        LDA     L0E45
        BEQ     L6702

        LDA     #$00
        STA     DELTA
        JSR     M%

.L6750
        JSR     M%

        DEC     LASCT
        BNE     L6750

        LDX     #$1F
        JSR     L5AE5

        JMP     L6781

.L6760
        DEY
.L6761
        DEY
.BEGIN
        LDX     #$1E
        LDA     #$00
.BEL1
        STA     COMC,X
        DEX
        BPL     BEL1

        LDA     L8002
        STA     L6760
        LDA     L8003
        STA     L6761
        JSR     L68BB

        LDX     #$FF
        TXS
        JSR     L6332

.L6781
        LDX     #$FF
        TXS
        JSR     RES2

        JSR     U%

        LDA     #$03
        STA     XC
        LDX     #$0B
        LDA     #$06
        LDY     #$C8
        JSR     L6807

        CPX     #$59
        BNE     L67A1

        JSR     L67DF

        JSR     L69D6

.L67A1
        JSR     L67DF

        JSR     L63AE

        LDA     #$07
        LDX     #$20
        LDY     #$64
        JSR     L6807

        JSR     L4A11

        JSR     TT111

        JSR     jmp

        LDX     #$05
.L67BB
        LDA     QQ15,X
        STA     L129A,X
        DEX
        BPL     L67BB

        INX
        STX     L0E7B
        LDA     QQ3
        STA     L1294
        LDA     QQ5
        STA     L1297
        LDA     QQ4
        STA     L1296
.BAY
        LDA     #$FF
        STA     QQ12
        LDA     #$88
        JMP     FRCE

.L67DF
        LDX     #$54
.L67E1
        LDA     L3467,X
        STA     L122B,X
        DEX
        BNE     L67E1

        STX     QQ11
.L67EC
        JSR     L68AD

        CMP     L34BB
        BNE     L67EC

        EOR     #$A9
        TAX
        LDA     L1242
        CPX     L34BA
        BEQ     L6801

        ORA     #$80
.L6801
        ORA     #$08
        STA     L1242
        RTS

.L6807
        STY     L1229
        PHA
        STX     TYPE
        JSR     L6332

        JSR     U%

        JSR     ZINF

        LDA     #$20
        JSR     DOVDU19

        LDA     #$0D
        JSR     TT66

        LDA     #$F0
        STA     COL
        LDA     #$00
        STA     QQ11
        LDA     #$60
        STA     L00AA
        LDA     #$60
        STA     L00A3
        LDX     #$7F
        STX     L00B9
        STX     L00BA
        INX
        STX     QQ17
        LDA     TYPE
        JSR     NWSHP

        LDA     #$06
        STA     XC
        LDA     #$1E
        JSR     plf

        LDA     #$0A
        JSR     DASC

        LDA     #$06
        STA     XC
        LDA     L2C58
        BEQ     L685A

        LDA     #$0D
        JSR     DETOK

.L685A
        LDY     #$00
        STY     DELTA
        STY     L2C5C
        LDA     #$14
        STA     YC
        LDA     #$01
        STA     XC
        PLA
        JSR     DETOK

        LDA     #$07
        STA     XC
        LDA     #$0C
        JSR     DETOK

        LDA     #$0C
        STA     CNT2
        LDA     #$05
        STA     MCNT
        STZ     L2C5C
.L6881
        LDA     L00A3
        CMP     #$01
        BEQ     L6889

        DEC     L00A3
.L6889
        JSR     MVEIT

        LDX     L1229
        STX     L00A2
        LDA     #$00
        STA     INWK
        STA     L009F
        JSR     LL9

        DEC     MCNT
        LDA     LFE40
        AND     #$10
        BEQ     L68A9

        JSR     RDKEY

        BEQ     L6881

        RTS

.L68A9
        DEC     L2C5C
        RTS

.L68AD
        LDX     #$49
        CLC
        TXA
.L68B1
        ADC     L346F,X
        EOR     L3470,X
        DEX
        BNE     L68B1

        RTS

.L68BB
        LDY     #$60
.L68BD
        LDA     L34CD,Y
        STA     L3468,Y
        DEY
        BPL     L68BD

        LDY     #$07
        STY     L6A8B
        RTS

.L68CC
        LDX     #$07
        LDA     L6A8A
        STA     L6A8B
.L68D4
        LDA     L00A1,X
        STA     L3468,X
        DEX
        BPL     L68D4

.L68DC
        LDX     #$07
.L68DE
        LDA     L3468,X
        STA     L00A1,X
        DEX
        BPL     L68DE

        RTS

.L68E7
        LDX     #$04
.L68E9
        LDA     L3463,X
        STA     INWK,X
        DEX
        BPL     L68E9

        LDA     #$07
        STA     L695D
        LDA     #$08
        JSR     DETOK

        JSR     L690A

        LDA     #$09
        STA     L695D
        TYA
        BEQ     L68DC

        STY     L6A8A
        RTS

.L690A
        LDA     COL
        PHA
        LDA     #$F0
        STA     COL
        LDY     #$08
        JSR     DELAY

        JSR     FLKB

        LDY     #$00
.L691B
        JSR     TT217

        CMP     #$0D
        BEQ     L6945

        CMP     #$1B
        BEQ     L694E

        CMP     #$7F
        BEQ     L6953

        CPY     L695D
        BCS     L693E

        CMP     L695E
        BCC     L693E

        CMP     L695F
        BCS     L693E

        STA     L00A1,Y
        INY
.L693D
        BIT     L07A9
L693E = L693D+1
.L6940
        JSR     TT26

        BCC     L691B

.L6945
        STA     L00A1,Y
        LDA     #$0C
        JSR     TT26

.L694D
        BIT     INF
L694E = L694D+1
        PLA
        STA     COL
        RTS

.L6953
        TYA
        BEQ     L693E

        DEY
        LDA     #$7F
        BNE     L6940

.L695B
        EQUB    $A1

        EQUB    $00

.L695D
        EQUB    $09

.L695E
        EQUB    $21

.L695F
        EQUB    $7B,$A9,$03,$18,$6D,$5E,$2C,$4C
        EQUB    $4F,$32,$A9,$02,$38,$ED,$5E,$2C
        EQUB    $4C,$4F,$32

.ZERO
        LDX     #$3C
        LDA     #$00
.L6976
        STA     FRIN,X
        DEX
        BPL     L6976

        RTS

.L697D
        JSR     GTDRV

        BCS     L69A5

        STA     L6ACB
        STA     L3B71
        LDA     #$03
        JSR     DETOK

        LDA     #$01
        STA     CATF
        STA     XC
        JSR     MASTER_SWAP_ZP_3000

        LDX     #$C7
        LDY     #$6A
        JSR     OSCLI

        JSR     MASTER_SWAP_ZP_3000

        STZ     CATF
        CLC
.L69A5
        RTS

.L69A6
        JSR     L697D

        BCS     L69D6

        LDA     L6ACB
        STA     L6AD5
        LDA     #$08
        JSR     DETOK

        JSR     L690A

        TYA
        BEQ     L69D6

        LDX     #$09
.L69BE
        LDA     L00A0,X
        STA     L6AD6,X
        DEX
        BNE     L69BE

        JSR     MASTER_SWAP_ZP_3000

        LDX     #$CD
        LDY     #$6A
        JSR     OSCLI

        JSR     MASTER_SWAP_ZP_3000

        JMP     L69D6

.L69D6
        TSX
        STX     L66B8
        JSR     L4A88

        LDA     #$01
        JSR     DETOK

        JSR     L6DB4

        CMP     #$31
        BEQ     L6A1A

        CMP     #$32
        BEQ     L6A2D

        CMP     #$33
        BEQ     L6A11

        CMP     #$34
        BNE     L69FB

        JSR     L69A6

        JMP     L69D6

.L69FB
        CMP     #$35
        BNE     L6A0F

        LDA     #$E0
        JSR     DETOK

        JSR     L6174

        BCC     L6A0F

        JSR     L68BB

        JMP     L67DF

.L6A0F
        CLC
        RTS

.L6A11
        JSR     L697D

        JSR     L6DB4

        JMP     L69D6

.L6A1A
        JSR     L68E7

        JSR     GTDRV

        BCS     L6A2C

        STA     L6B05
        JSR     L6AA5

        JSR     L68CC

        SEC
.L6A2C
        RTS

.L6A2D
        JSR     L68E7

        JSR     L68CC

        LSR     L127D
        LDA     #$04
        JSR     DETOK

        LDX     #$4C
.L6A3D
        LDA     TP,X
        STA     L3470,X
        DEX
        BPL     L6A3D

        JSR     L68AD

        STA     L34BB
        PHA
        ORA     #$80
        STA     K
        EOR     L1242
        STA     L0058
        EOR     L123F
        STA     L0057
        EOR     #$5A
        EOR     L127C
        STA     L0059
        CLC
        JSR     L4AE0

        JSR     L4AE0

        PLA
        EOR     #$A9
        STA     L34BA
        LDY     #$4C
.L6A71
        LDA     L3470,Y
        STA     L0791,Y
        DEY
        BPL     L6A71

        JSR     GTDRV

        BCS     L6A85

        STA     L6AE5
        JSR     L6B16

.L6A85
        EQUB    $20

        EQUB    $DF,$67,$18,$60

.L6A8A
        EQUB    $07

.L6A8B
        EQUB    $07

.GTDRV
        LDA     #$02
        JSR     DETOK

        JSR     L6DB4

        ORA     #$10
        JSR     TT26

        PHA
        JSR     FEED

        PLA
        CMP     #$30
        BCC     L6AB8

        CMP     #$34
        RTS

.L6AA5
        JSR     L6B53

        LDA     L0791
        BMI     L6ABA

        LDY     #$4C
.L6AAF
        LDA     L0791,Y
        STA     L3470,Y
        DEY
        BPL     L6AAF

.L6AB8
        SEC
        RTS

.L6ABA
        LDA     #$09
        JSR     DETOK

        JSR     L6DB4

        JMP     L69D6

        RTS

        RTS

        EQUS    "CAT "

.L6ACB
        EQUS    "1"

        EQUB    $0D

        EQUS    "DELETE :"

.L6AD5
        EQUS    "1"

.L6AD6
        EQUS    ".1234567"

        EQUB    $0D

        EQUS    "SAVE :"

.L6AE5
        EQUS    "1.E."

.L6AE9
        EQUS    "JAMESON  E7E +100 0 0"

        EQUB    $0D

        EQUS    "LOAD :"

.L6B05
        EQUS    "1.E."

.L6B09
        EQUS    "JAMESON  E7E"

        EQUB    $0D

.L6B16
        LDY     #$4C
.L6B18
        LDA     L3470,Y
        STA     LSX2,Y
        DEY
        BPL     L6B18

        LDA     #$00
        LDY     #$4C
.L6B25
        STA     LSX2,Y
        INY
        BNE     L6B25

        LDY     #$00
.L6B2D
        LDA     L3468,Y
        CMP     #$0D
        BEQ     L6B3C

        STA     L6AE9,Y
        INY
        CPY     #$07
        BCC     L6B2D

.L6B3C
        LDA     #$20
        STA     L6AE9,Y
        INY
        CPY     #$07
        BCC     L6B3C

        JSR     MASTER_SWAP_ZP_3000

        LDX     #$DF
        LDY     #$6A
        JSR     OSCLI

        JMP     MASTER_SWAP_ZP_3000

.L6B53
        LDY     #$00
.L6B55
        LDA     L00A1,Y
        CMP     #$0D
        BEQ     L6B64

        STA     L6B09,Y
        INY
        CPY     #$07
        BCC     L6B55

.L6B64
        LDA     #$20
        STA     L6B09,Y
        INY
        CPY     #$07
        BCC     L6B64

        JSR     MASTER_SWAP_ZP_3000

        LDX     #$FF
        LDY     #$6A
        JSR     OSCLI

        JSR     MASTER_SWAP_ZP_3000

        LDY     #$4C
.L6B7D
        LDA     LSX2,Y
        STA     L0791,Y
        DEY
        BPL     L6B7D

        RTS

        RTS

.SPS1
        LDX     #$00
        JSR     L5B98

        LDX     #$03
        JSR     L5B98

        LDX     #$06
        JSR     L5B98

.TAS2
        LDA     K3
        ORA     L0017
        ORA     L001A
        ORA     #$01
        STA     L001D
        LDA     L0015
        ORA     L0018
        ORA     L001B
.L6BA7
        ASL     L001D
        ROL     A
        BCS     TA2

        ASL     K3
        ROL     L0015
        ASL     L0017
        ROL     L0018
        ASL     L001A
        ROL     L001B
        BCC     L6BA7

.TA2
        LDA     L0015
        LSR     A
        ORA     L0016
        STA     XX15
        LDA     L0018
        LSR     A
        ORA     L0019
        STA     Y1
        LDA     L001B
        LSR     A
        ORA     L001C
        STA     X2
.L6BCF
        LDA     XX15
        JSR     SQUA

        STA     R
        LDA     P
        STA     Q
        LDA     Y1
        JSR     SQUA

        STA     T
        LDA     P
        ADC     Q
        STA     Q
        LDA     T
        ADC     R
        STA     R
        LDA     X2
        JSR     SQUA

        STA     T
        LDA     P
        ADC     Q
        STA     Q
        LDA     T
        ADC     R
        STA     R
        JSR     LL5

        LDA     XX15
        JSR     TIS2

        STA     XX15
        LDA     Y1
        JSR     TIS2

        STA     Y1
        LDA     X2
        JSR     TIS2

        STA     X2
        RTS

.WARP
        LDX     JUNK
        LDA     L0E43,X
        ORA     SSPR
        ORA     MJ
        BNE     L6C6C

        LDY     L0408
        BMI     L6C34

        TAY
        JSR     MAS2

        CMP     #$02
        BCC     L6C6C

.L6C34
        LDY     L042D
        BMI     L6C42

        LDY     #$25
        JSR     m

        CMP     #$02
        BCC     L6C6C

.L6C42
        LDA     #$81
        STA     S
        STA     R
        STA     P
        LDA     L0408
        JSR     ADD

        STA     L0408
        LDA     L042D
        JSR     ADD

        STA     L042D
        LDA     #$01
        STA     QQ11
        STA     MCNT
        LSR     A
        STA     L0E7B
        LDX     VIEW
        JMP     LOOK1

.L6C6C
        JMP     BEEP_LONG_LOW

        RTS

.L6C70
        TXA
        CMP     L2C62,Y
        BNE     L6C8F

        LDA     DAMP,Y
        EOR     #$FF
        STA     DAMP,Y
        BPL     L6C83

        JSR     BELL

.L6C83
        JSR     BELL

        TYA
        PHA
        LDY     #$14
        JSR     DELAY

        PLA
        TAY
.L6C8F
        RTS

.L6C90
        JSR     L7ED7

        LDA     auto
        BEQ     L6CF2

        JSR     ZINF

        LDA     #$60
        STA     L00AA
        ORA     #$80
        STA     L00B2
        STA     TYPE
        LDA     DELTA
        STA     L00B7
        JSR     DOCKIT

        LDA     L00B7
        CMP     #$16
        BCC     L6CB4

        LDA     #$16
.L6CB4
        STA     DELTA
        LDA     #$FF
        LDX     #$0F
        LDY     L00B8
        BEQ     L6CC4

        BMI     L6CC2

        LDX     #$0B
.L6CC2
        STA     L00C3,X
.L6CC4
        LDA     #$80
        LDX     #$0D
        ASL     L00B9
        BEQ     L6CDE

        BCC     L6CD0

        LDX     #$0E
.L6CD0
        BIT     L00B9
        BPL     L6CDA

        LDA     #$40
        STA     JSTX
        LDA     #$00
.L6CDA
        STA     L00C3,X
        LDA     JSTX
.L6CDE
        STA     JSTX
        LDA     #$80
        LDX     #$06
        ASL     L00BA
        BEQ     L6CF0

        BCS     L6CEC

        LDX     #$08
.L6CEC
        STA     L00C3,X
        LDA     JSTY
.L6CF0
        STA     JSTY
.L6CF2
        LDA     L2C5C
        BEQ     L6D1B

        LDA     L12A7
        EOR     L2C5B
        ORA     #$01
        STA     JSTX
        LDA     L12A8
        EOR     #$FF
        EOR     L2C5B
        EOR     L2C5A
        STA     JSTY
        LDA     LFE40
        AND     #$10
        BNE     L6D42

        LDA     #$FF
        STA     KY7
        BNE     L6D42

.L6D1B
        LDX     JSTX
        LDA     #$07
        LDY     L00D0
        BEQ     L6D26

        JSR     BUMP2

.L6D26
        LDY     L00D1
        BEQ     L6D2D

        JSR     REDU2

.L6D2D
        STX     JSTX
        ASL     A
        LDX     JSTY
        LDY     L00C9
        BEQ     L6D39

        JSR     REDU2

.L6D39
        LDY     L00CB
        BEQ     L6D40

        JSR     BUMP2

.L6D40
        STX     JSTY
.L6D42
        LDX     L00C3
        CPX     #$8B
        BNE     L6DB1

.L6D48
        JSR     WSCAN

        JSR     RDKEY

        CPX     #$51
        BNE     L6D59

        LDX     #$FF
        STX     L2C55
        LDX     #$51
.L6D59
        LDY     #$00
.L6D5B
        JSR     L6C70

        INY
        CPY     #$09
        BNE     L6D5B

        LDA     L2C61
        CPX     #$2E
        BEQ     L6D70

        CPX     #$2C
        BNE     L6D83

        DEC     A
.L6D6F
        BIT     L001A
L6D70 = L6D6F+1
        TAY
        AND     #$F8
        BNE     L6D79

        STY     L2C61
.L6D79
        PHX
        JSR     BEEP

        LDY     #$0A
        JSR     DELAY

        PLX
.L6D83
        CPX     #$42
        BNE     L6D9D

        LDA     BSTK
        EOR     #$FF
        STA     BSTK
        STA     L2C5C
        STA     L2C5B
        BPL     L6D9A

        JSR     BELL

.L6D9A
        JSR     BELL

.L6D9D
        CPX     #$53
        BNE     L6DA6

        LDA     #$00
        STA     L2C55
.L6DA6
        CPX     #$1B
        BNE     L6DAD

        JMP     L6781

.L6DAD
        CPX     #$7F
        BNE     L6D48

.L6DB1
        RTS

.TT217
        STY     YSAV
.L6DB4
        LDY     #$02
        JSR     DELAY

        JSR     RDKEY

        BNE     L6DB4

.L6DBE
        JSR     RDKEY

        BEQ     L6DBE

        LDY     YSAV
        TAX
.L6DC6
        RTS

.L6DC7
        STX     DLY
        PHA
        LDA     #$0F
        STA     COL
        LDA     L1281
        JSR     L6E25

        PLA
.MESS
        PHA
        LDX     QQ11
        BEQ     L6DDE

        JSR     CLYNS

.L6DDE
        LDA     #$15
        STA     YC
        LDA     #$0F
        STA     COL
        LDX     #$00
        STX     QQ17
        LDA     L009A
        STA     XC
        PLA
        LDY     #$14
        CPX     DLY
        BNE     L6DC7

        STY     DLY
        STA     L1281
        LDA     #$C0
        STA     DTW4
        LDA     L0E7D
        LSR     A
        LDA     #$00
        BCC     L6E0B

        LDA     #$0A
.L6E0B
        STA     DTW5
        LDA     L1281
        JSR     TT27

        LDA     #$20
        SEC
        SBC     DTW5
        LSR     A
        STA     L009A
        STA     XC
        JSR     MT15

        LDA     L1281
.L6E25
        JSR     TT27

        LSR     L0E7D
        BCC     L6DC6

        LDA     #$FD
        JMP     TT27

.L6E32
        JSR     DORND

        BMI     L6DC6

        CPX     #$16
        BCS     L6DC6

        LDA     QQ20,X
        BEQ     L6DC6

        LDA     DLY
        BNE     L6DC6

        LDY     #$03
        STY     L0E7D
        STA     QQ20,X
        CPX     #$11
        BCS     L6E57

        TXA
        ADC     #$D0
        JMP     MESS

.L6E57
        BEQ     L6E63

        CPX     #$12
        BEQ     L6E68

        TXA
        ADC     #$5D
        JMP     MESS

.L6E63
        LDA     #$6C
        JMP     MESS

.L6E68
        LDA     #$6F
.L6E6A
        JMP     MESS

QQ23 = L6E6A+2
.L6E6D
        EQUB    $13

.L6E6E
        EQUB    $82

.L6E6F
        EQUB    $06

.L6E70
        EQUB    $01,$14,$81,$0A,$03,$41,$83,$02
        EQUB    $07,$28,$85,$E2,$1F,$53,$85,$FB
        EQUB    $0F,$C4,$08,$36,$03,$EB,$1D,$08
        EQUB    $78,$9A,$0E,$38,$03,$75,$06,$28
        EQUB    $07,$4E,$01,$11,$1F,$7C,$0D,$1D
        EQUB    $07,$B0,$89,$DC,$3F,$20,$81,$35
        EQUB    $03,$61,$A1,$42,$07,$AB,$A2,$37
        EQUB    $1F,$2D,$C1,$FA,$0F,$35,$0F,$C0
        EQUB    $07

.TI2
        TYA
        LDY     #$02
        JSR     TIS3

        STA     L00B0
        JMP     L6EF9

.L6EBC
        TAX
        LDA     Y1
        AND     #$60
        BEQ     TI2

        LDA     #$02
        JSR     TIS3

        STA     L00AE
        JMP     L6EF9

.TIDY
        LDA     L00A6
        STA     XX15
        LDA     L00A8
        STA     Y1
        LDA     L00AA
        STA     X2
        JSR     L6BCF

        LDA     XX15
        STA     L00A6
        LDA     Y1
        STA     L00A8
        LDA     X2
        STA     L00AA
        LDY     #$04
        LDA     XX15
        AND     #$60
        BEQ     L6EBC

        LDX     #$02
        LDA     #$00
        JSR     TIS3

        STA     L00AC
.L6EF9
        LDA     L00AC
        STA     XX15
        LDA     L00AE
        STA     Y1
        LDA     L00B0
        STA     X2
        JSR     L6BCF

        LDA     XX15
        STA     L00AC
        LDA     Y1
        STA     L00AE
        LDA     X2
        STA     L00B0
        LDA     L00A8
        STA     Q
        LDA     L00B0
        JSR     MULT12

        LDX     L00AA
        LDA     L00AE
        JSR     TIS1

        EOR     #$80
        STA     L00B2
        LDA     L00AC
        JSR     MULT12

        LDX     L00A6
        LDA     L00B0
        JSR     TIS1

        EOR     #$80
        STA     L00B4
        LDA     L00AE
        JSR     MULT12

        LDX     L00A8
        LDA     L00AC
        JSR     TIS1

        EOR     #$80
        STA     L00B6
        LDA     #$00
        LDX     #$0E
.L6F4C
        STA     L00A5,X
        DEX
        DEX
        BPL     L6F4C

        RTS

.TIS2
        TAY
        AND     #$7F
        CMP     Q
        BCS     L6F7A

        LDX     #$FE
        STX     T
.L6F5E
        ASL     A
        CMP     Q
        BCC     L6F65

        SBC     Q
.L6F65
        ROL     T
        BCS     L6F5E

        LDA     T
        LSR     A
        LSR     A
        STA     T
        LSR     A
        ADC     T
        STA     T
        TYA
        AND     #$80
        ORA     T
        RTS

.L6F7A
        TYA
        AND     #$80
        ORA     #$60
        RTS

.TIS3
        STA     S_COPY
        LDA     L00A6,X
        STA     Q
        LDA     L00AC,X
        JSR     MULT12

        LDX     L00A6,Y
        STX     Q
        LDA     L00AC,Y
        JSR     MAD

        STX     P
        LDY     S_COPY
        LDX     L00A6,Y
        STX     Q
        EOR     #$80
        STA     L000D
        EOR     Q
        AND     #$80
        STA     T
        LDA     #$00
        LDX     #$10
        ASL     P
        ROL     L000D
        ASL     Q
        LSR     Q
.L6FB3
        ROL     A
        CMP     Q
        BCC     L6FBA

        SBC     Q
.L6FBA
        ROL     P
        ROL     L000D
        DEX
        BNE     L6FB3

        LDA     P
        ORA     T
        RTS

        EQUB    $02

        EQUB    $0F,$31,$32,$33,$34,$35,$36,$37
        EQUB    $38,$39,$30,$31,$32,$33,$34,$35
        EQUB    $36,$37

.SHPPT
        JSR     L5CA6

        ORA     L0015
        BNE     L6FFA

        LDA     K4
        CMP     #$BE
        BCS     L6FFA

        JSR     L7003

        LDA     K4
        CLC
        ADC     #$01
        JSR     L7003

        LDA     #$08
        ORA     L00BB
        STA     L00BB
        JMP     L78D1

.L6FFA
        LDA     #$F7
        AND     L00BB
        STA     L00BB
        JMP     L78D1

.L7003
        STA     Y1
        STA     Y2
        LDA     K3
        STA     XX15
        CLC
        ADC     #$03
        BCC     L7012

        LDA     #$FF
.L7012
        STA     X2
        JMP     L78F8

.LL5
        LDY     R
        LDA     Q
        STA     S
        LDX     #$00
        STX     Q
        LDA     #$08
        STA     T
.L7025
        CPX     Q
        BCC     L7037

        BNE     L702F

        CPY     #$40
        BCC     L7037

.L702F
        TYA
        SBC     #$40
        TAY
        TXA
        SBC     Q
        TAX
.L7037
        ROL     Q
        ASL     S
        TYA
        ROL     A
        TAY
        TXA
        ROL     A
        TAX
        ASL     S
        TYA
        ROL     A
        TAY
        TXA
        ROL     A
        TAX
        DEC     T
        BNE     L7025

        RTS

.LL28
        CMP     Q
        BCS     L7091

        STA     widget
        TAX
        BEQ     L7070

        LDA     logL,X
        LDX     Q
        SEC
        SBC     logL,X
        LDX     widget
        LDA     log,X
        LDX     Q
        SBC     log,X
        BCS     L7091

        TAX
        LDA     antilog,X
.L7070
        STA     R
        RTS

        BCS     L7091

        LDX     #$FE
        STX     R
.L7079
        ASL     A
        BCS     L7087

        CMP     Q
        BCC     L7082

        SBC     Q
.L7082
        ROL     R
        BCS     L7079

        RTS

.L7087
        SBC     Q
        SEC
        ROL     R
        BCS     L7079

        LDA     R
        RTS

.L7091
        LDA     #$FF
        STA     R
        RTS

.LL38
        EOR     S
        BMI     L70A0

        LDA     Q
        CLC
        ADC     R
        RTS

.L70A0
        LDA     R
        SEC
        SBC     Q
        BCC     L70A9

        CLC
        RTS

.L70A9
        PHA
        LDA     S
        EOR     #$80
        STA     S
        PLA
        EOR     #$FF
        ADC     #$01
        RTS

.LL51
        LDX     #$00
        LDY     #$00
.L70BA
        LDA     XX15
        STA     Q
        LDA     XX16,X
        JSR     FMLTU

        STA     T
        LDA     Y1
        EOR     L0025,X
        STA     S
        LDA     X2
        STA     Q
        LDA     L0026,X
        JSR     FMLTU

        STA     Q
        LDA     T
        STA     R
        LDA     Y2
        EOR     L0027,X
        JSR     LL38

        STA     T
        LDA     L004E
        STA     Q
        LDA     L0028,X
        JSR     FMLTU

        STA     Q
        LDA     T
        STA     R
        LDA     L004F
        EOR     L0029,X
        JSR     LL38

        STA     XX12,Y
        LDA     S
        STA     L0051,Y
        INY
        INY
        TXA
        CLC
        ADC     #$06
        TAX
        CMP     #$11
        BCC     L70BA

        RTS

.LL25
        JMP     PLANET

.LL9
        LDX     TYPE
        BMI     LL25

        LDA     shpcol,X
        STA     COL
        LDA     #$1F
        STA     XX4
        LDY     #$01
        STY     L008F
        DEY
        LDA     #$08
        BIT     L00BB
        BNE     L712B

        LDA     #$00
.L712A
        BIT     LBDB1
L712B = L712A+1
        STA     L0090
        LDA     NEWB
        BMI     EE51

        LDA     #$20
        BIT     L00BB
        BNE     L7166

        BPL     L7166

        ORA     L00BB
        AND     #$3F
        STA     L00BB
        LDA     #$00
        LDY     #$1C
        STA     (INF),Y
        LDY     #$1E
        STA     (INF),Y
        JSR     EE51

        LDY     #$01
        LDA     #$12
        STA     (XX19),Y
        LDY     #$07
        LDA     (XX0),Y
        LDY     #$02
        STA     (XX19),Y
.L715C
        INY
        JSR     DORND

        STA     (XX19),Y
        CPY     #$06
        BNE     L715C

.L7166
        LDA     L00A4
        BPL     LL10

.L716A
        LDA     L00BB
        AND     #$20
        BEQ     EE51

        LDA     L00BB
        AND     #$F7
        STA     L00BB
        JMP     DOEXP

.EE51
        LDA     #$08
        BIT     L00BB
        BEQ     L7186

        EOR     L00BB
        STA     L00BB
        JMP     L78D1

.L7186
        RTS

.LL10
        LDA     L00A3
        CMP     #$C0
        BCS     L716A

        LDA     INWK
        CMP     L00A2
        LDA     L009D
        SBC     L00A3
        BCS     L716A

        LDA     L009F
        CMP     L00A2
        LDA     L00A0
        SBC     L00A3
        BCS     L716A

        LDY     #$06
        LDA     (XX0),Y
        TAX
        LDA     #$FF
        STA     XX3,X
        STA     L0101,X
        LDA     L00A2
        STA     T
        LDA     L00A3
        LSR     A
        ROR     T
        LSR     A
        ROR     T
        LSR     A
        ROR     T
        LSR     A
        BNE     L71CA

        LDA     T
        ROR     A
        LSR     A
        LSR     A
        LSR     A
        STA     XX4
        BPL     LL17

.L71CA
        LDY     #$0D
        LDA     (XX0),Y
        CMP     L00A3
        BCS     LL17

        LDA     #$20
        AND     L00BB
        BNE     LL17

        JMP     SHPPT

.LL17
        LDX     #$05
.L71DD
        LDA     L00B1,X
        STA     XX16,X
        LDA     L00AB,X
        STA     L002A,X
        LDA     L00A5,X
        STA     L0030,X
        DEX
        BPL     L71DD

        LDA     #$C5
        STA     Q
        LDY     #$10
.L71F2
        LDA     XX16,Y
        ASL     A
        LDA     L0025,Y
        ROL     A
        JSR     LL28

        LDX     R
        STX     XX16,Y
        DEY
        DEY
        BPL     L71F2

        LDX     #$08
.L7207
        LDA     INWK,X
        STA     XX18,X
        DEX
        BPL     L7207

        LDA     #$FF
        STA     L0023
        LDY     #$0C
        LDA     L00BB
        AND     #$20
        BEQ     EE29

        LDA     (XX0),Y
        LSR     A
        LSR     A
        TAX
        LDA     #$FF
.L7221
        STA     K3,X
        DEX
        BPL     L7221

        INX
        STX     XX4
.L7229
        JMP     LL42

.EE29
        LDA     (XX0),Y
        BEQ     L7229

        STA     XX20
        LDY     #$12
        LDA     (XX0),Y
        TAX
        LDA     L006B
        TAY
        BEQ     L724B

.L723C
        INX
        LSR     K6
        ROR     L0067
        LSR     L0065
        ROR     XX18
        LSR     A
        ROR     L006A
        TAY
        BNE     L723C

.L724B
        STX     XX17
        LDA     L006C
        STA     L004F
        LDA     XX18
        STA     XX15
        LDA     L0066
        STA     Y1
        LDA     L0067
        STA     X2
        LDA     L0069
        STA     Y2
        LDA     L006A
        STA     L004E
        JSR     LL51

        LDA     XX12
        STA     XX18
        LDA     L0051
        STA     L0066
        LDA     L0052
        STA     L0067
        LDA     L0053
        STA     L0069
        LDA     L0054
        STA     L006A
        LDA     L0055
        STA     L006C
        LDY     #$04
        LDA     (XX0),Y
        CLC
        ADC     XX0
        STA     V
        LDY     #$11
        LDA     (XX0),Y
        ADC     L0037
        STA     L003B
        LDY     #$00
.L7293
        LDA     (V),Y
        STA     L0051
        AND     #$1F
        CMP     XX4
        BCS     L72AC

        TYA
        LSR     A
        LSR     A
        TAX
        LDA     #$FF
        STA     K3,X
        TYA
        ADC     #$04
        TAY
        JMP     L7398

.L72AC
        LDA     L0051
        ASL     A
        STA     L0053
        ASL     A
        STA     L0055
        INY
        LDA     (V),Y
        STA     XX12
        INY
        LDA     (V),Y
        STA     L0052
        INY
        LDA     (V),Y
        STA     L0054
        LDX     XX17
        CPX     #$04
        BCC     L72EC

        LDA     XX18
        STA     XX15
        LDA     L0066
        STA     Y1
        LDA     L0067
        STA     X2
        LDA     L0069
        STA     Y2
        LDA     L006A
        STA     L004E
        LDA     L006C
        STA     L004F
        JMP     L734A

.L72E4
        LSR     XX18
        LSR     L006A
        LSR     L0067
        LDX     #$01
.L72EC
        LDA     XX12
        STA     XX15
        LDA     L0052
        STA     X2
        LDA     L0054
        DEX
        BMI     L7301

.L72F9
        LSR     XX15
        LSR     X2
        LSR     A
        DEX
        BPL     L72F9

.L7301
        STA     R
        LDA     L0055
        STA     S
        LDA     L006A
        STA     Q
        LDA     L006C
        JSR     LL38

        BCS     L72E4

        STA     L004E
        LDA     S
        STA     L004F
        LDA     XX15
        STA     R
        LDA     L0051
        STA     S
        LDA     XX18
        STA     Q
        LDA     L0066
        JSR     LL38

        BCS     L72E4

        STA     XX15
        LDA     S
        STA     Y1
        LDA     X2
        STA     R
        LDA     L0053
        STA     S
        LDA     L0067
        STA     Q
        LDA     L0069
        JSR     LL38

        BCS     L72E4

        STA     X2
        LDA     S
        STA     Y2
.L734A
        LDA     XX12
        STA     Q
        LDA     XX15
        JSR     FMLTU

        STA     T
        LDA     L0051
        EOR     Y1
        STA     S
        LDA     L0052
        STA     Q
        LDA     X2
        JSR     FMLTU

        STA     Q
        LDA     T
        STA     R
        LDA     L0053
        EOR     Y2
        JSR     LL38

        STA     T
        LDA     L0054
        STA     Q
        LDA     L004E
        JSR     FMLTU

        STA     Q
        LDA     T
        STA     R
        LDA     L004F
        EOR     L0055
        JSR     LL38

        PHA
        TYA
        LSR     A
        LSR     A
        TAX
        PLA
        BIT     S
        BMI     L7395

        LDA     #$00
.L7395
        STA     K3,X
        INY
.L7398
        CPY     XX20
        BCS     LL42

        JMP     L7293

.LL42
        LDY     L0026
        LDX     L0027
        LDA     L002A
        STA     L0026
        LDA     L002B
        STA     L0027
        STY     L002A
        STX     L002B
        LDY     L0028
        LDX     L0029
        LDA     L0030
        STA     L0028
        LDA     L0031
        STA     L0029
        STY     L0030
        STX     L0031
        LDY     L002E
        LDX     L002F
        LDA     L0032
        STA     L002E
        LDA     L0033
        STA     L002F
        STY     L0032
        STX     L0033
        LDY     #$08
        LDA     (XX0),Y
        STA     XX20
        LDA     XX0
        CLC
        ADC     #$14
        STA     V
        LDA     L0037
        ADC     #$00
        STA     L003B
        LDY     #$00
        STY     CNT
.L73E6
        STY     XX17
        LDA     (V),Y
        STA     XX15
        INY
        LDA     (V),Y
        STA     X2
        INY
        LDA     (V),Y
        STA     L004E
        INY
        LDA     (V),Y
        STA     T
        AND     #$1F
        CMP     XX4
        BCC     L742F

        INY
        LDA     (V),Y
        STA     P
        AND     #$0F
        TAX
        LDA     K3,X
        BNE     L7432

        LDA     P
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        TAX
        LDA     K3,X
        BNE     L7432

        INY
        LDA     (V),Y
        STA     P
        AND     #$0F
        TAX
        LDA     K3,X
        BNE     L7432

        LDA     P
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        TAX
        LDA     K3,X
        BNE     L7432

.L742F
        JMP     LL50

.L7432
        LDA     T
        STA     Y1
        ASL     A
        STA     Y2
        ASL     A
        STA     L004F
        JSR     LL51

        LDA     L009E
        STA     X2
        EOR     L0051
        BMI     L7457

        CLC
        LDA     XX12
        ADC     INWK
        STA     XX15
        LDA     L009D
        ADC     #$00
        STA     Y1
        JMP     L747A

.L7457
        LDA     INWK
        SEC
        SBC     XX12
        STA     XX15
        LDA     L009D
        SBC     #$00
        STA     Y1
        BCS     L747A

        EOR     #$FF
        STA     Y1
        LDA     #$01
        SBC     XX15
        STA     XX15
        BCC     L7474

        INC     Y1
.L7474
        LDA     X2
        EOR     #$80
        STA     X2
.L747A
        LDA     L00A1
        STA     L004F
        EOR     L0053
        BMI     L7492

        CLC
        LDA     L0052
        ADC     L009F
        STA     Y2
        LDA     L00A0
        ADC     #$00
        STA     L004E
        JMP     LL55

.L7492
        LDA     L009F
        SEC
        SBC     L0052
        STA     Y2
        LDA     L00A0
        SBC     #$00
        STA     L004E
        BCS     LL55

        EOR     #$FF
        STA     L004E
        LDA     Y2
        EOR     #$FF
        ADC     #$01
        STA     Y2
        LDA     L004F
        EOR     #$80
        STA     L004F
        BCC     LL55

        INC     L004E
.LL55
        LDA     L0055
        BMI     LL56

        LDA     L0054
        CLC
        ADC     L00A2
        STA     T
        LDA     L00A3
        ADC     #$00
        STA     U
        JMP     LL57

.LL61
        LDX     Q
        BEQ     L74EB

        LDX     #$00
.L74D1
        LSR     A
        INX
        CMP     Q
        BCS     L74D1

        STX     S
        JSR     LL28

        LDX     S
        LDA     R
.L74E0
        ASL     A
        ROL     U
        BMI     L74EB

        DEX
        BNE     L74E0

        STA     R
        RTS

.L74EB
        LDA     #$32
        STA     R
        STA     U
        RTS

.LL62
        LDA     #$80
        SEC
        SBC     R
        STA     XX3,X
        INX
        LDA     #$00
        SBC     U
        STA     XX3,X
        JMP     LL66

.LL56
        LDA     L00A2
        SEC
        SBC     L0054
        STA     T
        LDA     L00A3
        SBC     #$00
        STA     U
        BCC     L751C

        BNE     LL57

        LDA     T
        CMP     #$04
        BCS     LL57

.L751C
        LDA     #$00
        STA     U
        LDA     #$04
        STA     T
.LL57
        LDA     U
        ORA     Y1
        ORA     L004E
        BEQ     LL69

        LSR     Y1
        ROR     XX15
        LSR     L004E
        ROR     Y2
        LSR     U
        ROR     T
        JMP     LL57

.LL69
        LDA     T
        STA     Q
        LDA     XX15
        CMP     Q
        BCC     L754B

        JSR     LL61

        JMP     LL65

.L754B
        JSR     LL28

.LL65
        LDX     CNT
        LDA     X2
        BMI     LL62

        LDA     R
        CLC
        ADC     #$80
        STA     XX3,X
        INX
        LDA     U
        ADC     #$00
        STA     XX3,X
.LL66
        TXA
        PHA
        LDA     #$00
        STA     U
        LDA     T
        STA     Q
        LDA     Y2
        CMP     Q
        BCC     L758D

        JSR     LL61

        JMP     L7590

.L757A
        LDA     #$60
        CLC
        ADC     R
        STA     XX3,X
        INX
        LDA     #$00
        ADC     U
        STA     XX3,X
        JMP     LL50

.L758D
        JSR     LL28

.L7590
        PLA
        TAX
        INX
        LDA     L004F
        BMI     L757A

        LDA     #$60
        SEC
        SBC     R
        STA     XX3,X
        INX
        LDA     #$00
        SBC     U
        STA     XX3,X
.LL50
        CLC
        LDA     CNT
        ADC     #$04
        STA     CNT
        LDA     XX17
        ADC     #$06
        TAY
        BCS     LL72

        CMP     XX20
        BCS     LL72

        JMP     L73E6

.LL72
        LDA     L00BB
        AND     #$20
        BEQ     EE31

        LDA     L00BB
        ORA     #$08
        STA     L00BB
        JMP     DOEXP

.EE31
        LDY     #$09
        LDA     (XX0),Y
        STA     XX20
        LDA     #$08
        ORA     L00BB
        STA     L00BB
        LDY     #$00
        STY     XX17
        BIT     L00BB
        BVC     LL170

        LDA     L00BB
        AND     #$BF
        STA     L00BB
        LDY     #$06
        LDA     (XX0),Y
        TAY
        LDX     XX3,Y
        STX     XX15
        INX
        BEQ     LL170

        LDX     L0101,Y
        STX     Y1
        INX
        BEQ     LL170

        LDX     L0102,Y
        STX     X2
        LDX     L0103,Y
        STX     Y2
        LDA     #$00
        STA     L004E
        STA     L004F
        STA     L0051
        LDA     L00A2
        STA     XX12
        LDA     L009E
        BPL     L7616

        DEC     L004E
.L7616
        JSR     LL145

        BCS     LL170

        JSR     L78F8

.LL170
        LDY     #$03
        CLC
        LDA     (XX0),Y
        ADC     XX0
        STA     V
        LDY     #$10
        LDA     (XX0),Y
        ADC     L0037
        STA     L003B
        LDY     #$05
        LDA     (XX0),Y
        STA     CNT
.L7635
        LDY     #$00
        LDA     (V),Y
        CMP     XX4
        BCC     L768C

        INY
        LDA     (V),Y
        STA     P
        AND     #$0F
        TAX
        LDA     K3,X
        BNE     LL79

        LDA     P
        LSR     A
        LSR     A
        LSR     A
        LSR     A
        TAX
        LDA     K3,X
        BEQ     L768C

.LL79
        INY
        LDA     (V),Y
        TAX
        LDA     XX3,X
        STA     XX15
        LDA     L0101,X
        STA     Y1
        LDA     L0102,X
        STA     X2
        LDA     L0103,X
        STA     Y2
        INY
        LDA     (V),Y
        TAX
        LDA     XX3,X
        STA     L004E
        LDA     L0102,X
        STA     XX12
        LDA     L0103,X
        STA     L0051
        LDA     L0101,X
        STA     L004F
        JSR     LL147

        BCS     L768C

        JSR     L78F8

.L768C
        LDA     L008F
        CMP     CNT
        BCS     L76A5

        LDA     V
        CLC
        ADC     #$04
        STA     V
        BCC     L769D

        INC     L003B
.L769D
        INC     XX17
        LDY     XX17
        CPY     XX20
        BCC     L7635

.L76A5
        JMP     L78D1

.LL118
        LDA     Y1
        BPL     L76C3

        STA     S
        JSR     LL120

        TXA
        CLC
        ADC     X2
        STA     X2
        TYA
        ADC     Y2
        STA     Y2
        LDA     #$00
        STA     XX15
        STA     Y1
        TAX
.L76C3
        BEQ     L76DE

        STA     S
        DEC     S
        JSR     LL120

        TXA
        CLC
        ADC     X2
        STA     X2
        TYA
        ADC     Y2
        STA     Y2
        LDX     #$FF
        STX     XX15
        INX
        STX     Y1
.L76DE
        LDA     Y2
        BPL     L76FC

        STA     S
        LDA     X2
        STA     R
        JSR     LL123

        TXA
        CLC
        ADC     XX15
        STA     XX15
        TYA
        ADC     Y1
        STA     Y1
        LDA     #$00
        STA     X2
        STA     Y2
.L76FC
        LDA     X2
        SEC
        SBC     #$C0
        STA     R
        LDA     Y2
        SBC     #$00
        STA     S
        BCC     L7721

        JSR     LL123

        TXA
        CLC
        ADC     XX15
        STA     XX15
        TYA
        ADC     Y1
        STA     Y1
        LDA     #$BF
        STA     X2
        LDA     #$00
        STA     Y2
.L7721
        RTS

.LL120
        LDA     XX15
        STA     R
        JSR     LL129

        PHA
        LDX     T
        BNE     L7759

.L772E
        LDA     #$00
        TAX
        TAY
        LSR     S
        ROR     R
        ASL     Q
        BCC     L7743

.L773A
        TXA
        CLC
        ADC     R
        TAX
        TYA
        ADC     S
        TAY
.L7743
        LSR     S
        ROR     R
        ASL     Q
        BCS     L773A

        BNE     L7743

        PLA
        BPL     L7780

        RTS

.LL123
        JSR     LL129

        PHA
        LDX     T
        BNE     L772E

.L7759
        LDA     #$FF
        TAY
        ASL     A
        TAX
.L775E
        ASL     R
        ROL     S
        LDA     S
        BCS     L776A

        CMP     Q
        BCC     L7775

.L776A
        SBC     Q
        STA     S
        LDA     R
        SBC     #$00
        STA     R
        SEC
.L7775
        TXA
        ROL     A
        TAX
        TYA
        ROL     A
        TAY
        BCS     L775E

        PLA
        BMI     L778C

.L7780
        TXA
        EOR     #$FF
        ADC     #$01
        TAX
        TYA
        EOR     #$FF
        ADC     #$00
        TAY
.L778C
        RTS

.LL129
        LDX     L0052
        STX     Q
        LDA     S
        BPL     L77A6

        LDA     #$00
        SEC
        SBC     R
        STA     R
        LDA     S
        PHA
        EOR     #$FF
        ADC     #$00
        STA     S
        PLA
.L77A6
        EOR     L0053
        RTS

.LL145
        LDA     #$00
        STA     SWAP
        LDA     L004F
.LL147
        LDX     #$BF
        ORA     L0051
        BNE     L77BC

        CPX     XX12
        BCC     L77BC

        LDX     #$00
.L77BC
        STX     L0083
        LDA     Y1
        ORA     Y2
        BNE     L77E0

        LDA     #$BF
        CMP     X2
        BCC     L77E0

        LDA     L0083
        BNE     L77DE

.L77CE
        LDA     X2
        STA     Y1
        LDA     L004E
        STA     X2
        LDA     XX12
        STA     Y2
        CLC
        RTS

.L77DC
        SEC
        RTS

.L77DE
        LSR     L0083
.L77E0
        LDA     L0083
        BPL     L7813

        LDA     Y1
        AND     L004F
        BMI     L77DC

        LDA     Y2
        AND     L0051
        BMI     L77DC

        LDX     Y1
        DEX
        TXA
        LDX     L004F
        DEX
        STX     L0052
        ORA     L0052
        BPL     L77DC

        LDA     X2
        CMP     #$C0
        LDA     Y2
        SBC     #$00
        STA     L0052
        LDA     XX12
        CMP     #$C0
        LDA     L0051
        SBC     #$00
        ORA     L0052
        BPL     L77DC

.L7813
        TYA
        PHA
        LDA     L004E
        SEC
        SBC     XX15
        STA     L0052
        LDA     L004F
        SBC     Y1
        STA     L0053
        LDA     XX12
        SEC
        SBC     X2
        STA     L0054
        LDA     L0051
        SBC     Y2
        STA     L0055
        EOR     L0053
        STA     S
        LDA     L0055
        BPL     L7844

        LDA     #$00
        SEC
        SBC     L0054
        STA     L0054
        LDA     #$00
        SBC     L0055
        STA     L0055
.L7844
        LDA     L0053
        BPL     L7853

        SEC
        LDA     #$00
        SBC     L0052
        STA     L0052
        LDA     #$00
        SBC     L0053
.L7853
        TAX
        BNE     L785A

        LDX     L0055
        BEQ     L7864

.L785A
        LSR     A
        ROR     L0052
        LSR     L0055
        ROR     L0054
        JMP     L7853

.L7864
        STX     T
        LDA     L0052
        CMP     L0054
        BCC     L7876

        STA     Q
        LDA     L0054
        JSR     LL28

        JMP     L7881

.L7876
        LDA     L0054
        STA     Q
        LDA     L0052
        JSR     LL28

        DEC     T
.L7881
        LDA     R
        STA     L0052
        LDA     S
        STA     L0053
        LDA     L0083
        BEQ     L788F

        BPL     L78A2

.L788F
        JSR     LL118

        LDA     L0083
        BPL     L78C8

        LDA     Y1
        ORA     Y2
        BNE     L78CD

        LDA     X2
        CMP     #$C0
        BCS     L78CD

.L78A2
        LDX     XX15
        LDA     L004E
        STA     XX15
        STX     L004E
        LDA     L004F
        LDX     Y1
        STX     L004F
        STA     Y1
        LDX     X2
        LDA     XX12
        STA     X2
        STX     XX12
        LDA     L0051
        LDX     Y2
        STX     L0051
        STA     Y2
        JSR     LL118

        DEC     SWAP
.L78C8
        PLA
        TAY
        JMP     L77CE

.L78CD
        PLA
        TAY
        SEC
        RTS

.L78D1
        LDY     L008F
.L78D3
        CPY     L0090
        BCS     L78F1

        LDA     (XX19),Y
        INY
        STA     XX15
        LDA     (XX19),Y
        INY
        STA     Y1
        LDA     (XX19),Y
        INY
        STA     X2
        LDA     (XX19),Y
        INY
        STA     Y2
        JSR     LL30

        JMP     L78D3

.L78F1
        LDA     L008F
        LDY     #$00
        STA     (XX19),Y
.L78F7
        RTS

.L78F8
        LDY     L008F
        CPY     L0090
        PHP
        LDX     #$03
.L78FF
        LDA     XX15,X
        STA     XX12,X
        DEX
        BPL     L78FF

        JSR     LL30

        LDA     (XX19),Y
        STA     XX15
        LDA     XX12
        STA     (XX19),Y
        INY
        LDA     (XX19),Y
        STA     Y1
        LDA     L0051
        STA     (XX19),Y
        INY
        LDA     (XX19),Y
        STA     X2
        LDA     L0052
        STA     (XX19),Y
        INY
        LDA     (XX19),Y
        STA     Y2
        LDA     L0053
        STA     (XX19),Y
        INY
        STY     L008F
        PLP
        BCS     L78F7

        JMP     LL30

.MVEIT
        LDA     L00BB
        AND     #$A0
        BNE     L7960

        LDA     MCNT
        EOR     XSAV
        AND     #$0F
        BNE     L7946

        JSR     TIDY

.L7946
        LDX     TYPE
        BPL     L794D

        JMP     L7BD2

.L794D
        LDA     L00BC
        BPL     L7960

        CPX     #$01
        BEQ     L795D

        LDA     MCNT
        EOR     XSAV
        AND     #$07
        BNE     L7960

.L795D
        JSR     TACTICS

.L7960
        JSR     SCAN

        LDA     L00B7
        ASL     A
        ASL     A
        STA     Q
        LDA     L00A6
        AND     #$7F
        JSR     FMLTU

        STA     R
        LDA     L00A6
        LDX     #$00
        JSR     L7ADF

        LDA     L00A8
        AND     #$7F
        JSR     FMLTU

        STA     R
        LDA     L00A8
        LDX     #$03
        JSR     L7ADF

        LDA     L00AA
        AND     #$7F
        JSR     FMLTU

        STA     R
        LDA     L00AA
        LDX     #$06
        JSR     L7ADF

        LDA     L00B7
        CLC
        ADC     L00B8
        BPL     L79A2

        LDA     #$00
.L79A2
        LDY     #$0F
        CMP     (XX0),Y
        BCC     L79AA

        LDA     (XX0),Y
.L79AA
        STA     L00B7
        LDA     #$00
        STA     L00B8
        LDX     ALP1
        LDA     INWK
        EOR     #$FF
        STA     P
        LDA     L009D
        JSR     L45BE

        STA     S_COPY
        LDA     L0049
        EOR     L009E
        LDX     #$03
        JSR     L7B9D

        STA     L0096
        LDA     L000D
        STA     L0094
        EOR     #$FF
        STA     P
        LDA     S_COPY
        STA     L0095
        LDX     BET1
        JSR     L45BE

        STA     S_COPY
        LDA     L0096
        EOR     BET2
        LDX     #$06
        JSR     L7B9D

        STA     L00A4
        LDA     L000D
        STA     L00A2
        EOR     #$FF
        STA     P
        LDA     S_COPY
        STA     L00A3
        JSR     MLTU2

        STA     S_COPY
        LDA     L0096
        STA     L00A1
        EOR     BET2
        EOR     L00A4
        BPL     L7A12

        LDA     L000D
        ADC     L0094
        STA     L009F
        LDA     S_COPY
        ADC     L0095
        STA     L00A0
        JMP     L7A32

.L7A12
        LDA     L0094
        SBC     L000D
        STA     L009F
        LDA     L0095
        SBC     S_COPY
        STA     L00A0
        BCS     L7A32

        LDA     #$01
        SBC     L009F
        STA     L009F
        LDA     #$00
        SBC     L00A0
        STA     L00A0
        LDA     L00A1
        EOR     #$80
        STA     L00A1
.L7A32
        LDX     ALP1
        LDA     L009F
        EOR     #$FF
        STA     P
        LDA     L00A0
        JSR     L45BE

        STA     S_COPY
        LDA     ALP2
        EOR     L00A1
        LDX     #$00
        JSR     L7B9D

        STA     L009E
        LDA     S_COPY
        STA     L009D
        LDA     L000D
        STA     INWK
.L7A54
        LDA     DELTA
        STA     R
        LDA     #$80
        LDX     #$06
        JSR     MVT1

        LDA     TYPE
        AND     #$81
        CMP     #$81
        BNE     L7A68

        RTS

.L7A68
        LDY     #$09
        JSR     L7B36

        LDY     #$0F
        JSR     L7B36

        LDY     #$15
        JSR     L7B36

        LDA     L00BA
        AND     #$80
        STA     RAT2
        LDA     L00BA
        AND     #$7F
        BEQ     L7AA0

        CMP     #$7F
        SBC     #$00
        ORA     RAT2
        STA     L00BA
        LDX     #$0F
        LDY     #$09
        JSR     MVS5

        LDX     #$11
        LDY     #$0B
        JSR     MVS5

        LDX     #$13
        LDY     #$0D
        JSR     MVS5

.L7AA0
        LDA     L00B9
        AND     #$80
        STA     RAT2
        LDA     L00B9
        AND     #$7F
        BEQ     L7AC9

        CMP     #$7F
        SBC     #$00
        ORA     RAT2
        STA     L00B9
        LDX     #$0F
        LDY     #$15
        JSR     MVS5

        LDX     #$11
        LDY     #$17
        JSR     MVS5

        LDX     #$13
        LDY     #$19
        JSR     MVS5

.L7AC9
        LDA     L00BB
        AND     #$A0
        BNE     L7AD8

        LDA     L00BB
        ORA     #$10
        STA     L00BB
        JMP     SCAN

.L7AD8
        LDA     L00BB
        AND     #$EF
        STA     L00BB
        RTS

.L7ADF
        AND     #$80
.MVT1
        ASL     A
        STA     S
        LDA     #$00
        ROR     A
        STA     T
        LSR     S
        EOR     L009E,X
        BMI     L7B04

        LDA     R
        ADC     INWK,X
        STA     INWK,X
        LDA     S
        ADC     L009D,X
        STA     L009D,X
        LDA     L009E,X
        ADC     #$00
        ORA     T
        STA     L009E,X
        RTS

.L7B04
        LDA     INWK,X
        SEC
        SBC     R
        STA     INWK,X
        LDA     L009D,X
        SBC     S
        STA     L009D,X
        LDA     L009E,X
        AND     #$7F
        SBC     #$00
        ORA     #$80
        EOR     T
        STA     L009E,X
        BCS     L7B35

        LDA     #$01
        SBC     INWK,X
        STA     INWK,X
        LDA     #$00
        SBC     L009D,X
        STA     L009D,X
        LDA     #$00
        SBC     L009E,X
        AND     #$7F
        ORA     T
        STA     L009E,X
.L7B35
        RTS

.L7B36
        LDA     ALPHA
        STA     Q
        LDX     L009E,Y
        STX     R
        LDX     L009F,Y
        STX     S
        LDX     INWK,Y
        STX     P
        LDA     L009D,Y
        EOR     #$80
        JSR     MAD

        STA     L009F,Y
        STX     L009E,Y
        STX     P
        LDX     INWK,Y
        STX     R
        LDX     L009D,Y
        STX     S
        LDA     L009F,Y
        JSR     MAD

        STA     L009D,Y
        STX     INWK,Y
        STX     P
        LDA     BETA
        STA     Q
        LDX     L009E,Y
        STX     R
        LDX     L009F,Y
        STX     S
        LDX     L00A0,Y
        STX     P
        LDA     L00A1,Y
        EOR     #$80
        JSR     MAD

        STA     L009F,Y
        STX     L009E,Y
        STX     P
        LDX     L00A0,Y
        STX     R
        LDX     L00A1,Y
        STX     S
        LDA     L009F,Y
        JSR     MAD

        STA     L00A1,Y
        STX     L00A0,Y
        RTS

.L7B9D
        TAY
        EOR     L009E,X
        BMI     L7BB1

        LDA     L000D
        CLC
        ADC     INWK,X
        STA     L000D
        LDA     S_COPY
        ADC     L009D,X
        STA     S_COPY
        TYA
        RTS

.L7BB1
        LDA     INWK,X
        SEC
        SBC     L000D
        STA     L000D
        LDA     L009D,X
        SBC     S_COPY
        STA     S_COPY
        BCC     L7BC4

        TYA
        EOR     #$80
        RTS

.L7BC4
        LDA     #$01
        SBC     L000D
        STA     L000D
        LDA     #$00
        SBC     S_COPY
        STA     S_COPY
        TYA
        RTS

.L7BD2
        LDA     ALPHA
        EOR     #$80
        STA     Q
        LDA     INWK
        STA     P
        LDA     L009D
        STA     L000D
        LDA     L009E
        JSR     MULT3

        LDX     #$03
        JSR     MVT3

        LDA     L0057
        STA     L0094
        STA     P
        LDA     L0058
        STA     L0095
        STA     L000D
        LDA     BETA
        STA     Q
        LDA     L0059
        STA     L0096
        JSR     MULT3

        LDX     #$06
        JSR     MVT3

        LDA     L0057
        STA     P
        STA     L00A2
        LDA     L0058
        STA     L000D
        STA     L00A3
        LDA     L0059
        STA     L00A4
        EOR     #$80
        JSR     MULT3

        LDA     L0059
        AND     #$80
        STA     T
        EOR     L0096
        BMI     L7C3D

        LDA     K
        CLC
        ADC     L0093
        LDA     L0057
        ADC     L0094
        STA     L009F
        LDA     L0058
        ADC     L0095
        STA     L00A0
        LDA     L0059
        ADC     L0096
        JMP     L7C70

.L7C3D
        LDA     K
        SEC
        SBC     L0093
        LDA     L0057
        SBC     L0094
        STA     L009F
        LDA     L0058
        SBC     L0095
        STA     L00A0
        LDA     L0096
        AND     #$7F
        STA     P
        LDA     L0059
        AND     #$7F
        SBC     P
        STA     P
        BCS     L7C70

        LDA     #$01
        SBC     L009F
        STA     L009F
        LDA     #$00
        SBC     L00A0
        STA     L00A0
        LDA     #$00
        SBC     P
        ORA     #$80
.L7C70
        EOR     T
        STA     L00A1
        LDA     ALPHA
        STA     Q
        LDA     L009F
        STA     P
        LDA     L00A0
        STA     L000D
        LDA     L00A1
        JSR     MULT3

        LDX     #$00
        JSR     MVT3

        LDA     L0057
        STA     INWK
        LDA     L0058
        STA     L009D
        LDA     L0059
        STA     L009E
        JMP     L7A54

.PLUT
        LDX     VIEW
        BEQ     L7CD1

        DEX
        BNE     PU2

        LDA     L009E
        EOR     #$80
        STA     L009E
        LDA     L00A4
        EOR     #$80
        STA     L00A4
        LDA     L00A6
        EOR     #$80
        STA     L00A6
        LDA     L00AA
        EOR     #$80
        STA     L00AA
        LDA     L00AC
        EOR     #$80
        STA     L00AC
        LDA     L00B0
        EOR     #$80
        STA     L00B0
        LDA     L00B2
        EOR     #$80
        STA     L00B2
        LDA     L00B6
        EOR     #$80
        STA     L00B6
.L7CD1
        RTS

.PU2
        LDA     #$00
        CPX     #$02
        ROR     A
        STA     RAT2
        EOR     #$80
        STA     RAT
        LDA     INWK
        LDX     L00A2
        STA     L00A2
        STX     INWK
        LDA     L009D
        LDX     L00A3
        STA     L00A3
        STX     L009D
        LDA     L009E
        EOR     RAT
        TAX
        LDA     L00A4
        EOR     RAT2
        STA     L009E
        STX     L00A4
        LDY     #$09
        JSR     PUS1

        LDY     #$0F
        JSR     PUS1

        LDY     #$15
.PUS1
        LDA     INWK,Y
        LDX     L00A0,Y
        STA     L00A0,Y
        STX     INWK,Y
        LDA     L009D,Y
        EOR     RAT
        TAX
        LDA     L00A1,Y
        EOR     RAT2
        STA     L009D,Y
        STX     L00A1,Y
.LO2
        RTS

.LQ
        STX     VIEW
        JSR     TT66

        JSR     SIGHT

        LDA     BOMB
        BPL     L7D32

        JSR     L31AC

.L7D32
        JMP     NWSTARS

.LOOK1
        LDA     #$00
        JSR     DOVDU19

        LDY     QQ11
        BNE     LQ

        CPX     VIEW
        BEQ     LO2

        STX     VIEW
        JSR     TT66

        JSR     FLIP

        LDA     BOMB
        BPL     L7D54

        JSR     L31AC

.L7D54
        JSR     WPSHPS

.SIGHT
        LDY     VIEW
        LDA     LASER,Y
        BEQ     LO2

        LDY     #$00
        CMP     #$0F
        BEQ     L7D70

        INY
        CMP     #$8F
        BEQ     L7D70

        INY
        CMP     #$97
        BEQ     L7D70

        INY
.L7D70
        LDA     L7D8B,Y
        STA     COL
        LDA     #$80
        STA     QQ19
        LDA     #$48
        STA     L006E
        LDA     #$14
        STA     L006F
        JSR     TT15

        LDA     #$0A
        STA     L006F
        JMP     TT15

.L7D8B
        EQUB    $0F

        EQUB    $FF,$FF,$0F

        EQUB    $FA

        EQUB    $FA,$FA,$FA

.TT66
        STA     QQ11
        JSR     TTX66

        JSR     MT2

        LDA     #$00
        STA     LSP
        LDA     #$80
        STA     QQ17
        STA     DTW2
        JSR     FLFLLS

        LDA     #$00
        STA     LAS2
        STA     DLY
        STA     L0E7D
        LDX     L0045
        BEQ     L7DBB

        JSR     L52A5

.L7DBB
        LDA     QQ11
        BNE     L7DD7

        LDA     #$0B
        STA     XC
        LDA     #$FF
        STA     COL
        LDA     VIEW
        ORA     #$60
        JSR     TT27

        JSR     TT162

        LDA     #$AF
        JSR     TT27

.L7DD7
        LDX     #$00
        STX     QQ17
        RTS

.L7DDC
        EQUB    $00

        EQUB    $40,$FE,$A0,$5F,$8C,$43,$FE,$8E
        EQUB    $4F,$FE,$EA,$AE,$4F,$FE,$60,$51
        EQUB    $33,$34,$35,$84,$38,$87,$2D,$5E
        EQUB    $8C,$36,$37,$BC,$00,$FC,$60,$80
        EQUB    $57,$45,$54,$37,$49,$39,$30,$5F
        EQUB    $8E,$38,$39,$BC,$00,$FD,$60,$31
        EQUB    $32,$44,$52,$36,$55,$4F,$50,$5B
        EQUB    $8F,$81,$82,$0D,$4C,$20,$02,$01
        EQUB    $41,$58,$46,$59,$4A,$4B,$40,$3A
        EQUB    $0D,$83,$7F,$AE,$4C,$FE,$FD,$02
        EQUB    $53,$43,$47,$48,$4E,$4C,$3B,$5D
        EQUB    $7F,$85,$84,$86,$4C,$FA,$00,$00
        EQUB    $5A,$20,$56,$42,$4D,$2C,$2E,$2F
        EQUB    $8B,$30,$31,$33,$00,$00,$00,$1B
        EQUB    $81,$82,$83,$85,$86,$88,$89,$5C
        EQUB    $8D,$34,$35,$32,$2C,$4E,$E3

.L7E5C
        EQUB    $22,$23,$35,$37,$41,$42,$45,$51
        EQUB    $52,$60,$62,$65,$66,$67,$68,$70
        EQUB    $F0

.RDKEY_REAL
        JSR     U%

        LDA     #$10
        CLC
.L7E73
        LDY     #$03
        SEI
        STY     LFE40
        LDY     #$7F
        STY     LFE43
        STA     LFE4F
        LDY     LFE4F
        LDA     #$0B
        STA     LFE40
        CLI
        TYA
        BMI     L7E9E

.L7E8D
        ADC     #$01
        BPL     L7E73

        CLD
        LDA     L00CB
        EOR     #$FF
        AND     KY19
        STA     KY19
        LDA     L00C3
        TAX
        RTS

.L7E9E
        EOR     #$80
        STA     L00C3
.L7EA2
        CMP     L7E5C,X
        BCC     L7E8D

        BEQ     L7EAC

        INX
        BNE     L7EA2

.L7EAC
        DEC     KY17,X
        INX
        CLC
        BCC     L7E8D

.CTRL
        LDA     #$01
.DKS4
        LDX     #$03
        SEI
        STX     LFE40
        LDX     #$7F
        STX     LFE43
        STA     LFE4F
        LDX     LFE4F
        LDA     #$0B
        STA     LFE40
        CLI
        TXA
        RTS

.U%
        LDA     #$00
        LDX     #$11
.L7ED1
        STA     JSTY,X
        DEX
        BNE     L7ED1

        RTS

.L7ED7
        SED
.RDKEY
        TYA
        PHA
        JSR     RDKEY_REAL

        PLA
        TAY
        LDA     L7DDC,X
        STA     L00C3
        TAX
        RTS

.L7EE6
        RTS

.ECMOF
        LDA     #$00
        STA     ECMA
        STA     ECMP
        JMP     ECBLB

.SFRMIS
        LDX     #$01
        JSR     L42A8

        BCC     L7EE6

        LDA     #$78
        JSR     MESS

        LDY     #$08
        JMP     NOISE

.EXNO2
        LDA     L1266
        CLC
        ADC     L8062,X
        STA     L1266
        LDA     TALLY
        ADC     L8083,X
        STA     TALLY
        BCC     EXNO3

        INC     L127C
        LDA     #$65
        JSR     MESS

.EXNO3
        LDY     #$04
        JMP     NOISE

.EXNO
        LDY     #$06
        JMP     NOISE

.BRKBK
        LDA     #$B9
        STA     BRKV
        LDA     #$66
        STA     L0203
        LDA     #$85
        STA     WRCHV
        LDA     #$20
        STA     L020F
        JSR     MASTER_MOVE_ZP_3000

        JSR     STARTUP

        JMP     L1377

        CLI
        RTI

.BeebDisEndAddr





\ ******************************************************************************
\
\ Save output/BCODE.unprot.bin
\
\ ******************************************************************************

CODE% = &1300
LOAD% = &1300
PRINT "S.BCODE ", ~CODE%, " ", ~P%, " ", ~LOAD%, " ", ~LOAD%
SAVE "output/BCODE.unprot.bin", CODE%, P%, LOAD%

